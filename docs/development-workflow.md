# 開発フロー・ベストプラクティス

## 概要

ENTP 英語学習アプリの開発における、確実な品質管理と効率的な開発を実現するためのフローとベストプラクティス。

## 1. 変更管理フロー

### 仕様変更時の必須手順

```
1. 変更内容の確認・分析
   ↓
2. 影響範囲の特定
   ↓
3. 実装の実行
   ↓
4. ドキュメントの同期更新
   ↓
5. テスト・検証（必須：Playwright MCP）
   ↓
6. コミット・プッシュ
```

### ドキュメント更新の優先順位

1. **最優先**: `overview.md` - プロジェクト全体の整合性
2. **高優先**: `tech-specs.md` - 技術仕様の正確性
3. **中優先**: `timeline.md` - 進捗状況の反映
4. **低優先**: その他の詳細ドキュメント

## 2. コミュニケーション・コラボレーション

### AI アシスタントとの連携ルール

- **変更前**: 必ず変更内容を共有
- **変更中**: 進捗状況を定期的に報告
- **変更後**: 結果と次のステップを確認

### 質問・相談のタイミング

- 実装方針に迷った時
- 技術的な問題に直面した時
- ユーザー体験の改善案がある時
- パフォーマンスの問題を発見した時

## 3. コード品質管理

### 実装前のチェックリスト

- [ ] 既存のコードとの整合性
- [ ] TypeScript 型定義の確認
- [ ] コンポーネントの再利用性
- [ ] パフォーマンスへの影響

### 実装後のチェックリスト

- [ ] 動作確認（手動テスト）
- [ ] エラーハンドリングの確認
- [ ] レスポンシブデザインの確認
- [ ] アクセシビリティの確認

## 4. データ管理・状態管理

### データ変更時の注意点

- **問題データ**: `src/data/questions.ts` の更新時は型定義も確認
- **語彙データ**: カテゴリー分類の一貫性を保つ
- **実績データ**: XP 計算ロジックとの整合性を確認

### 状態管理の原則

- 単一責任の原則（各コンポーネントの役割を明確に）
- データの流れを一方向に保つ
- 不要な再レンダリングを避ける

## 5. テスト・品質保証

### 開発中のテスト

- **機能テスト**: 新機能の動作確認
- **回帰テスト**: 既存機能への影響確認
- **ユーザビリティテスト**: ENTP 特性を考慮した使いやすさ

### リリース前のチェック

- [ ] 全学習モードの動作確認
- [ ] PWA 機能の動作確認
- [ ] ゲーム機能の動作確認
- [ ] データの永続化確認

## 6. パフォーマンス管理

### 定期的な監視項目

- バンドルサイズの確認
- 読み込み時間の測定
- メモリ使用量の確認
- ユーザー操作の応答性

### 最適化のタイミング

- 新機能追加後
- データ量増加後
- ユーザーフィードバック受領後

## 7. ユーザー体験の継続改善

### ENTP 特性を考慮した改善

- **多様性**: 定期的な新機能・新コンテンツの追加
- **即効性**: 即座のフィードバックと達成感
- **自由度**: カスタマイズオプションの拡充

### フィードバック収集の仕組み

- 使用データの分析
- ユーザー行動の追跡
- 改善点の特定と優先順位付け

## 8. 緊急時・問題発生時の対応

### バグ発見時の手順

1. 問題の再現と影響範囲の特定
2. 緊急度の判定（高・中・低）
3. 一時的な回避策の実装
4. 根本原因の調査と修正
5. ドキュメントの更新

### 緊急度別対応

- **高**: 即座に対応（学習機能の停止など）
- **中**: 24 時間以内に対応
- **低**: 次回リリース時に修正

## 9. リリース管理

### バージョン管理

- **メジャー**: 大きな機能追加・仕様変更
- **マイナー**: 新機能追加・改善
- **パッチ**: バグ修正・軽微な改善

### リリース前の最終チェック

- [ ] 全機能の動作確認
- [ ] ドキュメントの最新化
- [ ] バージョン番号の更新
- [ ] リリースノートの作成

## 10. 学習・成長の継続

### 技術スキルの向上

- 新しい React パターンの学習
- TypeScript の高度な機能の活用
- PWA 機能の拡張
- ゲーム開発のベストプラクティス

### プロジェクトの進化

- ユーザーフィードバックに基づく改善
- 新技術の導入検討
- スケーラビリティの向上

## 実践的な開発フロー例

### 新機能追加の場合

```
1. 要件の整理・確認
   ↓
2. 技術仕様の検討
   ↓
3. 実装の実行
   ↓
4. テスト・検証
   ↓
5. ドキュメント更新
   ↓
6. コードレビュー
   ↓
7. リリース
```

### バグ修正の場合

```
1. 問題の特定・再現
   ↓
2. 原因の調査
   ↓
3. 修正の実装
   ↓
4. テスト・検証
   ↓
5. ドキュメント更新（必要に応じて）
   ↓
6. リリース
```

## 新チャット開始時の確認事項

新しいチャットセッションを開始する際は、以下を確認してください：

1. **プロジェクト状況の確認**

   - 現在の実装状況
   - 最新のドキュメント内容
   - 進行中のタスク

2. **開発フローの確認**

   - このドキュメントの内容
   - 変更管理の手順
   - 品質管理の基準

3. **技術スタックの確認**
   - 使用している技術
   - アーキテクチャの理解
   - データ構造の把握

## 🚨 **真っ白ページ問題の予防策**

### **必須チェック項目**

#### **コンポーネント作成・修正時**

- [ ] **Router 対応**: `useNavigate()` と `useParams()` を使用
- [ ] **Export 統一**: default export を使用
- [ ] **Props 削除**: props interface と呼び出しを削除
- [ ] **Lazy Loading 回避**: 直接 import を優先使用

#### **変更後の必須確認**

- [ ] **Playwright MCP 確認**: 該当ページの表示確認
- [ ] **エラーコンソール**: JavaScript エラーがないことを確認
- [ ] **ナビゲーション**: 戻るボタン・遷移の動作確認
- [ ] **関連ページ**: 影響する可能性のあるページを確認

#### **リリース前の必須テスト**

- [ ] **全 36 ページ確認**: 基本 21 ページ + 深い階層 15 ページ
- [ ] **ユーザージャーニー**: 実際の学習フローをテスト
- [ ] **エラーハンドリング**: 無効な URL・パラメータの処理確認

### **警告サインと対処法**

#### **🚨 即座に修正が必要**

- 「読み込み中...」で止まるページ
- "does not provide an export" エラー
- "Cannot convert object to primitive value" エラー
- 空白ページ（文字数 < 30）

#### **🔧 対処法**

1. **Lazy Loading 問題**: 直接 import に変更
2. **Export 問題**: default export に統一
3. **Router 問題**: useNavigate/useParams に変更
4. **空白問題**: Playwright MCP で原因特定

### **開発フロー改善**

#### **変更前**

```typescript
// 危険なパターン
const Component = lazy(() => import("./Component"));
// テストなしでリリース → 本番で真っ白
```

#### **変更後**

```typescript
// 安全なパターン
import Component from "./Component";
// Playwright MCPで必ず確認 → 安全なリリース
```

## 更新履歴

- 2024 年 12 月: 初版作成
- 開発フローとベストプラクティスの体系化
- ENTP 特性を考慮した開発方針の確立
- **2025 年 9 月 18 日: 真っ白ページ問題予防策追加**
  - Lazy Loading 問題の分析と対策
  - Playwright MCP 必須化
  - Router 対応の徹底
