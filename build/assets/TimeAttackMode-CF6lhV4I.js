import{r as n,j as e}from"./ui-CztJLv2w.js";import{B as c,C as u,a as g,P as W,d as Z,f as q}from"./game-C2GAOMMb.js";import{g as G}from"./index-CNS3iqlP.js";import{A as S,x as V,F as X,Z as B,a as J,g as K,s as U,O as Y}from"./learning-DM0ZpHwI.js";import{D as _}from"./progress-D6GHYjXS.js";import"./vendor-D3F3s8fL.js";function re({onBack:d}){const[h,D]=n.useState([]),[r,M]=n.useState(0),[i,f]=n.useState(0),[x,A]=n.useState(0),[N,p]=n.useState(0),[L,Q]=n.useState(0),[j,k]=n.useState(!1),[b,I]=n.useState(!1),[R,T]=n.useState(""),[w,v]=n.useState(!1),[y,$]=n.useState(!1),z=()=>{const t=[];G("basic-grammar","easy").slice(0,5).forEach(s=>{t.push({id:s.id,type:"grammar",question:s.japanese,options:s.choices,correctAnswer:s.correctAnswer,explanation:s.explanation,timeLimit:15})});const l=Y("beginner","all").slice(0,5);return l.forEach((s,m)=>{t.push({id:1e3+m,type:"vocabulary",question:`ã€Œ${s.japanese}ã€ã‚’è‹±èªã§è¨€ã†ã¨ï¼Ÿ`,options:[s.word,l[(m+1)%l.length].word,l[(m+2)%l.length].word,l[(m+3)%l.length].word].sort(()=>Math.random()-.5),correctAnswer:s.word,explanation:s.meaning,timeLimit:10})}),t.sort(()=>Math.random()-.5)},E=()=>{if(!K().consumeHeart()){alert("ä½“åŠ›ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚å›å¾©ã‚’å¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚"),d();return}const a=z();D(a),M(0),A(0),p(0),Q(0),k(!0),I(!1),v(!1),a.length>0&&f(a[0].timeLimit),U()};n.useEffect(()=>{if(!j||b)return;const t=setInterval(()=>{f(a=>a<=1?(P(""),0):a-1)},1e3);return()=>clearInterval(t)},[j,b]);const P=t=>{if(!j||w)return;const a=h[r],l=t===a.correctAnswer;if($(l),v(!0),l){const s=N+1;p(s),Q(C=>Math.max(C,s));const m=100,H=Math.min(s*10,100),O=Math.max(i*2,0);A(C=>C+m+H+O)}else p(0);setTimeout(()=>{r+1>=h.length?(I(!0),k(!1),F()):(M(s=>s+1),f(h[r+1].timeLimit),v(!1),T(""))},2e3)},F=()=>{const t=Math.floor(x/10),a={date:new Date().toISOString().split("T")[0],type:"time-attack",score:x,maxCombo:L,questionsAnswered:r+1,xpEarned:t,duration:0};_.recordLearningSession(a)},o=h[r];return b?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"ghost",onClick:d,className:"p-2",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯çµæœ"}),e.jsx("div",{className:"w-10"})]}),e.jsx(u,{className:"text-center border-0 shadow-lg bg-gradient-to-br from-yellow-50 to-orange-50",children:e.jsxs(g,{className:"p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ†"}),e.jsx("h2",{className:"text-3xl font-bold text-orange-800 mb-2",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯å®Œäº†ï¼"}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"ã‚¹ã‚³ã‚¢"}),e.jsx("span",{className:"text-2xl font-bold text-orange-600",children:x.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"æœ€å¤§ã‚³ãƒ³ãƒœ"}),e.jsx("span",{className:"text-2xl font-bold text-red-600",children:L})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"æ­£è§£æ•°"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:r+1})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"ç²å¾—XP"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:Math.floor(x/10)})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(c,{onClick:E,className:"w-full",size:"lg",children:"ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦"}),e.jsx(c,{onClick:d,variant:"outline",className:"w-full",children:"ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹"})]})]})})]})}):j?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"ghost",onClick:d,className:"p-2",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯"}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ã‚¹ã‚³ã‚¢"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:x.toLocaleString()})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ã‚³ãƒ³ãƒœ"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:N})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"å•é¡Œ"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[r+1,"/10"]})]})]}),e.jsx(u,{className:"border-0 shadow-lg",children:e.jsxs(g,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"æ®‹ã‚Šæ™‚é–“"}),e.jsx("span",{className:`text-2xl font-bold ${i<=5?"text-red-600":"text-blue-600"}`,children:i})]}),e.jsx(W,{value:i/o.timeLimit*100,className:`h-2 ${i<=5?"bg-red-200":"bg-blue-200"}`})]})}),o&&e.jsxs(u,{className:"border-0 shadow-lg",children:[e.jsx(Z,{children:e.jsx(q,{className:"text-center",children:o.type==="grammar"?"æ–‡æ³•å•é¡Œ":"å˜èªå•é¡Œ"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted rounded-lg text-center",children:e.jsx("p",{className:"text-lg",children:o.question})}),w&&e.jsxs("div",{className:`p-4 rounded-lg text-center ${y?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsx("p",{className:"font-bold text-lg",children:y?"æ­£è§£ï¼":"ä¸æ­£è§£"}),y&&e.jsxs("p",{className:"text-sm mt-1",children:["+",100+Math.min(N*10,100)+Math.max(i*2,0)," ãƒã‚¤ãƒ³ãƒˆ"]})]}),!w&&o.options&&e.jsx("div",{className:"space-y-2",children:o.options.map((t,a)=>e.jsxs(c,{variant:R===t?"default":"outline",className:"w-full justify-start h-auto p-3 text-left",onClick:()=>{T(t),P(t)},children:[String.fromCharCode(65+a),". ",t]},a))})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"ghost",onClick:d,className:"p-2",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯"}),e.jsx("div",{className:"w-10"})]}),e.jsx(u,{className:"text-center border-0 shadow-lg bg-gradient-to-br from-red-50 to-orange-50",children:e.jsxs(g,{className:"p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš¡"}),e.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰"}),e.jsx("p",{className:"text-gray-700 mb-6",children:"åˆ¶é™æ™‚é–“å†…ã«é€£ç¶šã§æ­£è§£ã‚’é‡ã­ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼"}),e.jsxs("div",{className:"space-y-3 text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{children:"å„å•é¡Œã«åˆ¶é™æ™‚é–“ã‚ã‚Š"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{children:"é€£ç¶šæ­£è§£ã§ã‚³ãƒ³ãƒœãƒœãƒ¼ãƒŠã‚¹"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{children:"æ®‹ã‚Šæ™‚é–“ã§ã‚¿ã‚¤ãƒ ãƒœãƒ¼ãƒŠã‚¹"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{children:"10å•é€£ç¶šã§æŒ‘æˆ¦"})]})]}),e.jsx(c,{onClick:E,className:"w-full mt-8",size:"lg",children:"ã‚¹ã‚¿ãƒ¼ãƒˆï¼"})]})})]})})}export{re as TimeAttackMode};
