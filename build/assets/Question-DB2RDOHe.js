import{r as a,j as e}from"./ui-smpf69Zd.js";import{g as E}from"./questions-zY9y3rZJ.js";import{u as D,a as R,b as X,B as c,C as p,f as v,h as b,d as y,e as h,P as H}from"./game-Dd6Kb0LE.js";import{A as U,g as $}from"./learning-B-E1ZIuS.js";import{T as z}from"./index-DOAaQjy2.js";import"./vendor-D3F3s8fL.js";import"./progress-BPWR83xl.js";const F={"basic-grammar":"基本文型",tenses:"時制",modals:"助動詞",passive:"受動態",relative:"関係詞",subjunctive:"仮定法",comparison:"比較",participle:"分詞・動名詞",infinitive:"不定詞"},G={easy:"簡単",normal:"普通",hard:"難しい"};function _(){const r=D(),{category:w,difficulty:C}=R();X();const n=w,t=C,[o,S]=a.useState(0),[m,k]=a.useState([]),[l,Q]=a.useState(0),[A,I]=a.useState(!1),[x,j]=a.useState(""),[u,f]=a.useState("");if(a.useEffect(()=>{if(n&&t)try{const s=E(n,t);k(s)}catch(s){console.error("問題データの取得に失敗:",s),r("/learning/grammar/category")}},[n,t,r]),!n||!t||m.length===0)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"問題を読み込んでいます..."}),e.jsx(c,{onClick:()=>r("/learning/grammar/category"),children:"カテゴリー選択に戻る"})]})})});const d=m[o],g=o+1,i=m.length,M=s=>{if(s===d.correctAnswer&&Q(l+1),o<m.length-1)S(o+1);else{I(!0);const L=$(),q=Math.round(l*10+i*2);L.addXP(q)}},P=()=>{r(`/learning/grammar/difficulty/${n}`)},T=()=>{const s=t==="easy"?x:u;s.trim()&&(M(s),j(""),f(""))},B=t==="easy"?x:u.trim();return A?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(p,{className:"shadow-lg",children:[e.jsx(v,{children:e.jsx(b,{className:"text-center text-2xl",children:"問題完了！"})}),e.jsxs(y,{className:"text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-xl mb-2",children:["正解数: ",l," / ",i]}),e.jsxs("p",{className:"text-lg text-gray-600",children:["正解率: ",Math.round(l/i*100),"%"]}),e.jsxs(h,{className:"mt-2",children:["+",Math.round(l*10+i*2)," XP獲得！"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(c,{onClick:()=>r("/learning/grammar/category"),className:"w-full",children:"カテゴリー選択に戻る"}),e.jsx(c,{variant:"outline",onClick:()=>r("/"),className:"w-full",children:"ホームに戻る"})]})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(c,{variant:"outline",onClick:P,className:"flex items-center",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"文法クイズ"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[e.jsx(h,{variant:"outline",className:"text-xs",children:F[n]}),e.jsx(h,{variant:"outline",className:"text-xs",children:G[t]})]})]}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["問題 ",g," / ",i]}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["スコア: ",l]})]}),e.jsx(H,{value:g/i*100,className:"h-2"})]}),e.jsxs(p,{className:"mb-6 shadow-lg",children:[e.jsx(v,{children:e.jsx(b,{className:"text-lg font-semibold text-gray-800",children:d.japanese})}),e.jsxs(y,{children:[t==="easy"?e.jsx("div",{className:"space-y-3",children:d.choices?.map((s,N)=>e.jsx(c,{variant:x===s?"default":"outline",className:"w-full text-left justify-start p-4 h-auto",onClick:()=>j(s),children:s},N))}):e.jsxs("div",{children:[e.jsx(z,{placeholder:"英語で回答してください...",value:u,onChange:s=>f(s.target.value),className:"min-h-[120px] mb-4"}),e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["ヒント:"," ",d.hint||"文法に注意して回答してください"]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsx(c,{onClick:T,disabled:!B,className:"w-full",children:"回答する"})})]})]})]})})}export{_ as default};
