const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/learning-B7AfTcwU.js","assets/ui-DhiIzcP4.js","assets/vendor-D3F3s8fL.js","assets/game-DQXwOTYN.js","assets/progress-Dp2NNpON.js","assets/EnhancedVocabularyCard-DMnqduZr.js","assets/VocabularyDifficultySelection-CAzPTxYU.js","assets/VocabularyCategorySelection-2mNBh-EI.js","assets/CategorySelection-cImHteyh.js","assets/DifficultySelection-DMNC2fAT.js","assets/Question-SB5ERoex.js","assets/Results-CKPwCidN.js","assets/AppSettings-CHHphcot.js","assets/notificationManager-DRqVOwDk.js","assets/TimeAttackMode-SBTTDqDa.js"])))=>i.map(i=>d[i]);
import{r,j as e,d as Z,e as it,f as as,u as ce,g as rs,A as os,h as W,i as xe,k as is,l as lt,m as Ge,n as ls,o as cs,p as ds,q as ms,s as hs,F as us,D as ps,t as xs,v as gs,w as Ke,x as fs,y as ws}from"./ui-DhiIzcP4.js";import{a as ys}from"./vendor-D3F3s8fL.js";import{D as Ne,_ as G,a as vs}from"./progress-Dp2NNpON.js";import{e as bs,f as js,C as V,d as ne,g as le,a as q,B as O,b as ue,P as Ns}from"./game-DQXwOTYN.js";import{g as C,C as he,s as B,v as ks,b as Se,c as Oe,d as me,e as ct,f as Ss,h as _s,R as dt,A as pe,B as mt,S as ht,Z as Is,i as As,j as Ve,H as Be,D as Ts,k as Cs,l as Es,m as Ps,n as Rs,u as Ds,o as Ls,p as Ms,q as Ye,r as Hs,t as Os,P as Je,w as ye,a as Ze,x as et,G as Vs,T as qs,y as zs,F as Bs,z as Ws,X as ut,E as Fs}from"./learning-B7AfTcwU.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var Ie={},tt;function Qs(){if(tt)return Ie;tt=1;var t=ys();return Ie.createRoot=t.createRoot,Ie.hydrateRoot=t.hydrateRoot,Ie}var $s=Qs();const Us=({showDetailed:t=!0,showChapterProgress:s=!0,compact:n=!1})=>{const[a,o]=r.useState(()=>C().getLevel()),[i,l]=r.useState(()=>C().getChapterProgress());r.useEffect(()=>{const m=C(),u=m.getLevel(),f=m.getChapterProgress();o(u),l(f)},[]);const c=m=>({1:"bg-green-500",2:"bg-blue-500",3:"bg-purple-500",4:"bg-orange-500",5:"bg-red-500"})[m],d=m=>({1:"from-green-400 to-green-600",2:"from-blue-400 to-blue-600",3:"from-purple-400 to-purple-600",4:"from-orange-400 to-orange-600",5:"from-red-400 to-red-600"})[m];return n?e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${c(a.chapter)} text-foreground flex items-center justify-center text-sm font-bold`,children:a.chapter}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Level ",a.level]}),e.jsx("div",{className:"text-xs text-gray-500",children:he[a.chapter].name})]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Level ",a.level]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",a.xp-(a.level-1)*50,"/50 XP)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full bg-gradient-to-r ${d(a.chapter)}`,style:{width:`${(a.xp-(a.level-1)*50)/50*100}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["次レベルまで: ",50-(a.xp-(a.level-1)*50),"XP"]})]})})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"レベル情報"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-full ${c(a.chapter)} text-foreground flex items-center justify-center text-lg font-bold`,children:a.chapter}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"章"}),e.jsx("div",{className:"text-xs text-gray-400",children:he[a.chapter].name})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-lg font-medium text-gray-700",children:["Level ",a.level]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[a.xp," XP"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full bg-gradient-to-r ${d(a.chapter)} transition-all duration-500`,style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["進捗: ",a.progress.toFixed(1),"%"]}),e.jsxs("span",{children:["次のレベルまで: ",a.xpToNext," XP"]})]})]}),s&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[he[a.chapter].name,"の進捗"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.progress.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full bg-gradient-to-r ${d(a.chapter)} transition-all duration-500`,style:{width:`${i.progress}%`}})}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:he[a.chapter].description})]}),t&&e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"章"}),e.jsx("div",{className:"font-medium",children:he[a.chapter].name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"レベル範囲"}),e.jsx("div",{className:"font-medium",children:he[a.chapter].levelRange})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"必要XP/レベル"}),e.jsxs("div",{className:"font-medium",children:[he[a.chapter].xpPerLevel," XP"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"最大ハート数"}),e.jsxs("div",{className:"font-medium",children:[he[a.chapter].maxHearts,"個"]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{const m=C(),u=m.addXP(100);o(m.getLevel()),B(),u.leveledUp&&alert(`レベルアップ！ Level ${u.newLevel?.level} に上がりました！`)},className:"px-3 py-1 rounded-md text-xs font-medium bg-blue-500 text-foreground hover:bg-blue-600 transition-colors",title:"テスト用: 100XP追加",children:"+100XP"}),e.jsx("button",{onClick:()=>{const m=C(),u=m.addXP(500);o(m.getLevel()),B(),u.leveledUp&&alert(`レベルアップ！ Level ${u.newLevel?.level} に上がりました！`)},className:"px-3 py-1 rounded-md text-xs font-medium bg-purple-500 text-foreground hover:bg-purple-600 transition-colors",title:"テスト用: 500XP追加",children:"+500XP"}),e.jsx("button",{onClick:()=>{const m=C();m.addXP(1e3),o(m.getLevel()),B(),alert("1000XP追加しました！")},className:"px-3 py-1 rounded-md text-xs font-medium bg-orange-500 text-foreground hover:bg-orange-600 transition-colors",title:"テスト用: 1000XP追加",children:"+1000XP"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"※ テスト用ボタンです"})]})]})]})]})},Gs=({onHeartChange:t,showRecoveryTime:s=!0,compact:n=!1})=>{const[a,o]=r.useState(()=>C().getHeartSystem()),[i,l]=r.useState(0);r.useEffect(()=>{const f=C().processHeartRecovery();o(f),t?.(f)},[]),r.useEffect(()=>{const u=setInterval(()=>{const x=C().processHeartRecovery();x.current!==a.current&&(o(x),t?.(x),B())},3e4);return()=>clearInterval(u)},[a.current,t]),r.useEffect(()=>{const u=()=>{const x=Date.now(),j=a.nextRecovery-x;l(Math.max(0,j))};u();const f=setInterval(u,1e3);return()=>clearInterval(f)},[a.nextRecovery,a.current]);const c=u=>{const f=Math.floor(u/1e3),x=Math.floor(f/3600),j=Math.floor(f%3600/60),N=f%60;return x>0?`${x}:${j.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`:`${j}:${N.toString().padStart(2,"0")}`},d=a.current>0,m=()=>{const u=C();if(u.consumeHeart()){const x=u.getHeartSystem();o(x),t?.(x),B()}};return n?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"flex space-x-1",children:Array.from({length:a.max},(u,f)=>e.jsx("span",{className:`text-lg ${f<a.current?"text-red-500":"text-gray-300"}`,children:f<a.current?"♥":"♡"},f))}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",a.current,"/",a.max,")"]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"体力システム"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"体力"}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:a.max},(u,f)=>e.jsx("span",{className:`text-2xl ${f<a.current?"text-red-500":"text-gray-300"}`,children:f<a.current?"♥":"♡"},f))}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["(",a.current,"/",a.max,")"]})]})]}),s&&a.current<a.max&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"次回復:"}),e.jsx("span",{className:"font-mono",children:i>0?c(i)+"後":"満タン"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-1000",style:{width:`${(300*1e3-i)/(300*1e3)*100}%`}})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"1問題につき1体力消費"}),e.jsx("p",{children:"5分で1体力回復"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:m,disabled:!d,className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${d?"bg-red-500 text-foreground hover:bg-red-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:d?"体力を消費":"体力不足"}),e.jsx("button",{onClick:()=>{const u=C(),f={...a,current:a.max,lastRecoveryTime:Date.now(),nextRecovery:Date.now()+300*1e3};u.heartSystem=f,B(),o(f),t?.(f)},className:"px-3 py-2 rounded-md text-sm font-medium bg-green-500 text-foreground hover:bg-green-600 transition-colors",title:"テスト用: 体力を全回復",children:"♥回復"})]})]}),a.current===0&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-yellow-600 mr-2",children:"⚠️"}),e.jsx("div",{className:"text-sm text-yellow-800",children:"体力が不足しています。回復を待つか、時間をスキップしてください。"})]})})]})},Xs=({onAllocationChange:t,readOnly:s=!1})=>{const[n,a]=r.useState(()=>{try{return C().getStatusAllocation()}catch(h){return console.error("Failed to get status allocation:",h),{listening:5,reading:5,writing:5,grammar:5,idioms:5,vocabulary:5}}}),[o,i]=r.useState(!0),[l,c]=r.useState("");r.useEffect(()=>{const h=ks(n);i(h),t?.(n)},[n]);const d=(h,b)=>{const v={...n,[h]:Math.max(0,Math.min(30,b))};a(v)},m=h=>{const b=Oe[h];a({...b}),c(h)},u=()=>{a({...Oe.balanced}),c("balanced")},f=()=>Object.values(n).reduce((h,b)=>h+b,0),x=()=>30-f(),j=h=>n[h]/30*100,N=h=>{const b=j(h);return b>=30?"bg-blue-500":b>=20?"bg-green-500":b>=10?"bg-yellow-500":"bg-gray-300"},p=["listening","reading","writing","grammar","idioms","vocabulary"];return s?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"現在のステータス配分"}),e.jsx("div",{className:"space-y-3",children:p.map(h=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:Se[h].icon}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:Se[h].name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${N(h)}`,style:{width:`${j(h)}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 w-8 text-right",children:[n[h],"pt"]})]})]},h))}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"合計ポイント"}),e.jsxs("span",{className:"font-medium",children:[f(),"/30pt"]})]})})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"ステータス配分"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"残りポイント"}),e.jsx("span",{className:`text-sm font-medium ${x()<0?"text-red-500":"text-gray-700"}`,children:x()})]})]}),!o&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-red-600 mr-2",children:"⚠️"}),e.jsx("div",{className:"text-sm text-red-800",children:"合計が30ポイントになるように調整してください。"})]})}),e.jsx("div",{className:"space-y-4",children:p.map(h=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:Se[h].icon}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:Se[h].name}),e.jsx("div",{className:"text-xs text-gray-500",children:Se[h].description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"0",max:"30",value:n[h],onChange:b=>d(h,parseInt(b.target.value)||0),className:"w-16 px-2 py-1 text-sm border border-gray-300 rounded-md text-center"}),e.jsx("span",{className:"text-sm text-gray-600",children:"pt"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${N(h)}`,style:{width:`${j(h)}%`}})})]},h))}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"合計ポイント"}),e.jsxs("span",{className:`font-medium ${f()===30?"text-green-600":"text-red-500"}`,children:[f(),"/30pt"]})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"テンプレート"}),e.jsx("button",{onClick:u,className:"text-xs text-blue-600 hover:text-blue-800",children:"リセット"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Oe).map(([h,b])=>e.jsxs("button",{onClick:()=>m(h),className:`px-3 py-2 text-xs rounded-md border transition-colors ${l===h?"bg-blue-100 border-blue-300 text-blue-700":"bg-gray-50 border-gray-200 text-gray-600 hover:bg-gray-100"}`,children:[h==="balanced"&&"バランス型",h==="vocabulary"&&"語彙重視型",h==="practical"&&"実践重視型",h==="grammar"&&"文法強化型"]},h))})]}),e.jsx("button",{onClick:()=>{C().updateStatusAllocation(n),B()},disabled:!o,className:`w-full py-2 px-4 rounded-md text-sm font-medium transition-colors ${o?"bg-blue-500 text-foreground hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"配分を保存"})]})]})};function st({className:t,...s}){return e.jsx("textarea",{"data-slot":"textarea",className:bs("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var Ks="Label",pt=r.forwardRef((t,s)=>e.jsx(Z.label,{...t,ref:s,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(t.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));pt.displayName=Ks;var xt=pt;const Ys=js("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),je=r.forwardRef(({className:t,...s},n)=>e.jsx(xt,{ref:n,className:me(Ys(),t),...s}));je.displayName=xt.displayName;function nt(t,[s,n]){return Math.min(n,Math.max(s,t))}function Js(t){const s=r.useRef({value:t,previous:t});return r.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var gt=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Zs="VisuallyHidden",en=r.forwardRef((t,s)=>e.jsx(Z.span,{...t,ref:s,style:{...gt,...t.style}}));en.displayName=Zs;var tn=[" ","Enter","ArrowUp","ArrowDown"],sn=[" ","Enter"],ve="Select",[Pe,Re,nn]=rs(ve),[ke,Na]=as(ve,[nn,it]),De=it(),[an,ge]=ke(ve),[rn,on]=ke(ve),ft=t=>{const{__scopeSelect:s,children:n,open:a,defaultOpen:o,onOpenChange:i,value:l,defaultValue:c,onValueChange:d,dir:m,name:u,autoComplete:f,disabled:x,required:j,form:N}=t,p=De(s),[h,b]=r.useState(null),[v,_]=r.useState(null),[F,D]=r.useState(!1),Q=gs(m),[P,L]=Ke({prop:a,defaultProp:o??!1,onChange:i,caller:ve}),[ee,$]=Ke({prop:l,defaultProp:c,onChange:d,caller:ve}),U=r.useRef(null),X=h?N||!!h.closest("form"):!0,[K,I]=r.useState(new Set),Y=Array.from(K).map(E=>E.props.value).join(";");return e.jsx(fs,{...p,children:e.jsxs(an,{required:j,scope:s,trigger:h,onTriggerChange:b,valueNode:v,onValueNodeChange:_,valueNodeHasChildren:F,onValueNodeHasChildrenChange:D,contentId:Ge(),value:ee,onValueChange:$,open:P,onOpenChange:L,dir:Q,triggerPointerDownPosRef:U,disabled:x,children:[e.jsx(Pe.Provider,{scope:s,children:e.jsx(rn,{scope:t.__scopeSelect,onNativeOptionAdd:r.useCallback(E=>{I(z=>new Set(z).add(E))},[]),onNativeOptionRemove:r.useCallback(E=>{I(z=>{const J=new Set(z);return J.delete(E),J})},[]),children:n})}),X?e.jsxs(zt,{"aria-hidden":!0,required:j,tabIndex:-1,name:u,autoComplete:f,value:ee,onChange:E=>$(E.target.value),disabled:x,form:N,children:[ee===void 0?e.jsx("option",{value:""}):null,Array.from(K)]},Y):null]})})};ft.displayName=ve;var wt="SelectTrigger",yt=r.forwardRef((t,s)=>{const{__scopeSelect:n,disabled:a=!1,...o}=t,i=De(n),l=ge(wt,n),c=l.disabled||a,d=ce(s,l.onTriggerChange),m=Re(n),u=r.useRef("touch"),[f,x,j]=Wt(p=>{const h=m().filter(_=>!_.disabled),b=h.find(_=>_.value===l.value),v=Ft(h,p,b);v!==void 0&&l.onValueChange(v.value)}),N=p=>{c||(l.onOpenChange(!0),j()),p&&(l.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)})};return e.jsx(os,{asChild:!0,...i,children:e.jsx(Z.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":Bt(l.value)?"":void 0,...o,ref:d,onClick:W(o.onClick,p=>{p.currentTarget.focus(),u.current!=="mouse"&&N(p)}),onPointerDown:W(o.onPointerDown,p=>{u.current=p.pointerType;const h=p.target;h.hasPointerCapture(p.pointerId)&&h.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&p.pointerType==="mouse"&&(N(p),p.preventDefault())}),onKeyDown:W(o.onKeyDown,p=>{const h=f.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&x(p.key),!(h&&p.key===" ")&&tn.includes(p.key)&&(N(),p.preventDefault())})})})});yt.displayName=wt;var vt="SelectValue",bt=r.forwardRef((t,s)=>{const{__scopeSelect:n,className:a,style:o,children:i,placeholder:l="",...c}=t,d=ge(vt,n),{onValueNodeHasChildrenChange:m}=d,u=i!==void 0,f=ce(s,d.onValueNodeChange);return xe(()=>{m(u)},[m,u]),e.jsx(Z.span,{...c,ref:f,style:{pointerEvents:"none"},children:Bt(d.value)?e.jsx(e.Fragment,{children:l}):i})});bt.displayName=vt;var ln="SelectIcon",jt=r.forwardRef((t,s)=>{const{__scopeSelect:n,children:a,...o}=t;return e.jsx(Z.span,{"aria-hidden":!0,...o,ref:s,children:a||"▼"})});jt.displayName=ln;var cn="SelectPortal",Nt=t=>e.jsx(is,{asChild:!0,...t});Nt.displayName=cn;var be="SelectContent",kt=r.forwardRef((t,s)=>{const n=ge(be,t.__scopeSelect),[a,o]=r.useState();if(xe(()=>{o(new DocumentFragment)},[]),!n.open){const i=a;return i?lt.createPortal(e.jsx(St,{scope:t.__scopeSelect,children:e.jsx(Pe.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),i):null}return e.jsx(_t,{...t,ref:s})});kt.displayName=be;var ie=10,[St,fe]=ke(be),dn="SelectContentImpl",mn=hs("SelectContent.RemoveScroll"),_t=r.forwardRef((t,s)=>{const{__scopeSelect:n,position:a="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:i,onPointerDownOutside:l,side:c,sideOffset:d,align:m,alignOffset:u,arrowPadding:f,collisionBoundary:x,collisionPadding:j,sticky:N,hideWhenDetached:p,avoidCollisions:h,...b}=t,v=ge(be,n),[_,F]=r.useState(null),[D,Q]=r.useState(null),P=ce(s,y=>F(y)),[L,ee]=r.useState(null),[$,U]=r.useState(null),X=Re(n),[K,I]=r.useState(!1),Y=r.useRef(!1);r.useEffect(()=>{if(_)return cs(_)},[_]),ds();const E=r.useCallback(y=>{const[k,...M]=X().map(H=>H.ref.current),[S]=M.slice(-1),T=document.activeElement;for(const H of y)if(H===T||(H?.scrollIntoView({block:"nearest"}),H===k&&D&&(D.scrollTop=0),H===S&&D&&(D.scrollTop=D.scrollHeight),H?.focus(),document.activeElement!==T))return},[X,D]),z=r.useCallback(()=>E([L,_]),[E,L,_]);r.useEffect(()=>{K&&z()},[K,z]);const{onOpenChange:J,triggerPointerDownPosRef:te}=v;r.useEffect(()=>{if(_){let y={x:0,y:0};const k=S=>{y={x:Math.abs(Math.round(S.pageX)-(te.current?.x??0)),y:Math.abs(Math.round(S.pageY)-(te.current?.y??0))}},M=S=>{y.x<=10&&y.y<=10?S.preventDefault():_.contains(S.target)||J(!1),document.removeEventListener("pointermove",k),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",k),document.addEventListener("pointerup",M,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",M,{capture:!0})}}},[_,J,te]),r.useEffect(()=>{const y=()=>J(!1);return window.addEventListener("blur",y),window.addEventListener("resize",y),()=>{window.removeEventListener("blur",y),window.removeEventListener("resize",y)}},[J]);const[de,re]=Wt(y=>{const k=X().filter(T=>!T.disabled),M=k.find(T=>T.ref.current===document.activeElement),S=Ft(k,y,M);S&&setTimeout(()=>S.ref.current.focus())}),ae=r.useCallback((y,k,M)=>{const S=!Y.current&&!M;(v.value!==void 0&&v.value===k||S)&&(ee(y),S&&(Y.current=!0))},[v.value]),g=r.useCallback(()=>_?.focus(),[_]),w=r.useCallback((y,k,M)=>{const S=!Y.current&&!M;(v.value!==void 0&&v.value===k||S)&&U(y)},[v.value]),A=a==="popper"?We:It,R=A===We?{side:c,sideOffset:d,align:m,alignOffset:u,arrowPadding:f,collisionBoundary:x,collisionPadding:j,sticky:N,hideWhenDetached:p,avoidCollisions:h}:{};return e.jsx(St,{scope:n,content:_,viewport:D,onViewportChange:Q,itemRefCallback:ae,selectedItem:L,onItemLeave:g,itemTextRefCallback:w,focusSelectedItem:z,selectedItemText:$,position:a,isPositioned:K,searchRef:de,children:e.jsx(ms,{as:mn,allowPinchZoom:!0,children:e.jsx(us,{asChild:!0,trapped:v.open,onMountAutoFocus:y=>{y.preventDefault()},onUnmountAutoFocus:W(o,y=>{v.trigger?.focus({preventScroll:!0}),y.preventDefault()}),children:e.jsx(ps,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:y=>y.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:e.jsx(A,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:y=>y.preventDefault(),...b,...R,onPlaced:()=>I(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:W(b.onKeyDown,y=>{const k=y.ctrlKey||y.altKey||y.metaKey;if(y.key==="Tab"&&y.preventDefault(),!k&&y.key.length===1&&re(y.key),["ArrowUp","ArrowDown","Home","End"].includes(y.key)){let S=X().filter(T=>!T.disabled).map(T=>T.ref.current);if(["ArrowUp","End"].includes(y.key)&&(S=S.slice().reverse()),["ArrowUp","ArrowDown"].includes(y.key)){const T=y.target,H=S.indexOf(T);S=S.slice(H+1)}setTimeout(()=>E(S)),y.preventDefault()}})})})})})})});_t.displayName=dn;var hn="SelectItemAlignedPosition",It=r.forwardRef((t,s)=>{const{__scopeSelect:n,onPlaced:a,...o}=t,i=ge(be,n),l=fe(be,n),[c,d]=r.useState(null),[m,u]=r.useState(null),f=ce(s,P=>u(P)),x=Re(n),j=r.useRef(!1),N=r.useRef(!0),{viewport:p,selectedItem:h,selectedItemText:b,focusSelectedItem:v}=l,_=r.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&m&&p&&h&&b){const P=i.trigger.getBoundingClientRect(),L=m.getBoundingClientRect(),ee=i.valueNode.getBoundingClientRect(),$=b.getBoundingClientRect();if(i.dir!=="rtl"){const T=$.left-L.left,H=ee.left-T,oe=P.left-H,we=P.width+oe,Le=Math.max(we,L.width),Me=window.innerWidth-ie,He=nt(H,[ie,Math.max(ie,Me-Le)]);c.style.minWidth=we+"px",c.style.left=He+"px"}else{const T=L.right-$.right,H=window.innerWidth-ee.right-T,oe=window.innerWidth-P.right-H,we=P.width+oe,Le=Math.max(we,L.width),Me=window.innerWidth-ie,He=nt(H,[ie,Math.max(ie,Me-Le)]);c.style.minWidth=we+"px",c.style.right=He+"px"}const U=x(),X=window.innerHeight-ie*2,K=p.scrollHeight,I=window.getComputedStyle(m),Y=parseInt(I.borderTopWidth,10),E=parseInt(I.paddingTop,10),z=parseInt(I.borderBottomWidth,10),J=parseInt(I.paddingBottom,10),te=Y+E+K+J+z,de=Math.min(h.offsetHeight*5,te),re=window.getComputedStyle(p),ae=parseInt(re.paddingTop,10),g=parseInt(re.paddingBottom,10),w=P.top+P.height/2-ie,A=X-w,R=h.offsetHeight/2,y=h.offsetTop+R,k=Y+E+y,M=te-k;if(k<=w){const T=U.length>0&&h===U[U.length-1].ref.current;c.style.bottom="0px";const H=m.clientHeight-p.offsetTop-p.offsetHeight,oe=Math.max(A,R+(T?g:0)+H+z),we=k+oe;c.style.height=we+"px"}else{const T=U.length>0&&h===U[0].ref.current;c.style.top="0px";const oe=Math.max(w,Y+p.offsetTop+(T?ae:0)+R)+M;c.style.height=oe+"px",p.scrollTop=k-w+p.offsetTop}c.style.margin=`${ie}px 0`,c.style.minHeight=de+"px",c.style.maxHeight=X+"px",a?.(),requestAnimationFrame(()=>j.current=!0)}},[x,i.trigger,i.valueNode,c,m,p,h,b,i.dir,a]);xe(()=>_(),[_]);const[F,D]=r.useState();xe(()=>{m&&D(window.getComputedStyle(m).zIndex)},[m]);const Q=r.useCallback(P=>{P&&N.current===!0&&(_(),v?.(),N.current=!1)},[_,v]);return e.jsx(pn,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:j,onScrollButtonChange:Q,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:F},children:e.jsx(Z.div,{...o,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});It.displayName=hn;var un="SelectPopperPosition",We=r.forwardRef((t,s)=>{const{__scopeSelect:n,align:a="start",collisionPadding:o=ie,...i}=t,l=De(n);return e.jsx(xs,{...l,...i,ref:s,align:a,collisionPadding:o,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});We.displayName=un;var[pn,Xe]=ke(be,{}),Fe="SelectViewport",At=r.forwardRef((t,s)=>{const{__scopeSelect:n,nonce:a,...o}=t,i=fe(Fe,n),l=Xe(Fe,n),c=ce(s,i.onViewportChange),d=r.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),e.jsx(Pe.Slot,{scope:n,children:e.jsx(Z.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:W(o.onScroll,m=>{const u=m.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:x}=l;if(x?.current&&f){const j=Math.abs(d.current-u.scrollTop);if(j>0){const N=window.innerHeight-ie*2,p=parseFloat(f.style.minHeight),h=parseFloat(f.style.height),b=Math.max(p,h);if(b<N){const v=b+j,_=Math.min(N,v),F=v-_;f.style.height=_+"px",f.style.bottom==="0px"&&(u.scrollTop=F>0?F:0,f.style.justifyContent="flex-end")}}}d.current=u.scrollTop})})})]})});At.displayName=Fe;var Tt="SelectGroup",[xn,gn]=ke(Tt),fn=r.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,o=Ge();return e.jsx(xn,{scope:n,id:o,children:e.jsx(Z.div,{role:"group","aria-labelledby":o,...a,ref:s})})});fn.displayName=Tt;var Ct="SelectLabel",Et=r.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,o=gn(Ct,n);return e.jsx(Z.div,{id:o.id,...a,ref:s})});Et.displayName=Ct;var Ee="SelectItem",[wn,Pt]=ke(Ee),Rt=r.forwardRef((t,s)=>{const{__scopeSelect:n,value:a,disabled:o=!1,textValue:i,...l}=t,c=ge(Ee,n),d=fe(Ee,n),m=c.value===a,[u,f]=r.useState(i??""),[x,j]=r.useState(!1),N=ce(s,v=>d.itemRefCallback?.(v,a,o)),p=Ge(),h=r.useRef("touch"),b=()=>{o||(c.onValueChange(a),c.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(wn,{scope:n,value:a,disabled:o,textId:p,isSelected:m,onItemTextChange:r.useCallback(v=>{f(_=>_||(v?.textContent??"").trim())},[]),children:e.jsx(Pe.ItemSlot,{scope:n,value:a,disabled:o,textValue:u,children:e.jsx(Z.div,{role:"option","aria-labelledby":p,"data-highlighted":x?"":void 0,"aria-selected":m&&x,"data-state":m?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...l,ref:N,onFocus:W(l.onFocus,()=>j(!0)),onBlur:W(l.onBlur,()=>j(!1)),onClick:W(l.onClick,()=>{h.current!=="mouse"&&b()}),onPointerUp:W(l.onPointerUp,()=>{h.current==="mouse"&&b()}),onPointerDown:W(l.onPointerDown,v=>{h.current=v.pointerType}),onPointerMove:W(l.onPointerMove,v=>{h.current=v.pointerType,o?d.onItemLeave?.():h.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:W(l.onPointerLeave,v=>{v.currentTarget===document.activeElement&&d.onItemLeave?.()}),onKeyDown:W(l.onKeyDown,v=>{d.searchRef?.current!==""&&v.key===" "||(sn.includes(v.key)&&b(),v.key===" "&&v.preventDefault())})})})})});Rt.displayName=Ee;var _e="SelectItemText",Dt=r.forwardRef((t,s)=>{const{__scopeSelect:n,className:a,style:o,...i}=t,l=ge(_e,n),c=fe(_e,n),d=Pt(_e,n),m=on(_e,n),[u,f]=r.useState(null),x=ce(s,b=>f(b),d.onItemTextChange,b=>c.itemTextRefCallback?.(b,d.value,d.disabled)),j=u?.textContent,N=r.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:j},d.value),[d.disabled,d.value,j]),{onNativeOptionAdd:p,onNativeOptionRemove:h}=m;return xe(()=>(p(N),()=>h(N)),[p,h,N]),e.jsxs(e.Fragment,{children:[e.jsx(Z.span,{id:d.textId,...i,ref:x}),d.isSelected&&l.valueNode&&!l.valueNodeHasChildren?lt.createPortal(i.children,l.valueNode):null]})});Dt.displayName=_e;var Lt="SelectItemIndicator",Mt=r.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t;return Pt(Lt,n).isSelected?e.jsx(Z.span,{"aria-hidden":!0,...a,ref:s}):null});Mt.displayName=Lt;var Qe="SelectScrollUpButton",Ht=r.forwardRef((t,s)=>{const n=fe(Qe,t.__scopeSelect),a=Xe(Qe,t.__scopeSelect),[o,i]=r.useState(!1),l=ce(s,a.onScrollButtonChange);return xe(()=>{if(n.viewport&&n.isPositioned){let c=function(){const m=d.scrollTop>0;i(m)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),o?e.jsx(Vt,{...t,ref:l,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});Ht.displayName=Qe;var $e="SelectScrollDownButton",Ot=r.forwardRef((t,s)=>{const n=fe($e,t.__scopeSelect),a=Xe($e,t.__scopeSelect),[o,i]=r.useState(!1),l=ce(s,a.onScrollButtonChange);return xe(()=>{if(n.viewport&&n.isPositioned){let c=function(){const m=d.scrollHeight-d.clientHeight,u=Math.ceil(d.scrollTop)<m;i(u)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),o?e.jsx(Vt,{...t,ref:l,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});Ot.displayName=$e;var Vt=r.forwardRef((t,s)=>{const{__scopeSelect:n,onAutoScroll:a,...o}=t,i=fe("SelectScrollButton",n),l=r.useRef(null),c=Re(n),d=r.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return r.useEffect(()=>()=>d(),[d]),xe(()=>{c().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[c]),e.jsx(Z.div,{"aria-hidden":!0,...o,ref:s,style:{flexShrink:0,...o.style},onPointerDown:W(o.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(a,50))}),onPointerMove:W(o.onPointerMove,()=>{i.onItemLeave?.(),l.current===null&&(l.current=window.setInterval(a,50))}),onPointerLeave:W(o.onPointerLeave,()=>{d()})})}),yn="SelectSeparator",qt=r.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t;return e.jsx(Z.div,{"aria-hidden":!0,...a,ref:s})});qt.displayName=yn;var Ue="SelectArrow",vn=r.forwardRef((t,s)=>{const{__scopeSelect:n,...a}=t,o=De(n),i=ge(Ue,n),l=fe(Ue,n);return i.open&&l.position==="popper"?e.jsx(ws,{...o,...a,ref:s}):null});vn.displayName=Ue;var bn="SelectBubbleInput",zt=r.forwardRef(({__scopeSelect:t,value:s,...n},a)=>{const o=r.useRef(null),i=ce(a,o),l=Js(s);return r.useEffect(()=>{const c=o.current;if(!c)return;const d=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(d,"value").set;if(l!==s&&u){const f=new Event("change",{bubbles:!0});u.call(c,s),c.dispatchEvent(f)}},[l,s]),e.jsx(Z.select,{...n,style:{...gt,...n.style},ref:i,defaultValue:s})});zt.displayName=bn;function Bt(t){return t===""||t===void 0}function Wt(t){const s=ls(t),n=r.useRef(""),a=r.useRef(0),o=r.useCallback(l=>{const c=n.current+l;s(c),(function d(m){n.current=m,window.clearTimeout(a.current),m!==""&&(a.current=window.setTimeout(()=>d(""),1e3))})(c)},[s]),i=r.useCallback(()=>{n.current="",window.clearTimeout(a.current)},[]);return r.useEffect(()=>()=>window.clearTimeout(a.current),[]),[n,o,i]}function Ft(t,s,n){const o=s.length>1&&Array.from(s).every(m=>m===s[0])?s[0]:s,i=n?t.indexOf(n):-1;let l=jn(t,Math.max(i,0));o.length===1&&(l=l.filter(m=>m!==n));const d=l.find(m=>m.textValue.toLowerCase().startsWith(o.toLowerCase()));return d!==n?d:void 0}function jn(t,s){return t.map((n,a)=>t[(s+a)%t.length])}var Nn=ft,Qt=yt,kn=bt,Sn=jt,_n=Nt,$t=kt,In=At,Ut=Et,Gt=Rt,An=Dt,Tn=Mt,Xt=Ht,Kt=Ot,Yt=qt;const qe=Nn,ze=kn,Te=r.forwardRef(({className:t,children:s,...n},a)=>e.jsxs(Qt,{ref:a,className:me("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[s,e.jsx(Sn,{asChild:!0,children:e.jsx(ct,{className:"h-4 w-4 opacity-50"})})]}));Te.displayName=Qt.displayName;const Jt=r.forwardRef(({className:t,...s},n)=>e.jsx(Xt,{ref:n,className:me("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Ss,{className:"h-4 w-4"})}));Jt.displayName=Xt.displayName;const Zt=r.forwardRef(({className:t,...s},n)=>e.jsx(Kt,{ref:n,className:me("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(ct,{className:"h-4 w-4"})}));Zt.displayName=Kt.displayName;const Ce=r.forwardRef(({className:t,children:s,position:n="popper",...a},o)=>e.jsx(_n,{children:e.jsxs($t,{ref:o,className:me("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...a,children:[e.jsx(Jt,{}),e.jsx(In,{className:me("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Zt,{})]})}));Ce.displayName=$t.displayName;const Cn=r.forwardRef(({className:t,...s},n)=>e.jsx(Ut,{ref:n,className:me("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s}));Cn.displayName=Ut.displayName;const se=r.forwardRef(({className:t,children:s,...n},a)=>e.jsxs(Gt,{ref:a,className:me("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Tn,{children:e.jsx(_s,{className:"h-4 w-4"})})}),e.jsx(An,{children:s})]}));se.displayName=Gt.displayName;const En=r.forwardRef(({className:t,...s},n)=>e.jsx(Yt,{ref:n,className:me("-mx-1 my-1 h-px bg-muted",t),...s}));En.displayName=Yt.displayName;const Pn=({onClose:t})=>{const[s,n]=r.useState({userLevel:"",learningMode:"",feedback:"",rating:"",suggestions:""}),a=async o=>{o.preventDefault();const i=new FormData;i.append("form-name","learning-feedback"),Object.entries(s).forEach(([l,c])=>{i.append(l,c)});try{await fetch("/",{method:"POST",body:i}),alert("フィードバックを送信しました！ありがとうございます。"),t()}catch(l){console.error("Error submitting feedback:",l),alert("送信に失敗しました。もう一度お試しください。")}};return e.jsxs(V,{className:"w-full max-w-md",children:[e.jsx(ne,{children:e.jsx(le,{children:"学習フィードバック"})}),e.jsx(q,{children:e.jsxs("form",{name:"learning-feedback",onSubmit:a,children:[e.jsx("input",{type:"hidden",name:"form-name",value:"learning-feedback"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(je,{htmlFor:"userLevel",children:"現在のレベル"}),e.jsxs(qe,{value:s.userLevel,onValueChange:o=>n(i=>({...i,userLevel:o})),children:[e.jsx(Te,{children:e.jsx(ze,{placeholder:"レベルを選択"})}),e.jsxs(Ce,{children:[e.jsx(se,{value:"beginner",children:"初級"}),e.jsx(se,{value:"intermediate",children:"中級"}),e.jsx(se,{value:"advanced",children:"上級"})]})]})]}),e.jsxs("div",{children:[e.jsx(je,{htmlFor:"learningMode",children:"お気に入りの学習モード"}),e.jsxs(qe,{value:s.learningMode,onValueChange:o=>n(i=>({...i,learningMode:o})),children:[e.jsx(Te,{children:e.jsx(ze,{placeholder:"学習モードを選択"})}),e.jsxs(Ce,{children:[e.jsx(se,{value:"vocabulary",children:"語彙学習"}),e.jsx(se,{value:"grammar",children:"文法クイズ"}),e.jsx(se,{value:"combined",children:"総合テスト"}),e.jsx(se,{value:"time-attack",children:"タイムアタック"}),e.jsx(se,{value:"tower-defense",children:"タワーディフェンス"})]})]})]}),e.jsxs("div",{children:[e.jsx(je,{htmlFor:"rating",children:"満足度"}),e.jsxs(qe,{value:s.rating,onValueChange:o=>n(i=>({...i,rating:o})),children:[e.jsx(Te,{children:e.jsx(ze,{placeholder:"満足度を選択"})}),e.jsxs(Ce,{children:[e.jsx(se,{value:"5",children:"とても満足"}),e.jsx(se,{value:"4",children:"満足"}),e.jsx(se,{value:"3",children:"普通"}),e.jsx(se,{value:"2",children:"不満"}),e.jsx(se,{value:"1",children:"とても不満"})]})]})]}),e.jsxs("div",{children:[e.jsx(je,{htmlFor:"feedback",children:"学習体験のフィードバック"}),e.jsx(st,{id:"feedback",placeholder:"学習体験について教えてください...",value:s.feedback,onChange:o=>n(i=>({...i,feedback:o.target.value})),rows:4})]}),e.jsxs("div",{children:[e.jsx(je,{htmlFor:"suggestions",children:"改善提案"}),e.jsx(st,{id:"suggestions",placeholder:"改善してほしい点や追加してほしい機能があれば教えてください...",value:s.suggestions,onChange:o=>n(i=>({...i,suggestions:o.target.value})),rows:3})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(O,{type:"submit",className:"flex-1",children:"送信"}),e.jsx(O,{type:"button",variant:"outline",onClick:t,children:"キャンセル"})]})]})]})})]})},Rn=()=>{const[t,s]=r.useState(()=>C().getLevel());return{userLevel:t,addXP:o=>{const i=C(),l=i.addXP(o);return s(i.getLevel()),B(),l},refreshLevel:()=>{const o=C();s(o.getLevel())}}},Dn=()=>{const[t,s]=r.useState(()=>C().getHeartSystem()),n=()=>{const x=C();return x.getHeartSystem().current>0?(x.consumeHeart(),B(),s(x.getHeartSystem()),!0):!1},a=(x=1)=>{const j=C();j.addHeart(x),B(),s(j.getHeartSystem())},o=()=>{const x=C();x.recoverHeart(),B(),s(x.getHeartSystem())},i=()=>{const x=C();x.resetHearts(),B(),s(x.getHeartSystem())},l=()=>{const j=C().getHeartSystem(),p=Date.now()-j.lastRecoveryTime,h=300*1e3;return Math.max(0,h-p)},c=()=>t.current>0,d=()=>t.current>=t.max,m=()=>{if(t.current>=t.max)return 100;const x=l(),j=300*1e3;return Math.max(0,Math.min(100,(j-x)/j*100))},u=()=>{const j=C().processHeartRecovery();return s(j),B(),j},f=()=>{const j=C().processHeartRecovery();s(j),B()};return r.useEffect(()=>{const x=setInterval(()=>{const N=C().getHeartSystem();N.current<N.max&&l()<=0&&u()},1e3);return()=>clearInterval(x)},[t.current]),{heartSystem:t,consumeHeart:n,addHeart:a,recoverHeart:o,resetHearts:i,getTimeUntilRecovery:l,canConsumeHeart:c,isFull:d,getRecoveryProgress:m,processRecovery:u,refreshHearts:f}},Ln=()=>{const[t,s]=r.useState(()=>{try{return C().getStatusAllocation()}catch(d){return console.error("Failed to get status allocation:",d),{listening:5,reading:5,writing:5,grammar:5,idioms:5,vocabulary:5}}}),n=d=>C().updateStatusAllocation(d)?(s(d),B(),!0):!1,a=d=>{const m=C();if(m.applyStatusTemplate(d)){const f=m.getStatusAllocation();return s(f),B(),!0}return!1},o=()=>{const d=C();if(d.resetStatusAllocation()){const u=d.getStatusAllocation();return s(u),B(),!0}return!1},i=()=>Object.values(t).reduce((d,m)=>d+m,0);return{allocation:t,updateAllocation:n,applyTemplate:a,resetAllocation:o,getTotalPoints:i,getRemainingPoints:()=>30-i(),isValid:()=>i()===30}},Mn=({rank:t,showIcon:s=!0,showName:n=!0,showXP:a=!1,question:o,size:i="md",className:l=""})=>{const c=dt[t],d={sm:"text-xs px-2 py-1",md:"text-sm px-3 py-1.5",lg:"text-base px-4 py-2"},m={sm:"text-sm",md:"text-base",lg:"text-lg"};return e.jsxs("div",{className:`inline-flex items-center space-x-1 ${c.bgColor} ${c.color} rounded-full ${d[i]} ${l}`,children:[s&&e.jsx("span",{className:m[i],children:c.icon}),n&&e.jsx("span",{className:"font-medium",children:c.name}),a&&o&&e.jsxs("span",{className:"text-xs opacity-75",children:["+",o.xpReward,"XP"]})]})},Hn=({currentLevel:t,showProbabilities:s=!0})=>{const a=(i=>i<=20?{normal:80,rare:18,epic:2,legendary:0}:i<=40?{normal:60,rare:30,epic:9,legendary:1}:i<=60?{normal:40,rare:35,epic:20,legendary:5}:i<=80?{normal:25,rare:35,epic:30,legendary:10}:{normal:15,rare:30,epic:35,legendary:20})(t),o=["normal","rare","epic","legendary"];return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:["問題ランク出現率 (Level ",t,")"]}),e.jsx("div",{className:"space-y-3",children:o.map(i=>{const l=dt[i],c=a[i];return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:l.icon}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:l.name})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${l.bgColor.replace("bg-","bg-").replace("-100","-500")}`,style:{width:`${c}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 w-8 text-right",children:[c,"%"]})]})]},i)})}),s&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("p",{children:"• レベルが上がるほど高ランクの問題が出現しやすくなります"}),e.jsx("p",{children:"• レジェンド問題はLevel 21以降から出現します"})]})})]})},On=[{id:1,sentence:"I ___ to the store yesterday.",blanks:[{id:"blank1",position:2,correctAnswer:"went"}],options:["go","went","going","goes"],explanation:"過去の時点での行動を表すため、過去形「went」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:2,sentence:"The book ___ on the table ___ mine.",blanks:[{id:"blank1",position:3,correctAnswer:"lying"},{id:"blank2",position:7,correctAnswer:"is"}],options:["lying","laying","is","are","was","were","lying","is"],explanation:"「lying」（横たわっている）と単数形の「is」が正解です。",level:"intermediate",category:"basic-sentence-patterns"},{id:3,sentence:"They ___ playing soccer when it ___ to rain.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:7,correctAnswer:"started"}],options:["were","was","started","start","are","have","were","started"],explanation:"過去進行形「were playing」と過去形「started」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:4,sentence:"I ___ my homework before I ___ to bed.",blanks:[{id:"blank1",position:1,correctAnswer:"finished"},{id:"blank2",position:5,correctAnswer:"went"}],options:["finished","finish","went","go","will finish","will go","finished","went"],explanation:"過去の順序を表すため過去形「finished」と「went」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:5,sentence:"He ___ to the store ___ some milk.",blanks:[{id:"blank1",position:2,correctAnswer:"went"},{id:"blank2",position:5,correctAnswer:"to buy"}],options:["went","goes","to buy","buying","bought","will buy","went","to buy"],explanation:"過去形「went」と目的を表す不定詞「to buy」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:6,sentence:"She ___ her keys ___ she left the house.",blanks:[{id:"blank1",position:2,correctAnswer:"forgot"},{id:"blank2",position:5,correctAnswer:"when"}],options:["forgot","forgets","when","while","before","after","forgot","when"],explanation:"過去形「forgot」と時を表す「when」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:7,sentence:"The students ___ their homework ___ the teacher arrived.",blanks:[{id:"blank1",position:3,correctAnswer:"had finished"},{id:"blank2",position:6,correctAnswer:"when"}],options:["had finished","finished","when","before","after","while","had finished","when"],explanation:"過去完了形「had finished」と時を表す「when」が正解です。",level:"advanced",category:"basic-sentence-patterns"},{id:8,sentence:"I ___ you ___ come to the party tomorrow.",blanks:[{id:"blank1",position:2,correctAnswer:"hope"},{id:"blank2",position:4,correctAnswer:"will"}],options:["hope","hoped","will","would","can","could","hope","will"],explanation:"現在形「hope」と未来形「will」が正解です。",level:"intermediate",category:"basic-sentence-patterns"},{id:9,sentence:"She ___ been studying English ___ three years.",blanks:[{id:"blank1",position:2,correctAnswer:"has"},{id:"blank2",position:6,correctAnswer:"for"}],options:["has","have","for","since","is","was","has","for"],explanation:"現在完了形「has been studying」と期間を表す「for」が正解です。",level:"intermediate",category:"tenses"},{id:10,sentence:"By the time you arrive, I ___ finished my homework.",blanks:[{id:"blank1",position:7,correctAnswer:"will have"}],options:["will have","will","have","had","would have"],explanation:"未来完了形「will have finished」が正解です。",level:"advanced",category:"tenses"},{id:11,sentence:"She ___ English for five years ___ she started working.",blanks:[{id:"blank1",position:2,correctAnswer:"had been studying"},{id:"blank2",position:7,correctAnswer:"when"}],options:["had been studying","has been studying","when","before","after","while","had been studying","when"],explanation:"過去完了進行形「had been studying」と時を表す「when」が正解です。",level:"advanced",category:"tenses"},{id:12,sentence:"The children ___ playing in the park ___ it started raining.",blanks:[{id:"blank1",position:3,correctAnswer:"were"},{id:"blank2",position:7,correctAnswer:"when"}],options:["were","was","when","while","before","after","were","when"],explanation:"過去進行形「were playing」と時を表す「when」が正解です。",level:"beginner",category:"tenses"},{id:13,sentence:"I ___ this book three times already.",blanks:[{id:"blank1",position:2,correctAnswer:"have read"}],options:["have read","read","am reading","will read"],explanation:"現在完了形「have read」が正解です。",level:"intermediate",category:"tenses"},{id:14,sentence:"He ___ to Japan next month.",blanks:[{id:"blank1",position:2,correctAnswer:"will go"}],options:["will go","goes","is going","went"],explanation:"未来形「will go」が正解です。",level:"beginner",category:"tenses"},{id:15,sentence:"I ___ my homework when you called.",blanks:[{id:"blank1",position:2,correctAnswer:"was doing"}],options:["was doing","did","am doing","have done"],explanation:"過去進行形「was doing」が正解です。",level:"intermediate",category:"tenses"},{id:16,sentence:"She ___ here since 2020.",blanks:[{id:"blank1",position:2,correctAnswer:"has lived"}],options:["has lived","lived","is living","will live"],explanation:"現在完了形「has lived」が正解です。",level:"intermediate",category:"tenses"},{id:17,sentence:"You ___ study harder if you want to pass the exam.",blanks:[{id:"blank1",position:2,correctAnswer:"should"}],options:["should","can","must","will"],explanation:"助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:18,sentence:"I ___ speak three languages fluently.",blanks:[{id:"blank1",position:2,correctAnswer:"can"}],options:["can","should","must","will"],explanation:"助動詞「can」が正解です。",level:"beginner",category:"auxiliaries"},{id:19,sentence:"You ___ not smoke in this building.",blanks:[{id:"blank1",position:2,correctAnswer:"must"}],options:["must","can","should","will"],explanation:"助動詞「must」が正解です。",level:"intermediate",category:"auxiliaries"},{id:20,sentence:"I ___ you ___ call me if you need help.",blanks:[{id:"blank1",position:2,correctAnswer:"suggest"},{id:"blank2",position:4,correctAnswer:"should"}],options:["suggest","suggested","should","would","could","might","suggest","should"],explanation:"提案を表す「suggest」と助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:21,sentence:"You ___ have told me earlier.",blanks:[{id:"blank1",position:2,correctAnswer:"should"}],options:["should","can","must","will"],explanation:"助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:22,sentence:"I ___ not believe what I'm seeing.",blanks:[{id:"blank1",position:2,correctAnswer:"can"}],options:["can","should","must","will"],explanation:"助動詞「can」が正解です。",level:"beginner",category:"auxiliaries"},{id:23,sentence:"You ___ be more careful next time.",blanks:[{id:"blank1",position:2,correctAnswer:"should"}],options:["should","can","must","will"],explanation:"助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:24,sentence:"I ___ have finished this by tomorrow.",blanks:[{id:"blank1",position:2,correctAnswer:"will"}],options:["will","can","should","must"],explanation:"助動詞「will」が正解です。",level:"intermediate",category:"auxiliaries"},{id:25,sentence:"The house ___ by a famous architect.",blanks:[{id:"blank1",position:3,correctAnswer:"was designed"}],options:["was designed","designed","is designing","will design"],explanation:"受動態「was designed」が正解です。",level:"intermediate",category:"passive-voice"},{id:26,sentence:"The book ___ in many countries.",blanks:[{id:"blank1",position:3,correctAnswer:"is read"}],options:["is read","reads","was reading","will read"],explanation:"受動態「is read」が正解です。",level:"beginner",category:"passive-voice"},{id:27,sentence:"The door ___ by someone.",blanks:[{id:"blank1",position:3,correctAnswer:"was opened"}],options:["was opened","opened","is opening","will open"],explanation:"受動態「was opened」が正解です。",level:"intermediate",category:"passive-voice"},{id:28,sentence:"The project ___ by the team last month.",blanks:[{id:"blank1",position:3,correctAnswer:"was completed"}],options:["was completed","completed","is completing","will complete"],explanation:"受動態「was completed」が正解です。",level:"intermediate",category:"passive-voice"},{id:29,sentence:"The letter ___ yesterday.",blanks:[{id:"blank1",position:3,correctAnswer:"was sent"}],options:["was sent","sent","is sending","will send"],explanation:"受動態「was sent」が正解です。",level:"beginner",category:"passive-voice"},{id:30,sentence:"The problem ___ by the engineers.",blanks:[{id:"blank1",position:3,correctAnswer:"is being solved"}],options:["is being solved","solves","solved","will solve"],explanation:"受動態進行形「is being solved」が正解です。",level:"advanced",category:"passive-voice"},{id:31,sentence:"The meeting ___ at 3 PM tomorrow.",blanks:[{id:"blank1",position:3,correctAnswer:"will be held"}],options:["will be held","holds","held","is holding"],explanation:"受動態未来形「will be held」が正解です。",level:"intermediate",category:"passive-voice"},{id:32,sentence:"The car ___ by my father.",blanks:[{id:"blank1",position:3,correctAnswer:"was bought"}],options:["was bought","bought","is buying","will buy"],explanation:"受動態「was bought」が正解です。",level:"beginner",category:"passive-voice"},{id:33,sentence:"The movie ___ we watched last night ___ very exciting.",blanks:[{id:"blank1",position:2,correctAnswer:"that"},{id:"blank2",position:7,correctAnswer:"was"}],options:["that","which","who","was","were","is","that","was"],explanation:"関係代名詞「that」と過去形「was」が正解です。",level:"intermediate",category:"relative-clauses"},{id:34,sentence:"The book ___ I read yesterday ___ very interesting.",blanks:[{id:"blank1",position:2,correctAnswer:"which"},{id:"blank2",position:6,correctAnswer:"was"}],options:["which","that","who","was","were","is","which","was"],explanation:"関係代名詞「which」と過去形「was」が正解です。",level:"intermediate",category:"relative-clauses"},{id:35,sentence:"The man ___ is standing there is my teacher.",blanks:[{id:"blank1",position:3,correctAnswer:"who"}],options:["who","which","that","whom"],explanation:"関係代名詞「who」が正解です。",level:"beginner",category:"relative-clauses"},{id:36,sentence:"This is the house ___ I was born.",blanks:[{id:"blank1",position:4,correctAnswer:"where"}],options:["where","which","that","who"],explanation:"関係副詞「where」が正解です。",level:"intermediate",category:"relative-clauses"},{id:37,sentence:"The reason ___ he left is unknown.",blanks:[{id:"blank1",position:3,correctAnswer:"why"}],options:["why","which","that","who"],explanation:"関係副詞「why」が正解です。",level:"intermediate",category:"relative-clauses"},{id:38,sentence:"The day ___ I met you was wonderful.",blanks:[{id:"blank1",position:3,correctAnswer:"when"}],options:["when","which","that","who"],explanation:"関係副詞「when」が正解です。",level:"intermediate",category:"relative-clauses"},{id:39,sentence:"The woman ___ you saw is my sister.",blanks:[{id:"blank1",position:3,correctAnswer:"whom"}],options:["whom","who","which","that"],explanation:"関係代名詞「whom」が正解です。",level:"advanced",category:"relative-clauses"},{id:40,sentence:"The car ___ color is red belongs to me.",blanks:[{id:"blank1",position:3,correctAnswer:"whose"}],options:["whose","which","that","who"],explanation:"関係代名詞「whose」が正解です。",level:"advanced",category:"relative-clauses"},{id:41,sentence:"If I ___ rich, I ___ travel around the world.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:5,correctAnswer:"would"}],options:["were","was","would","will","am","could","were","would"],explanation:"仮定法過去「If I were rich, I would travel」が正解です。",level:"advanced",category:"subjunctive"},{id:42,sentence:"I wish I ___ more time to finish this project.",blanks:[{id:"blank1",position:3,correctAnswer:"had"}],options:["had","have","has","will have"],explanation:"願望を表す「I wish」の後は仮定法過去「had」を使います。",level:"advanced",category:"subjunctive"},{id:43,sentence:"If I ___ you, I ___ study harder.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:5,correctAnswer:"would"}],options:["were","was","would","will","should","could","were","would"],explanation:"仮定法過去「If I were you, I would study」が正解です。",level:"advanced",category:"subjunctive"},{id:44,sentence:"I wish I ___ speak French fluently.",blanks:[{id:"blank1",position:3,correctAnswer:"could"}],options:["could","can","will","would"],explanation:"願望を表す「I wish」の後は仮定法過去「could」を使います。",level:"intermediate",category:"subjunctive"},{id:45,sentence:"If I ___ known earlier, I ___ have come.",blanks:[{id:"blank1",position:2,correctAnswer:"had"},{id:"blank2",position:5,correctAnswer:"would"}],options:["had","have","would","will","could","should","had","would"],explanation:"仮定法過去完了「If I had known, I would have come」が正解です。",level:"advanced",category:"subjunctive"},{id:46,sentence:"I wish I ___ not made that mistake.",blanks:[{id:"blank1",position:3,correctAnswer:"had"}],options:["had","have","has","will have"],explanation:"願望を表す「I wish」の後は仮定法過去完了「had」を使います。",level:"advanced",category:"subjunctive"},{id:47,sentence:"If I ___ you, I ___ not do that.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:5,correctAnswer:"would"}],options:["were","was","would","will","should","could","were","would"],explanation:"仮定法過去「If I were you, I would not do」が正解です。",level:"advanced",category:"subjunctive"},{id:48,sentence:"I wish it ___ stop raining.",blanks:[{id:"blank1",position:3,correctAnswer:"would"}],options:["would","will","can","could"],explanation:"願望を表す「I wish」の後は仮定法過去「would」を使います。",level:"intermediate",category:"subjunctive"},{id:49,sentence:"She is ___ intelligent ___ her sister.",blanks:[{id:"blank1",position:2,correctAnswer:"as"},{id:"blank2",position:4,correctAnswer:"as"}],options:["as","as","so","more","most","than","very","as","as"],explanation:"同等比較「as ... as」の構文が正解です。",level:"intermediate",category:"comparison"},{id:50,sentence:"This book is ___ than that one.",blanks:[{id:"blank1",position:3,correctAnswer:"more interesting"}],options:["more interesting","interesting","most interesting","as interesting"],explanation:"比較級「more interesting」が正解です。",level:"beginner",category:"comparison"},{id:51,sentence:"He is the ___ student in the class.",blanks:[{id:"blank1",position:4,correctAnswer:"tallest"}],options:["tallest","taller","tall","as tall"],explanation:"最上級「tallest」が正解です。",level:"beginner",category:"comparison"},{id:52,sentence:"This is ___ expensive ___ that.",blanks:[{id:"blank1",position:2,correctAnswer:"as"},{id:"blank2",position:4,correctAnswer:"as"}],options:["as","as","so","more","most","than","very","as","as"],explanation:"同等比較「as ... as」の構文が正解です。",level:"intermediate",category:"comparison"},{id:53,sentence:"She runs ___ than her brother.",blanks:[{id:"blank1",position:2,correctAnswer:"faster"}],options:["faster","fast","fastest","as fast"],explanation:"比較級「faster」が正解です。",level:"beginner",category:"comparison"},{id:54,sentence:"This is the ___ beautiful place I've ever seen.",blanks:[{id:"blank1",position:4,correctAnswer:"most"}],options:["most","more","very","as"],explanation:"最上級「most」が正解です。",level:"intermediate",category:"comparison"},{id:55,sentence:"He is ___ than I expected.",blanks:[{id:"blank1",position:2,correctAnswer:"taller"}],options:["taller","tall","tallest","as tall"],explanation:"比較級「taller」が正解です。",level:"beginner",category:"comparison"},{id:56,sentence:"This problem is ___ difficult ___ the previous one.",blanks:[{id:"blank1",position:3,correctAnswer:"as"},{id:"blank2",position:5,correctAnswer:"as"}],options:["as","as","so","more","most","than","very","as","as"],explanation:"同等比較「as ... as」の構文が正解です。",level:"intermediate",category:"comparison"},{id:57,sentence:"___ English is not easy for me.",blanks:[{id:"blank1",position:1,correctAnswer:"Learning"}],options:["Learning","Learn","Learned","To learn"],explanation:"動名詞「Learning」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:58,sentence:"I enjoy ___ books in my free time.",blanks:[{id:"blank1",position:2,correctAnswer:"reading"}],options:["reading","read","to read","reads"],explanation:"動名詞「reading」が正解です。",level:"beginner",category:"participles-gerunds"},{id:59,sentence:"The ___ child was crying loudly.",blanks:[{id:"blank1",position:2,correctAnswer:"crying"}],options:["crying","cry","cried","cries"],explanation:"現在分詞「crying」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:60,sentence:"I saw a ___ bird in the tree.",blanks:[{id:"blank1",position:3,correctAnswer:"singing"}],options:["singing","sing","sang","sings"],explanation:"現在分詞「singing」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:61,sentence:"___ tired, I went to bed early.",blanks:[{id:"blank1",position:1,correctAnswer:"Feeling"}],options:["Feeling","Feel","Felt","To feel"],explanation:"現在分詞「Feeling」が正解です。",level:"advanced",category:"participles-gerunds"},{id:62,sentence:"The ___ book is on the table.",blanks:[{id:"blank1",position:2,correctAnswer:"opened"}],options:["opened","opening","open","opens"],explanation:"過去分詞「opened」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:63,sentence:"I'm looking forward to ___ you again.",blanks:[{id:"blank1",position:4,correctAnswer:"seeing"}],options:["seeing","see","saw","sees"],explanation:"動名詞「seeing」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:64,sentence:"The ___ door was difficult to open.",blanks:[{id:"blank1",position:2,correctAnswer:"broken"}],options:["broken","breaking","break","breaks"],explanation:"過去分詞「broken」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:65,sentence:"I want ___ a doctor when I grow up.",blanks:[{id:"blank1",position:2,correctAnswer:"to become"}],options:["to become","become","becoming","became"],explanation:"不定詞「to become」が正解です。",level:"beginner",category:"infinitives"},{id:66,sentence:"It's important ___ English every day.",blanks:[{id:"blank1",position:3,correctAnswer:"to practice"}],options:["to practice","practice","practicing","practiced"],explanation:"不定詞「to practice」が正解です。",level:"intermediate",category:"infinitives"},{id:67,sentence:"I need ___ some money from the bank.",blanks:[{id:"blank1",position:2,correctAnswer:"to withdraw"}],options:["to withdraw","withdraw","withdrawing","withdrew"],explanation:"不定詞「to withdraw」が正解です。",level:"intermediate",category:"infinitives"},{id:68,sentence:"She decided ___ her job.",blanks:[{id:"blank1",position:2,correctAnswer:"to quit"}],options:["to quit","quit","quitting","quits"],explanation:"不定詞「to quit」が正解です。",level:"intermediate",category:"infinitives"},{id:69,sentence:"It's difficult ___ this problem.",blanks:[{id:"blank1",position:3,correctAnswer:"to solve"}],options:["to solve","solve","solving","solved"],explanation:"不定詞「to solve」が正解です。",level:"intermediate",category:"infinitives"},{id:70,sentence:"I hope ___ you soon.",blanks:[{id:"blank1",position:2,correctAnswer:"to see"}],options:["to see","see","seeing","saw"],explanation:"不定詞「to see」が正解です。",level:"beginner",category:"infinitives"},{id:71,sentence:"She asked me ___ her with the homework.",blanks:[{id:"blank1",position:3,correctAnswer:"to help"}],options:["to help","help","helping","helped"],explanation:"不定詞「to help」が正解です。",level:"intermediate",category:"infinitives"},{id:72,sentence:"It's nice ___ you again.",blanks:[{id:"blank1",position:3,correctAnswer:"to meet"}],options:["to meet","meet","meeting","met"],explanation:"不定詞「to meet」が正解です。",level:"beginner",category:"infinitives"}];function Vn(t,s){let n=On;return t&&(n=n.filter(a=>a.level===t)),s&&(n=n.filter(a=>a.category===s)),n}const qn=[{id:"basic-sentence-patterns",name:"基本文型",description:"SV, SVC, SVO, SVOO, SVOCの基本文型"},{id:"tenses",name:"時制",description:"現在、過去、未来、完了形の時制"},{id:"auxiliaries",name:"助動詞",description:"can, may, must, should等の助動詞"},{id:"passive-voice",name:"受動態",description:"be動詞 + 過去分詞の受動態"},{id:"relative-clauses",name:"関係詞",description:"who, which, that等の関係詞"},{id:"subjunctive",name:"仮定法",description:"if文、wish等の仮定法"},{id:"comparison",name:"比較",description:"比較級、最上級の比較表現"},{id:"participles-gerunds",name:"分詞・動名詞",description:"-ing形の使い分け"},{id:"infinitives",name:"不定詞",description:"to不定詞の用法"}];function zn({onSelectCategory:t,onBack:s}){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(O,{variant:"outline",onClick:s,className:"flex items-center",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"文法カテゴリー選択"}),e.jsx("p",{className:"text-gray-600",children:"学習したい文法カテゴリーを選択してください"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:qn.map(n=>e.jsxs(V,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>t(n.id),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(mt,{className:"w-5 h-5 mr-2 text-blue-600"}),n.name]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600",children:n.description}),e.jsxs("div",{className:"mt-4 flex items-center text-sm text-blue-600",children:["クリックして開始",e.jsx(pe,{className:"w-4 h-4 ml-1 rotate-180"})]})]})]},n.id))})]})})}function es({categoryName:t,onSelectDifficulty:s,onBack:n}){const a=[{id:"beginner",name:"簡単",description:"基本的な文法問題",icon:ht,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"},{id:"intermediate",name:"普通",description:"中級レベルの文法問題",icon:Is,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200"},{id:"advanced",name:"難しい",description:"上級レベルの文法問題",icon:As,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(O,{variant:"outline",onClick:n,className:"flex items-center",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"難易度選択"}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:t}),e.jsx("p",{className:"text-gray-600",children:"学習したい難易度を選択してください"})]}),e.jsx("div",{className:"space-y-4",children:a.map(o=>{const i=o.icon;return e.jsxs(V,{className:`hover:shadow-lg transition-shadow cursor-pointer ${o.bgColor} ${o.borderColor} border-2`,onClick:()=>s(o.id),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(i,{className:`w-5 h-5 mr-2 ${o.color}`}),o.name]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:o.description}),e.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:["クリックして開始",e.jsx(pe,{className:"w-4 h-4 ml-1 rotate-180"})]})]})]},o.id)})})]})})}const Bn=Object.freeze(Object.defineProperty({__proto__:null,GrammarQuizDifficultySelection:es},Symbol.toStringTag,{value:"Module"})),Wn={"basic-grammar":"grammar",tenses:"grammar",modals:"grammar",passive:"grammar",relative:"grammar",subjunctive:"grammar",comparison:"grammar",participle:"grammar",infinitive:"grammar"},Fn={normal:{min:3,max:8},rare:{min:10,max:18},epic:{min:25,max:40},legendary:{min:50,max:100}};function ts(t){if(t<=20){const s=Math.random();return s<.8?"normal":s<.98?"rare":"epic"}else if(t<=40){const s=Math.random();return s<.6?"normal":s<.9?"rare":s<.99?"epic":"legendary"}else if(t<=60){const s=Math.random();return s<.4?"normal":s<.75?"rare":s<.95?"epic":"legendary"}else if(t<=80){const s=Math.random();return s<.25?"normal":s<.6?"rare":s<.9?"epic":"legendary"}else{const s=Math.random();return s<.15?"normal":s<.45?"rare":s<.8?"epic":"legendary"}}function ss(t,s=!1){const n=Fn[t],a=Math.floor(Math.random()*(n.max-n.min+1))+n.min;return s?Math.floor(a*1.5):a}function ka(t,s,n,a){const o=ts(a),i=Wn[s],l=ss(o);return{id:t.id,question:t.japanese,options:t.choices,correctAnswer:t.correctAnswer,explanation:t.explanation,category:s,difficulty:n,rank:o,skillField:i,xpReward:l}}function Qn(t,s,n){return t.filter(a=>{if(n&&a.skillField!==n)return!1;const i=["normal","rare","epic","legendary"].indexOf(a.rank);return i>=i})}function $n(t,s){if(t.length===0)return null;const n=t.map(l=>{const c=s[l.skillField]/30,d=Un(l.rank);return c*d}),a=n.reduce((l,c)=>l+c,0);if(a===0)return t[Math.floor(Math.random()*t.length)];const o=Math.random()*a;let i=0;for(let l=0;l<t.length;l++)if(i+=n[l],o<=i)return t[l];return t[0]}function Un(t){return{normal:1,rare:2,epic:3,legendary:5}[t]}const at=[{id:1,type:"quote",category:"grammar",content:"Grammar is the grave of letters.",translation:"文法は文字の墓場である。",explanation:"マーク・トウェインの言葉。文法にこだわりすぎると、自然な表現力が失われるという意味。"},{id:2,type:"quote",category:"grammar",content:"The limits of my language mean the limits of my world.",translation:"私の言語の限界が、私の世界の限界を意味する。",explanation:"哲学者ルートヴィヒ・ウィトゲンシュタインの言葉。言語が思考の枠組みを作ることを示している。"},{id:3,type:"tip",category:"grammar",content:"English has no future tense!",translation:"英語には未来時制がない！",explanation:"英語では 'will' や 'going to' を使って未来を表現しますが、動詞の形自体は変わりません。"},{id:4,type:"tip",category:"grammar",content:"The word 'set' has the most meanings in English.",translation:"「set」という単語が英語で最も多くの意味を持つ。",explanation:"Oxford English Dictionaryによると、'set'は464の異なる意味を持つ最も多義的な単語です。"},{id:5,type:"quote",category:"grammar",content:"A language is a dialect with an army and navy.",translation:"言語とは、軍隊と海軍を持つ方言である。",explanation:"社会言語学者マックス・ワインライヒの言葉。政治的な力が言語の地位を決定することを示している。"},{id:6,type:"quote",category:"vocabulary",content:"Words are, of course, the most powerful drug used by mankind.",translation:"言葉は、もちろん、人類が使用する最も強力な薬である。",explanation:"小説家ラドヤード・キップリングの言葉。言葉の影響力の大きさを表現している。"},{id:7,type:"tip",category:"vocabulary",content:"English borrows from over 350 languages!",translation:"英語は350以上の言語から借用している！",explanation:"英語の語彙の約80%が他の言語から借用されたもので、特にラテン語、フランス語、ギリシャ語からの借用が多い。"},{id:8,type:"tip",category:"vocabulary",content:"The longest English word is 45 letters long!",translation:"最も長い英語の単語は45文字！",explanation:"'pneumonoultramicroscopicsilicovolcanoconiosis'（塵肺症）が最も長い英単語として知られています。"},{id:9,type:"quote",category:"vocabulary",content:"The difference between the right word and the almost right word is the difference between lightning and a lightning bug.",translation:"正しい単語とほぼ正しい単語の違いは、稲妻と蛍の違いである。",explanation:"マーク・トウェインの言葉。単語選択の重要性を強調している。"},{id:10,type:"tip",category:"vocabulary",content:"Shakespeare invented over 1,700 words!",translation:"シェイクスピアは1,700以上の単語を発明した！",explanation:"'eyeball', 'swagger', 'lonely'など、現在も使われている多くの単語をシェイクスピアが初めて使用した。"},{id:11,type:"quote",category:"general",content:"The best way to learn a language is to speak it.",translation:"言語を学ぶ最良の方法は、それを話すことである。",explanation:"理論だけでなく、実際に使うことで言語は身につくという学習の基本原則。"},{id:12,type:"quote",category:"general",content:"A different language is a different vision of life.",translation:"異なる言語は、異なる人生観である。",explanation:"映画監督フェデリコ・フェリーニの言葉。言語が世界観を形成することを示している。"},{id:13,type:"tip",category:"general",content:"English is spoken by 1.5 billion people worldwide!",translation:"英語は世界中で15億人に話されている！",explanation:"世界人口の約20%が英語を話し、そのうち約4億人が母語として使用している。"},{id:14,type:"tip",category:"general",content:"The word 'OK' comes from 'oll korrect'!",translation:"「OK」という単語は「oll korrect」から来ている！",explanation:"19世紀のアメリカで、'all correct'のスペルミス版として生まれた略語が定着した。"},{id:15,type:"quote",category:"general",content:"If you talk to a man in a language he understands, that goes to his head. If you talk to him in his language, that goes to his heart.",translation:"人が理解する言語で話せば、それは頭に届く。その人の言語で話せば、それは心に届く。",explanation:"ネルソン・マンデラの言葉。母語で話すことの深い影響力を表現している。"},{id:16,type:"tip",category:"general",content:"English has more words than any other language!",translation:"英語は他のどの言語よりも多くの単語を持つ！",explanation:"Oxford English Dictionaryには約60万語が収録されており、これは他の言語を大きく上回る。"},{id:17,type:"quote",category:"general",content:"Language is the road map of a culture. It tells you where its people come from and where they are going.",translation:"言語は文化の地図である。その人々がどこから来て、どこへ向かうかを教えてくれる。",explanation:"言語学者リタ・メイ・ブラウンの言葉。言語と文化の深い関係を示している。"},{id:18,type:"tip",category:"general",content:"The word 'queue' is pronounced the same even if you remove 4 letters!",translation:"「queue」という単語は4文字削除しても発音が同じ！",explanation:"'queue' → 'que' → 'qu' → 'q' と文字を削除しても、すべて 'kyu' と発音される。"},{id:19,type:"quote",category:"general",content:"One language sets you in a corridor for life. Two languages open every door along the way.",translation:"一つの言語は人生の廊下にあなたを置く。二つの言語は道中のすべての扉を開く。",explanation:"フランク・スミスの言葉。多言語習得の価値を表現している。"},{id:20,type:"tip",category:"general",content:"The shortest complete sentence in English is 'I am.'",translation:"英語で最も短い完全な文は「I am.」である。",explanation:"主語と動詞を含む完全な文として、最も短い形の例。"},{id:21,type:"quote",category:"general",content:"May the Force be with you.",translation:"フォースが共にあらんことを。",explanation:"スター・ウォーズシリーズの有名なセリフ。日常でも「頑張って」の意味で使われる。"},{id:22,type:"quote",category:"general",content:"I'll be back.",translation:"また戻ってくる。",explanation:"ターミネーターシリーズのアーノルド・シュワルツェネッガーの名セリフ。最も有名な映画のセリフの一つ。"},{id:23,type:"quote",category:"general",content:"Life is like a box of chocolates. You never know what you're gonna get.",translation:"人生はチョコレートの箱のようなもの。何が入っているかわからない。",explanation:"映画「フォレスト・ガンプ」の名セリフ。人生の不確実性を表現した美しい比喩。"},{id:24,type:"quote",category:"general",content:"To infinity and beyond!",translation:"無限の彼方へ！",explanation:"トイ・ストーリーのバズ・ライトイヤーの決めゼリフ。目標に向かって突き進む気持ちを表現。"},{id:25,type:"quote",category:"general",content:"I'm the king of the world!",translation:"俺は世界の王だ！",explanation:"映画「タイタニック」のジャックのセリフ。自由と希望を表現した名シーン。"},{id:26,type:"quote",category:"general",content:"You can't handle the truth!",translation:"お前には真実は扱えない！",explanation:"映画「ア・フュー・グッドメン」の名セリフ。真実の重さを表現した力強い言葉。"},{id:27,type:"quote",category:"general",content:"Houston, we have a problem.",translation:"ヒューストン、問題が発生しました。",explanation:"映画「アポロ13」のセリフ。危機的状況を冷静に報告する際の表現として使われる。"},{id:28,type:"quote",category:"general",content:"Elementary, my dear Watson.",translation:"初歩的なことだ、ワトソン君。",explanation:"シャーロック・ホームズの名セリフ。推理小説やドラマでよく使われる表現。"},{id:29,type:"quote",category:"general",content:"I'll make him an offer he can't refuse.",translation:"断れない条件を提示してやる。",explanation:"映画「ゴッドファーザー」の名セリフ。ビジネスでも使われる強気な表現。"},{id:30,type:"quote",category:"general",content:"Keep your friends close, but your enemies closer.",translation:"友人は近くに、敵はもっと近くに置け。",explanation:"映画「ゴッドファーザー」の名セリフ。戦略的思考を表現した格言として使われる。"},{id:31,type:"quote",category:"general",content:"I'm walking here!",translation:"歩いてるんだよ！",explanation:"映画「ミッドナイト・カウボーイ」の名セリフ。ニューヨークの街角でよく使われる表現。"},{id:32,type:"quote",category:"general",content:"Here's looking at you, kid.",translation:"君を見つめているよ、坊や。",explanation:"映画「カサブランカ」の名セリフ。別れの際の美しい表現として知られる。"},{id:33,type:"quote",category:"general",content:"I'll be there for you.",translation:"君のためにそこにいるよ。",explanation:"ドラマ「フレンズ」のテーマソングの歌詞。友情を表現した温かい言葉。"},{id:34,type:"quote",category:"general",content:"Winter is coming.",translation:"冬が来る。",explanation:"ドラマ「ゲーム・オブ・スローンズ」の名セリフ。警告や予兆を表現する際に使われる。"},{id:35,type:"quote",category:"general",content:"You know nothing, Jon Snow.",translation:"君は何も知らない、ジョン・スノー。",explanation:"ドラマ「ゲーム・オブ・スローンズ」のイグリットのセリフ。無知を指摘する際に使われる。"},{id:36,type:"quote",category:"general",content:"I am Iron Man.",translation:"俺はアイアンマンだ。",explanation:"映画「アイアンマン」シリーズのトニー・スタークのセリフ。自信を表現する際に使われる。"},{id:37,type:"quote",category:"general",content:"With great power comes great responsibility.",translation:"大きな力には大きな責任が伴う。",explanation:"スパイダーマンシリーズの名セリフ。責任感の重要性を表現した格言。"},{id:38,type:"quote",category:"general",content:"I'm Batman.",translation:"俺はバットマンだ。",explanation:"バットマンシリーズの名セリフ。シンプルで力強い自己紹介の表現。"},{id:39,type:"quote",category:"general",content:"I'm not a smart man, but I know what love is.",translation:"俺は賢い男じゃないが、愛が何かは知っている。",explanation:"映画「フォレスト・ガンプ」の名セリフ。シンプルで心に響く愛の表現。"},{id:40,type:"quote",category:"general",content:"I'm the captain now.",translation:"俺が船長だ。",explanation:"映画「キャプテン・フィリップス」の名セリフ。主導権を握った際の表現として使われる。"},{id:41,type:"quote",category:"general",content:"I see dead people.",translation:"死んだ人が見える。",explanation:"映画「シックス・センス」の名セリフ。超自然現象を表現する際に使われる。"},{id:42,type:"quote",category:"general",content:"There's no place like home.",translation:"家ほど良い場所はない。",explanation:"映画「オズの魔法使い」のドロシーのセリフ。故郷の大切さを表現した名セリフ。"},{id:43,type:"quote",category:"general",content:"I'm going to make him an offer he can't refuse.",translation:"断れない条件を提示してやる。",explanation:"映画「ゴッドファーザー」の名セリフ。ビジネスでも使われる強気な表現。"},{id:44,type:"quote",category:"general",content:"I'll have what she's having.",translation:"彼女と同じものをください。",explanation:"映画「ハリーとサリー」の名セリフ。レストランでよく使われる表現。"},{id:45,type:"quote",category:"general",content:"I'm the king of the world!",translation:"俺は世界の王だ！",explanation:"映画「タイタニック」のジャックのセリフ。自由と希望を表現した名シーン。"},{id:46,type:"quote",category:"general",content:"I'm walking here!",translation:"歩いてるんだよ！",explanation:"映画「ミッドナイト・カウボーイ」の名セリフ。ニューヨークの街角でよく使われる表現。"},{id:47,type:"quote",category:"general",content:"I'll be back.",translation:"また戻ってくる。",explanation:"ターミネーターシリーズのアーノルド・シュワルツェネッガーの名セリフ。最も有名な映画のセリフの一つ。"},{id:48,type:"quote",category:"general",content:"I'm the king of the world!",translation:"俺は世界の王だ！",explanation:"映画「タイタニック」のジャックのセリフ。自由と希望を表現した名シーン。"},{id:49,type:"quote",category:"general",content:"I'm walking here!",translation:"歩いてるんだよ！",explanation:"映画「ミッドナイト・カウボーイ」の名セリフ。ニューヨークの街角でよく使われる表現。"},{id:50,type:"quote",category:"general",content:"I'll be back.",translation:"また戻ってくる。",explanation:"ターミネーターシリーズのアーノルド・シュワルツェネッガーの名セリフ。最も有名な映画のセリフの一つ。"}];function Gn(t){let s=at;s=at.filter(a=>a.category===t);const n=Math.floor(Math.random()*s.length);return s[n]}const Xn="ontouchstart"in window||navigator.maxTouchPoints>0;function Kn({blankId:t,droppedWord:s,onDrop:n}){const[{isOver:a},o]=Ls({accept:"word",drop:i=>n(t,i.word),collect:i=>({isOver:i.isOver()})});return e.jsx("span",{ref:o,className:`
        inline-block min-w-[80px] h-8 px-3 mx-1 border-2 border-dashed rounded-md
        flex items-center justify-center text-center
        ${a?"border-blue-500 bg-blue-50":"border-gray-300"}
        ${s?"bg-blue-100 border-blue-400 border-solid":""}
        transition-all duration-200
      `,children:s||"?"})}function Yn({word:t}){const[{isDragging:s},n]=Ds({type:"word",item:{word:t},collect:a=>({isDragging:a.isDragging()})});return e.jsx("span",{ref:n,className:`
        inline-block px-3 py-1 mx-1 mb-2 bg-blue-100 text-blue-800 rounded-md cursor-move
        hover:bg-blue-200 transition-colors duration-200
        ${s?"opacity-50":""}
      `,children:t})}function ns({onBack:t,category:s,difficulty:n="intermediate"}){const[a,o]=r.useState([]),[i,l]=r.useState(0),[c,d]=r.useState({}),[m,u]=r.useState(0),[f,x]=r.useState(!1),[j,N]=r.useState(0),[p,h]=r.useState([]),[b,v]=r.useState(!1),[_,F]=r.useState(null),[D,Q]=r.useState(null),[P]=r.useState(()=>C()),[L,ee]=r.useState(P.getHeartSystem()),[$,U]=r.useState(P.getLevel()),[X]=r.useState(P.getStatusAllocation());r.useEffect(()=>{if(!P.consumeHeart()){alert("体力が不足しています。回復を待ってから再試行してください。"),t();return}K(),N(Date.now()),ee(P.getHeartSystem()),B()},[]);const K=()=>{console.log("Generating questions for category:",s,"difficulty:",n);const g=Vn(n,s);if(console.log("Original questions:",g),!g||g.length===0){console.error("No grammar questions found for difficulty:",n),o([]);return}const w=g.map((k,M)=>{const S=ts($.level),T="grammar",H=ss(S);return{id:k.id,question:k.sentence,options:k.options,correctAnswer:k.blanks.map(oe=>oe.correctAnswer).join(" "),explanation:k.explanation,category:"basic-grammar",difficulty:"normal",rank:S,skillField:T,xpReward:H,blanks:k.blanks}});console.log("Enhanced questions:",w);const A=Qn(w,$.level);console.log("Filtered questions:",A);const R=[],y=8;for(let k=0;k<y;k++){const M=A.filter(S=>!R.some(T=>T.id===S.id));if(M.length>0){const S=$n(M,X);S&&R.push(S)}}console.log("Selected questions:",R),o(R)},I=a[i]||null,Y=a.length>0?(i+1)/a.length*100:0;r.useEffect(()=>{if(I&&I.options){const g=[...I.options].sort(()=>Math.random()-.5);h(g),d({}),v(!1),F(null),Q(null)}},[i,I]);const E=(g,w)=>{d(A=>({...A,[g]:w}))},z=()=>{if(!I||!I.blanks)return!1;let g=!0;for(const w of I.blanks){const A=c[w.id];if(!A||A!==w.correctAnswer){g=!1;break}}return g},J=()=>{const g=z();F(g),g&&u(w=>w+1),Q(Gn("grammar")),v(!0)},te=()=>{v(!1),F(null),i<a.length-1?l(g=>g+1):de()},de=()=>{x(!0);const g=Ms(a.length>0?a.map((A,R)=>({questionId:A.id,answer:c[`blank_${R}`]||"",isCorrect:m>0})):[],I?.rank||"normal",!0),w=P.addXP(g);U(P.getLevel()),B(),w.leveledUp?Ye.sounds.levelUp():Ye.sounds.complete()},re=()=>{if(!I||!I.blanks)return null;const g=I.question,w=I.blanks,A=g.split(" "),R=[];let y=0;for(let k=0;k<A.length;k++){const M=A[k],S=w.find(T=>T.position===k+1);S?(R.push(e.jsx(Kn,{blankId:S.id,droppedWord:c[S.id]||null,onDrop:E},`blank_${y}`)),y++):R.push(e.jsx("span",{className:"mx-1",children:M},k))}return R},ae=()=>{l(0),d({}),u(0),x(!1),K(),N(Date.now())};return a.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(V,{className:"mb-6",children:[e.jsx(ne,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(O,{onClick:t,variant:"outline",size:"sm",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"文法クイズ"})]})})}),e.jsx(q,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-lg text-gray-600",children:"問題を読み込み中..."}),e.jsx("div",{className:"text-sm text-gray-500",children:"しばらくお待ちください"}),e.jsxs(O,{onClick:ae,variant:"outline",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"再読み込み"]})]})})]})})}):f?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(V,{className:"mb-6",children:[e.jsx(ne,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"クイズ結果"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[L.current,"/",L.max]})]})]})}),e.jsx(q,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"text-4xl font-bold text-blue-600",children:[m," / ",a.length]}),e.jsxs("div",{className:"text-lg text-gray-600",children:["正解率: ",Math.round(m/a.length*100),"%"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["獲得XP: ",a.reduce((g,w)=>g+w.xpReward,0)]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"問題解説"}),a.map((g,w)=>e.jsxs("div",{className:"text-left p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"font-medium text-gray-800 mb-2",children:["問題 ",w+1,": ",g.question]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"解説:"})," ",g.explanation]})]},g.id))]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs(O,{onClick:ae,className:"flex items-center",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"もう一度挑戦"]}),e.jsxs(O,{onClick:t,variant:"outline",className:"flex items-center",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"ホームに戻る"]})]})]})})]})})}):!I||a.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(V,{children:e.jsxs(q,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-lg text-gray-600",children:a.length===0?"問題が見つかりませんでした":"問題を読み込み中..."}),e.jsxs(O,{onClick:t,className:"mt-4",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"戻る"]})]})})})}):e.jsx(Ts,{backend:Xn?Cs:Es,children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(V,{className:"mb-6",children:[e.jsx(ne,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(O,{onClick:t,variant:"outline",size:"sm",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"文法クイズ"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[L.current,"/",L.max]})]}),e.jsxs(ue,{variant:"secondary",children:["Level ",$.level]})]})]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["問題 ",i+1,"/",a.length]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[i+1," / ",a.length]})]}),e.jsx(Ns,{value:Y,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["スコア: ",m," / ",a.length]}),e.jsx(Mn,{rank:I.rank,showXP:!0,question:I,size:"sm"})]})]})})]}),e.jsx(V,{className:"mb-6",children:e.jsx(q,{className:"p-6",children:I?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-2",children:I.question}),e.jsx("p",{className:"text-sm text-gray-600",children:"空欄に適切な単語をドラッグして文を完成させてください"})]}),e.jsx("div",{className:"text-center text-lg",children:re()}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"単語を選んでください"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:p.map((g,w)=>e.jsx(Yn,{word:g},w))})]})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-lg text-gray-600",children:"問題を読み込み中..."}),e.jsx("div",{className:"text-sm text-gray-500",children:"しばらくお待ちください"}),e.jsxs(O,{onClick:ae,variant:"outline",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"再読み込み"]})]})})}),b&&I&&e.jsx(V,{className:"mb-6 border-2 border-blue-200 bg-blue-50",children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2",children:_?e.jsxs(e.Fragment,{children:[e.jsx(Ps,{className:"w-6 h-6 text-green-500"}),e.jsx("span",{className:"text-xl font-bold text-green-600",children:"正解！"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Rs,{className:"w-6 h-6 text-red-500"}),e.jsx("span",{className:"text-xl font-bold text-red-600",children:"不正解"})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"正解:"}),e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:I.blanks?.map(g=>g.correctAnswer).join(" ")})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"解説:"}),e.jsx("div",{className:"text-gray-800",children:I.explanation})]}),D&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-sm text-purple-700 mb-2 font-medium",children:D.type==="quote"?"💭 英語の格言":"💡 英語の豆知識"}),e.jsxs("div",{className:"text-purple-800 mb-2 font-semibold",children:['"',D.content,'"']}),e.jsx("div",{className:"text-sm text-purple-600 mb-1",children:D.translation}),D.explanation&&e.jsx("div",{className:"text-xs text-purple-500 italic",children:D.explanation}),e.jsx("div",{className:"mt-2 text-xs text-purple-600",children:_?`+${I.xpReward}XP 獲得！`:"正解を覚えて次回に活かしましょう！"})]}),e.jsx(O,{onClick:te,size:"lg",className:"mt-4",children:i<a.length-1?"次の問題へ":"結果を見る"})]})})}),!b&&e.jsx("div",{className:"flex justify-center",children:e.jsx(O,{onClick:J,size:"lg",children:i<a.length-1?"次の問題":"答え合わせ"})})]})})})}const Jn=Object.freeze(Object.defineProperty({__proto__:null,EnhancedGrammarQuiz:ns},Symbol.toStringTag,{value:"Module"}));function Zn({onNavigateToGrammar:t,onNavigateToVocabulary:s,onNavigateToGrammarQuiz:n,onNavigateToEssay:a,onNavigateToCombinedTest:o,onNavigateToAchievements:i,onNavigateToAppSettings:l,onNavigateToTimeAttack:c,onNavigateToSimpleTowerDefense:d}){const{userLevel:m,refreshLevel:u}=Rn(),{heartSystem:f,processRecovery:x,refreshHearts:j}=Dn();Ln();const N=()=>{j()},[p,h]=r.useState(Ne.getUserStats()),[b,v]=r.useState(!1),[_,F]=r.useState(!1),[D,Q]=r.useState(!1),[P,L]=r.useState(!1),[ee,$]=r.useState(!1),[U,X]=r.useState(""),[K,I]=r.useState("beginner"),[Y,E]=r.useState(!1);r.useEffect(()=>{(()=>{const R=Ne.getUserStats();h(R),u()})();const A=setInterval(()=>{x()},6e4);return()=>clearInterval(A)},[]);const z=w=>{switch(w){case"grammar":Q(!0);break;case"vocabulary":s();break;case"writing":a();break;case"combined":o();break;case"timeattack":c();break}},J=w=>{X(w),Q(!1),L(!0)},te=w=>{I(w),L(!1),$(!0)},de=()=>{$(!1),L(!1),Q(!1)},re=()=>{L(!1),Q(!0)},ae=()=>{Q(!1)},g=f.current>0;return r.useEffect(()=>{const w=setInterval(()=>{N()},1e3);return()=>clearInterval(w)},[]),D?e.jsx(zn,{onSelectCategory:J,onBack:ae}):P?e.jsx(es,{categoryName:U,onSelectDifficulty:te,onBack:re}):ee?e.jsx(ns,{category:U,difficulty:K,onBack:de}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"ENTP英語学習アプリ"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"あなたの英語学習をサポートします"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>v(!b),children:[e.jsx(Hs,{className:"w-4 h-4 mr-2"}),b?"統計を隠す":"統計を表示"]}),e.jsxs(O,{variant:"outline",size:"sm",onClick:()=>F(!_),children:[e.jsx(Os,{className:"w-4 h-4 mr-2"}),"ステータス設定"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Us,{showDetailed:b,showChapterProgress:b})}),e.jsx("div",{children:e.jsx(Gs,{showRecoveryTime:!0,onHeartChange:N})})]}),_&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Xs,{}),e.jsx(Hn,{currentLevel:m.level,showProbabilities:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(V,{className:`hover:shadow-lg transition-shadow cursor-pointer ${g?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>g&&z("grammar"),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(Je,{className:"w-5 h-5 mr-2 text-blue-600"}),"文法クイズ"]}),e.jsx(ue,{variant:"secondary",children:"文法"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"9つのカテゴリーから文法問題に挑戦"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"必要体力: 1 ♥"}),e.jsxs("div",{className:"flex items-center text-sm font-medium",children:[g?"クリックして開始":"体力不足",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]}),e.jsxs(V,{className:`hover:shadow-lg transition-shadow cursor-pointer ${g?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>g&&z("vocabulary"),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(mt,{className:"w-5 h-5 mr-2 text-green-600"}),"語彙学習"]}),e.jsx(ue,{variant:"secondary",children:"語彙"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"レベル別・カテゴリー別の単語学習"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"必要体力: 1 ♥"}),e.jsxs("div",{className:"flex items-center text-sm font-medium",children:[g?"クリックして開始":"体力不足",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]}),e.jsxs(V,{className:`hover:shadow-lg transition-shadow cursor-pointer ${g?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>g&&z("combined"),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(Ze,{className:"w-5 h-5 mr-2 text-purple-600"}),"総合テスト"]}),e.jsx(ue,{variant:"secondary",children:"総合"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"全分野から出題される総合テスト"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"必要体力: 1 ♥"}),e.jsxs("div",{className:"flex items-center text-sm font-medium",children:[g?"クリックして開始":"体力不足",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]}),e.jsxs(V,{className:`hover:shadow-lg transition-shadow cursor-pointer ${g?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>g&&z("timeattack"),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(et,{className:"w-5 h-5 mr-2 text-orange-600"}),"タイムアタック"]}),e.jsx(ue,{variant:"secondary",children:"スピード"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"制限時間内で問題を解くスピード重視モード"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"必要体力: 1 ♥"}),e.jsxs("div",{className:"flex items-center text-sm font-medium",children:[g?"クリックして開始":"体力不足",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]}),e.jsxs(V,{className:`hover:shadow-lg transition-shadow cursor-pointer ${g?"":"opacity-50 cursor-not-allowed"}`,onClick:()=>g&&z("writing"),children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(Je,{className:"w-5 h-5 mr-2 text-indigo-600"}),"英作文"]}),e.jsx(ue,{variant:"secondary",children:"ライティング"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"文法カテゴリー別の4択英作文問題"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"必要体力: 1 ♥"}),e.jsxs("div",{className:"flex items-center text-sm font-medium",children:[g?"クリックして開始":"体力不足",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]}),e.jsxs(V,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(Vs,{className:"w-5 h-5 mr-2 text-red-600"}),"タワーディフェンス"]}),e.jsx(ue,{variant:"secondary",children:"ゲーム"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"英語学習要素を含むタワーディフェンスゲーム"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"体力不要"}),e.jsxs(O,{onClick:d,className:"flex items-center",children:["開始",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]}),e.jsxs(V,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsx(ne,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(le,{className:"text-lg flex items-center",children:[e.jsx(qs,{className:"w-5 h-5 mr-2 text-yellow-600"}),"実績"]}),e.jsx(ue,{variant:"secondary",children:"進捗"})]})}),e.jsxs(q,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"学習の進捗とアチーブメントを確認"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"体力不要"}),e.jsxs(O,{onClick:i,className:"flex items-center",children:["確認",e.jsx(ye,{className:"w-4 h-4 ml-1"})]})]})]})]})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs(O,{variant:"outline",onClick:()=>E(!0),className:"flex items-center space-x-2",children:[e.jsx(ht,{className:"w-4 h-4"}),e.jsx("span",{children:"学習フィードバック"})]})}),b&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"今日のXP"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p.todayXP||0})]}),e.jsx(zs,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"総学習時間"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[Math.floor((p.totalStudyTime||0)/60),"分"]})]}),e.jsx(et,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"正解率"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[p.totalQuestionsAnswered>0?(p.correctAnswers/p.totalQuestionsAnswered*100).toFixed(1):"0.0","%"]})]}),e.jsx(Ze,{className:"w-8 h-8 text-purple-600"})]})})}),e.jsx(V,{children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"連続学習日数"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[p.currentStreak||0,"日"]})]}),e.jsx(Bs,{className:"w-8 h-8 text-orange-600"})]})})})]}),!g&&e.jsx(V,{className:"border-yellow-200 bg-yellow-50",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"w-5 h-5 text-yellow-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-800",children:"体力が不足しています"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"体力が回復するまで待つか、他の機能を利用してください。"})]})]})})}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(Pn,{onClose:()=>E(!1)})})})]})})}function ea(){const[t,s]=r.useState(null),[n,a]=r.useState(!1),[o,i]=r.useState(!1);r.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){i(!0);return}const m=f=>{f.preventDefault(),s(f),a(!0)},u=()=>{i(!0),a(!1),s(null)};return window.addEventListener("beforeinstallprompt",m),window.addEventListener("appinstalled",u),()=>{window.removeEventListener("beforeinstallprompt",m),window.removeEventListener("appinstalled",u)}},[]);const l=async()=>{if(!t)return;t.prompt();const{outcome:m}=await t.userChoice;console.log(m==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),s(null),a(!1)},c=()=>{a(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};if(o||!n)return null;const d=localStorage.getItem("pwa-install-dismissed");return d&&(Date.now()-parseInt(d))/864e5<7?null:e.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:"アプリをインストール"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mb-3",children:"オフラインでも学習を続けられます。ホーム画面に追加して、より快適にご利用ください。"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{onClick:l,size:"sm",className:"flex items-center gap-1",children:[e.jsx(Ws,{className:"w-3 h-3"}),"インストール"]}),e.jsxs(O,{onClick:c,variant:"outline",size:"sm",className:"flex items-center gap-1",children:[e.jsx(ut,{className:"w-3 h-3"}),"後で"]})]})]})})})})}function ta(){const[t,s]=r.useState(!1),[n,a]=r.useState(!1);r.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}),navigator.serviceWorker.getRegistration().then(l=>{l&&l.addEventListener("updatefound",()=>{const c=l.installing;c&&c.addEventListener("statechange",()=>{c.state==="installed"&&navigator.serviceWorker.controller&&s(!0)})})}))},[]);const o=()=>{a(!0),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(l=>{l&&l.waiting&&l.waiting.postMessage({type:"SKIP_WAITING"})})},i=()=>{s(!1)};return t?e.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg shadow-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-1",children:"アップデートが利用可能"}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mb-3",children:"新しいバージョンが利用可能です。最新の機能と改善を体験するために更新してください。"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{onClick:o,size:"sm",className:"flex items-center gap-1 bg-blue-600 hover:bg-blue-700",disabled:n,children:[e.jsx(Fs,{className:`w-3 h-3 ${n?"animate-spin":""}`}),n?"更新中...":"更新"]}),e.jsxs(O,{onClick:i,variant:"outline",size:"sm",className:"flex items-center gap-1 border-blue-300 text-blue-700 hover:bg-blue-100 dark:border-blue-700 dark:text-blue-300 dark:hover:bg-blue-800",children:[e.jsx(ut,{className:"w-3 h-3"}),"後で"]})]})]})})})}):null}const Ae={"basic-grammar":{easy:[{id:1,japanese:"私は学生です。",correctAnswer:"I am a student.",explanation:'「私は～です」は "I am ~" で表現します。',choices:["I am a student.","I am student.","I'm the student.","I was a student."]},{id:2,japanese:"彼は医者です。",correctAnswer:"He is a doctor.",explanation:'三人称単数の主語には "is" を使います。',choices:["He is a doctor.","He are a doctor.","He am a doctor.","He was a doctor."]},{id:3,japanese:"私たちは友達です。",correctAnswer:"We are friends.",explanation:'複数の主語には "are" を使います。',choices:["We are friends.","We is friends.","We am friends.","We were friends."]},{id:4,japanese:"彼女は忙しいです。",correctAnswer:"She is busy.",explanation:"形容詞を使った文では be動詞が必要です。",choices:["She is busy.","She busy.","She are busy.","She has busy."]},{id:5,japanese:"私は本を読みます。",correctAnswer:"I read a book.",explanation:"一般動詞の現在形では、一人称は動詞の原形を使います。",choices:["I read a book.","I reads a book.","I am read a book.","I reading a book."]},{id:6,japanese:"彼は音楽を聞きます。",correctAnswer:"He listens to music.",explanation:"三人称単数では動詞に -s をつけます。",choices:["He listens to music.","He listen to music.","He is listen to music.","He listening to music."]},{id:7,japanese:"私たちは学校に行きます。",correctAnswer:"We go to school.",explanation:"複数の主語では動詞の原形を使います。",choices:["We go to school.","We goes to school.","We are go to school.","We going to school."]},{id:8,japanese:"この花は美しいです。",correctAnswer:"This flower is beautiful.",explanation:'"This" は単数なので be動詞は "is" を使います。',choices:["This flower is beautiful.","This flower are beautiful.","This flowers is beautiful.","This flower beautiful."]},{id:9,japanese:"私は日本人です。",correctAnswer:"I am Japanese.",explanation:"国籍を表すときも be動詞を使います。",choices:["I am Japanese.","I am a Japanese.","I Japanese.","I from Japanese."]},{id:10,japanese:"猫は魚が好きです。",correctAnswer:"Cats like fish.",explanation:"一般的な事実を表すときは現在形を使います。",choices:["Cats like fish.","Cats likes fish.","Cats are like fish.","Cat like fish."]}],normal:[{id:11,japanese:"私は毎日学校に歩いて行きます。",correctAnswer:"I walk to school every day.",explanation:"習慣を表す現在形では、副詞句で時間を表現します。",hint:"walk, school, every day"},{id:12,japanese:"彼女は先生になりたがっています。",correctAnswer:"She wants to be a teacher.",explanation:'"want to + 動詞" で「～したい」を表現します。',hint:"wants, to be, teacher"},{id:13,japanese:"私たちの学校にはたくさんの生徒がいます。",correctAnswer:"There are many students in our school.",explanation:'存在を表す "There are" を使い、複数形に注意します。',hint:"There are, many students, our school"},{id:14,japanese:"その問題はとても難しくありません。",correctAnswer:"The problem is not very difficult.",explanation:`be動詞の否定形は "is not" または "isn't" を使います。`,hint:"problem, is not, very difficult"},{id:15,japanese:"彼は英語と数学を勉強しています。",correctAnswer:"He studies English and math.",explanation:'三人称単数の現在形では "studies" (y→ies) となります。',hint:"studies, English, math"},{id:16,japanese:"私の兄は大学で働いています。",correctAnswer:"My brother works at a university.",explanation:'場所を表すときは前置詞 "at" を使います。',hint:"brother, works, university"},{id:17,japanese:"この本は私のものではありません。",correctAnswer:"This book is not mine.",explanation:'所有代名詞 "mine" を使い、否定形で表現します。',hint:"book, is not, mine"},{id:18,japanese:"彼らは週末によく映画を見ます。",correctAnswer:"They often watch movies on weekends.",explanation:'頻度を表す副詞 "often" は動詞の前に置きます。',hint:"often, watch movies, weekends"},{id:19,japanese:"私の母は料理がとても上手です。",correctAnswer:"My mother is very good at cooking.",explanation:'"be good at + 動名詞" で「～が上手」を表現します。',hint:"mother, very good at, cooking"},{id:20,japanese:"その犬は公園を走り回っています。",correctAnswer:"The dog runs around in the park.",explanation:"現在の習慣的行動は現在形で表現します。",hint:"dog, runs around, park"}],hard:[{id:21,japanese:"彼が成功する理由は、常に努力を怠らないことです。",correctAnswer:"The reason why he succeeds is that he never stops making efforts.",explanation:'"The reason why ~ is that..." で理由を強調する構文です。'},{id:22,japanese:"私たちの町には古い伝統を大切にする人々がたくさんいます。",correctAnswer:"There are many people in our town who cherish old traditions.",explanation:'"There are + 名詞 + 関係代名詞" の構文で存在と修飾を同時に表現します。'},{id:23,japanese:"彼女の笑顔は見る人すべてを幸せな気持ちにします。",correctAnswer:"Her smile makes everyone who sees it feel happy.",explanation:'"make + 人 + 動詞" で「人に～させる」を表現します。'},{id:24,japanese:"この店で働くスタッフは皆親切で、お客様に丁寧に対応します。",correctAnswer:"All the staff who work at this store are kind and treat customers politely.",explanation:"関係代名詞と副詞を使って複雑な文を構成しています。"},{id:25,japanese:"私が毎朝することは、新聞を読んで世界のニュースを知ることです。",correctAnswer:"What I do every morning is read the newspaper and learn about world news.",explanation:'"What I do is ~" という構文で行動の内容を強調します。'},{id:26,japanese:"彼の話し方には、聞く人の心を動かす何かがあります。",correctAnswer:"There is something in the way he speaks that moves listeners' hearts.",explanation:'"There is something ~ that..." で抽象的な存在を表現します。'},{id:27,japanese:"私たちが住んでいる地球は、宇宙の中でかけがえのない存在です。",correctAnswer:"The Earth we live on is an irreplaceable existence in the universe.",explanation:"関係代名詞の省略形と形容詞を使った表現です。"},{id:28,japanese:"彼女が持っている才能は、多くの人々に影響を与える力があります。",correctAnswer:"The talent she has has the power to influence many people.",explanation:'関係代名詞の省略と "have the power to" の構文を使います。'},{id:29,japanese:"この問題を解決する方法は、みんなで協力することしかありません。",correctAnswer:"The only way to solve this problem is for everyone to cooperate.",explanation:'"The only way to ~ is for 人 to..." という構文です。'},{id:30,japanese:"人生において大切なことは、常に学び続ける姿勢を持つことだと思います。",correctAnswer:"I think what is important in life is to always have an attitude of continuous learning.",explanation:'"What is important is to ~" という主語節の構文を使います。'}]},tenses:{easy:[{id:31,japanese:"私は昨日映画を見ました。",correctAnswer:"I watched a movie yesterday.",explanation:'過去のことは過去形を使います。"watch" の過去形は "watched" です。',choices:["I watched a movie yesterday.","I watch a movie yesterday.","I am watching a movie yesterday.","I have watched a movie yesterday."]},{id:32,japanese:"彼女は明日東京に行きます。",correctAnswer:"She will go to Tokyo tomorrow.",explanation:'未来のことは "will + 動詞の原形" で表現します。',choices:["She will go to Tokyo tomorrow.","She goes to Tokyo tomorrow.","She went to Tokyo tomorrow.","She is going to Tokyo tomorrow."]},{id:33,japanese:"私たちは今テレビを見ています。",correctAnswer:"We are watching TV now.",explanation:'現在進行形は "be動詞 + 動詞のing形" で表現します。',choices:["We are watching TV now.","We watch TV now.","We watched TV now.","We will watch TV now."]},{id:34,japanese:"彼は今朝早く起きました。",correctAnswer:"He got up early this morning.",explanation:'"get up" の過去形は "got up" です。',choices:["He got up early this morning.","He gets up early this morning.","He is getting up early this morning.","He will get up early this morning."]},{id:35,japanese:"私は来週友達に会う予定です。",correctAnswer:"I will meet my friend next week.",explanation:'未来の予定は "will" で表現できます。',choices:["I will meet my friend next week.","I meet my friend next week.","I met my friend next week.","I am meeting my friend next week."]},{id:36,japanese:"雨が降っています。",correctAnswer:"It is raining.",explanation:"現在の天候は現在進行形で表現します。",choices:["It is raining.","It rains.","It rained.","It will rain."]},{id:37,japanese:"私は毎日朝食を食べます。",correctAnswer:"I eat breakfast every day.",explanation:"習慣は現在形で表現します。",choices:["I eat breakfast every day.","I ate breakfast every day.","I am eating breakfast every day.","I will eat breakfast every day."]},{id:38,japanese:"彼らは昨日パーティーを楽しみました。",correctAnswer:"They enjoyed the party yesterday.",explanation:"過去の出来事は過去形を使います。",choices:["They enjoyed the party yesterday.","They enjoy the party yesterday.","They are enjoying the party yesterday.","They will enjoy the party yesterday."]},{id:39,japanese:"私は今宿題をしています。",correctAnswer:"I am doing my homework now.",explanation:"現在進行中のことは現在進行形を使います。",choices:["I am doing my homework now.","I do my homework now.","I did my homework now.","I will do my homework now."]},{id:40,japanese:"明日は日曜日です。",correctAnswer:"Tomorrow is Sunday.",explanation:"未来でも確定した事実は現在形を使います。",choices:["Tomorrow is Sunday.","Tomorrow will be Sunday.","Tomorrow was Sunday.","Tomorrow being Sunday."]}],normal:[{id:41,japanese:"私は3年間英語を勉強しています。",correctAnswer:"I have been studying English for three years.",explanation:'継続を表す現在完了進行形を使います。期間は "for" で表現します。',hint:"have been studying, English, three years"},{id:42,japanese:"彼は先週からずっと忙しくしています。",correctAnswer:"He has been busy since last week.",explanation:'開始点からの継続は "since" を使います。',hint:"has been busy, since, last week"},{id:43,japanese:"私たちがそこに着いたとき、雨が降り始めました。",correctAnswer:"When we arrived there, it started to rain.",explanation:"時を表す副詞節では過去形を使います。",hint:"when, arrived, started, rain"},{id:44,japanese:"彼女は今までに多くの国を訪れたことがあります。",correctAnswer:"She has visited many countries so far.",explanation:"経験を表す現在完了形を使います。",hint:"has visited, many countries, so far"},{id:45,japanese:"私は明日の今頃、飛行機の中にいるでしょう。",correctAnswer:"I will be on a plane at this time tomorrow.",explanation:"未来のある時点での状態は未来進行形を使います。",hint:"will be, plane, this time tomorrow"},{id:46,japanese:"彼は昨日の夜、ずっと勉強していました。",correctAnswer:"He was studying all night last night.",explanation:"過去のある時点での継続は過去進行形を使います。",hint:"was studying, all night, last night"},{id:47,japanese:"私たちは来月までにこのプロジェクトを完成させる予定です。",correctAnswer:"We will have finished this project by next month.",explanation:"未来のある時点での完了は未来完了形を使います。",hint:"will have finished, project, by next month"},{id:48,japanese:"彼女は5歳のときから ピアノを弾いています。",correctAnswer:"She has been playing the piano since she was five years old.",explanation:"過去のある時点からの継続は現在完了進行形を使います。",hint:"has been playing, piano, since, five years old"},{id:49,japanese:"私は昨日その本を読み終えました。",correctAnswer:"I finished reading the book yesterday.",explanation:"過去の完了した行為は過去形を使います。",hint:"finished reading, book, yesterday"},{id:50,japanese:"彼らは来年結婚する予定です。",correctAnswer:"They are going to get married next year.",explanation:'予定を表すときは "be going to" も使えます。',hint:"are going to, get married, next year"}],hard:[{id:51,japanese:"彼が到着するまでに、私たちはすべての準備を終えているでしょう。",correctAnswer:"By the time he arrives, we will have finished all the preparations.",explanation:'"By the time" は時を表す副詞節で、未来完了と組み合わせます。'},{id:52,japanese:"もし昨日雨が降らなかったら、私たちはピクニックに行ったでしょう。",correctAnswer:"If it had not rained yesterday, we would have gone on a picnic.",explanation:"仮定法過去完了で、過去の事実と反対の仮定を表現します。"},{id:53,japanese:"彼女は会議が始まる前に、すでに資料を準備していました。",correctAnswer:"She had already prepared the materials before the meeting started.",explanation:"過去完了形で、過去のある時点より前の完了を表現します。"},{id:54,japanese:"私が子供の頃は、毎年夏に祖父母の家を訪れていました。",correctAnswer:"When I was a child, I used to visit my grandparents' house every summer.",explanation:'"used to" で過去の習慣を表現します。'},{id:55,japanese:"来週の今頃、私たちは新しいオフィスで働いているでしょう。",correctAnswer:"This time next week, we will be working in our new office.",explanation:"未来進行形で、未来のある時点での進行中の動作を表現します。"},{id:56,japanese:"彼は長年の間、その問題について考え続けてきました。",correctAnswer:"He has been thinking about that problem for many years.",explanation:"現在完了進行形で、過去から現在まで続く動作を表現します。"},{id:57,japanese:"その時点で、私たちはすでに5時間も待っていたのです。",correctAnswer:"At that point, we had already been waiting for five hours.",explanation:"過去完了進行形で、過去のある時点までの継続を表現します。"},{id:58,japanese:"彼が説明を終える頃には、みんな理解しているでしょう。",correctAnswer:"By the time he finishes explaining, everyone will have understood.",explanation:"時の副詞節と未来完了の組み合わせです。"},{id:59,japanese:"もし私があの時もっと勉強していたら、今頃もっと良い仕事に就いていたでしょう。",correctAnswer:"If I had studied harder at that time, I would have a better job now.",explanation:"混合仮定法で、過去の仮定と現在の帰結を表現します。"},{id:60,japanese:"彼女は卒業するまでに、すでに3年間そのプロジェクトに取り組んでいるでしょう。",correctAnswer:"By the time she graduates, she will have been working on that project for three years.",explanation:"未来完了進行形で、未来のある時点までの継続期間を表現します。"}]},modals:{easy:[{id:61,japanese:"私は泳ぐことができます。",correctAnswer:"I can swim.",explanation:'能力を表すときは "can" を使います。',choices:["I can swim.","I can to swim.","I can swimming.","I am can swim."]}],normal:[{id:71,japanese:"私は明日までにレポートを提出しなければなりません。",correctAnswer:"I have to submit my report by tomorrow.",explanation:'外部からの義務は "have to" を使うことが多いです。',hint:"have to submit, report, by tomorrow"}],hard:[{id:81,japanese:"彼は約束を守ったはずなのに、来ませんでした。",correctAnswer:"He should have kept his promise, but he didn't come.",explanation:'"should have + 過去分詞" で過去にすべきだったことを表現します。'}]},passive:{easy:[{id:91,japanese:"この本は多くの人に読まれています。",correctAnswer:"This book is read by many people.",explanation:'受動態は "be動詞 + 過去分詞" で作ります。',choices:["This book is read by many people.","This book reads by many people.","This book is reading by many people.","This book was read by many people."]}],normal:[{id:101,japanese:"この建物は1950年に建てられました。",correctAnswer:"This building was built in 1950.",explanation:'過去の受動態で年を表すときは "in" を使います。',hint:"building, was built, 1950"}],hard:[{id:111,japanese:"その決定が下される前に、すべての選択肢が検討されていました。",correctAnswer:"All options had been considered before the decision was made.",explanation:"過去完了の受動態で、時系列を明確にします。"}]},relative:{easy:[{id:121,japanese:"私には英語を話す友達がいます。",correctAnswer:"I have a friend who speaks English.",explanation:'人を修飾するときは関係代名詞 "who" を使います。',choices:["I have a friend who speaks English.","I have a friend which speaks English.","I have a friend that speak English.","I have a friend who speak English."]}],normal:[{id:131,japanese:"私が昨日会った人は有名な作家でした。",correctAnswer:"The person whom I met yesterday was a famous writer.",explanation:'目的格の関係代名詞は "whom" を使います（"who" でも可）。',hint:"person, whom, met yesterday, famous writer"}],hard:[{id:141,japanese:"彼が言ったことは、私たちが予想していたことと全く異なっていました。",correctAnswer:"What he said was completely different from what we had expected.",explanation:'関係代名詞 "what" は「～すること」を表し、先行詞を含みます。'}]},subjunctive:{easy:[{id:151,japanese:"もし明日雨が降ったら、家にいます。",correctAnswer:"If it rains tomorrow, I will stay at home.",explanation:"現在の仮定では、if節は現在形、主節は未来形を使います。",choices:["If it rains tomorrow, I will stay at home.","If it will rain tomorrow, I stay at home.","If it rained tomorrow, I will stay at home.","If it rains tomorrow, I stayed at home."]}],normal:[{id:161,japanese:"もし昨日雨が降らなかったら、ピクニックに行ったでしょう。",correctAnswer:"If it had not rained yesterday, we would have gone on a picnic.",explanation:'仮定法過去完了では、if節は過去完了、主節は "would have + 過去分詞" を使います。',hint:"had not rained, would have gone, picnic"}],hard:[{id:171,japanese:"もし彼があの時違う決断をしていたら、今頃は全く違う人生を送っていたでしょう。",correctAnswer:"If he had made a different decision at that time, he would be living a completely different life now.",explanation:"混合仮定法：過去の仮定の条件と現在の仮定の結果を組み合わせます。"}]},comparison:{easy:[{id:181,japanese:"彼は私より背が高いです。",correctAnswer:"He is taller than me.",explanation:'比較級は "形容詞 + er + than" で表現します。',choices:["He is taller than me.","He is more tall than me.","He is tall than me.","He is taller then me."]}],normal:[{id:191,japanese:"この課題は私が思っていたよりもずっと難しいです。",correctAnswer:"This assignment is much more difficult than I thought.",explanation:'比較級を強調するときは "much" を使います。',hint:"much more difficult, than I thought"}],hard:[{id:201,japanese:"彼の成功は、才能よりもむしろ努力の結果です。",correctAnswer:"His success is more a result of effort than of talent.",explanation:'"more A than B" で「BというよりむしろA」を表現します。'}]},participle:{easy:[{id:211,japanese:"私は走っている男の子を見ました。",correctAnswer:"I saw a boy running.",explanation:"現在分詞 (-ing) で進行中の動作を修飾します。",choices:["I saw a boy running.","I saw a boy run.","I saw a boy ran.","I saw a boy to run."]}],normal:[{id:221,japanese:"駅に向かって走りながら、彼は時計を見ました。",correctAnswer:"Running towards the station, he looked at his watch.",explanation:"分詞構文で同時動作を表現します。",hint:"Running towards, station, looked at watch"}],hard:[{id:231,japanese:"長年の経験を積んだ結果、彼は専門家として認められるようになりました。",correctAnswer:"Having accumulated years of experience, he came to be recognized as an expert.",explanation:"完了分詞構文と受動態の組み合わせです。"}]},infinitive:{easy:[{id:241,japanese:"私は英語を勉強したいです。",correctAnswer:"I want to study English.",explanation:'"want" の後は不定詞 "to + 動詞の原形" を使います。',choices:["I want to study English.","I want study English.","I want studying English.","I want studied English."]}],normal:[{id:251,japanese:"私は彼に英語を教えてもらいました。",correctAnswer:"I had him teach me English.",explanation:'使役動詞 "have" の後は原形不定詞（to なし）を使います。',hint:"had him teach, English"}],hard:[{id:261,japanese:"彼は問題を解決したと言われています。",correctAnswer:"He is said to have solved the problem.",explanation:'"be said to have + 過去分詞" で完了の不定詞を使った伝聞表現です。'}]}};function rt(t,s){if(console.log("=== getQuestions called ==="),console.log("category:",t),console.log("difficulty:",s),console.log("questionsByCategory keys:",Object.keys(Ae)),console.log("category exists in data:",t in Ae),!(t in Ae))return console.error("Category not found:",t),[];const n=Ae[t];if(console.log("difficulty exists in category:",s in n),!(s in n))return console.error("Difficulty not found for category:",t,s),[];const a=n[s];return console.log("Found questions:",a.length),a||[]}r.lazy(()=>G(()=>import("./learning-B7AfTcwU.js").then(t=>t.V),__vite__mapDeps([0,1,2,3,4])).then(t=>({default:t.VocabularyCard})));const sa=r.lazy(()=>G(()=>import("./EnhancedVocabularyCard-DMnqduZr.js"),__vite__mapDeps([5,1,2,3,0,4])).then(t=>({default:t.EnhancedVocabularyCard}))),na=r.lazy(()=>G(()=>import("./VocabularyDifficultySelection-CAzPTxYU.js"),__vite__mapDeps([6,1,2,3,0,4])).then(t=>({default:t.VocabularyDifficultySelection}))),aa=r.lazy(()=>G(()=>import("./VocabularyCategorySelection-2mNBh-EI.js"),__vite__mapDeps([7,1,2,3,0,4])).then(t=>({default:t.VocabularyCategorySelection})));r.lazy(()=>G(()=>import("./learning-B7AfTcwU.js").then(t=>t.Q),__vite__mapDeps([0,1,2,3,4])).then(t=>({default:t.GrammarQuiz})));const ra=r.lazy(()=>G(()=>Promise.resolve().then(()=>Jn),void 0).then(t=>({default:t.EnhancedGrammarQuiz}))),oa=r.lazy(()=>G(()=>Promise.resolve().then(()=>Bn),void 0).then(t=>({default:t.GrammarQuizDifficultySelection}))),ia=r.lazy(()=>G(()=>import("./learning-B7AfTcwU.js").then(t=>t.U),__vite__mapDeps([0,1,2,3,4])).then(t=>({default:t.CombinedTest}))),la=r.lazy(()=>G(()=>import("./progress-Dp2NNpON.js").then(t=>t.A),__vite__mapDeps([4,1,2,3,0])).then(t=>({default:t.Achievements}))),ca=r.lazy(()=>G(()=>import("./CategorySelection-cImHteyh.js"),__vite__mapDeps([8,1,2,3,0,4])).then(t=>({default:t.CategorySelection}))),da=r.lazy(()=>G(()=>import("./DifficultySelection-DMNC2fAT.js"),__vite__mapDeps([9,1,2,3,0,4])).then(t=>({default:t.DifficultySelection}))),ma=r.lazy(()=>G(()=>import("./Question-SB5ERoex.js"),__vite__mapDeps([10,1,2,3,0,4])).then(t=>({default:t.Question}))),ha=r.lazy(()=>G(()=>import("./Results-CKPwCidN.js"),__vite__mapDeps([11,1,2,3,4,0])).then(t=>({default:t.Results}))),ua=r.lazy(()=>G(()=>import("./AppSettings-CHHphcot.js"),__vite__mapDeps([12,1,2,3,0,4,13])).then(t=>({default:t.AppSettings}))),pa=r.lazy(()=>G(()=>import("./TimeAttackMode-SBTTDqDa.js"),__vite__mapDeps([14,1,2,3,0,4])).then(t=>({default:t.TimeAttackMode}))),xa=r.lazy(()=>G(()=>import("./game-DQXwOTYN.js").then(t=>t.S),__vite__mapDeps([3,1,2])).then(t=>({default:t.SimpleTowerDefense})));function ot(t){const s=[...t];for(let n=s.length-1;n>0;n--){const a=Math.floor(Math.random()*(n+1));[s[n],s[a]]=[s[a],s[n]]}return s}function ga(t,s,n){const a=o=>o.toLowerCase().replace(/[^\w\s]/g,"").trim();if(n==="easy")return a(t)===a(s);{const o=a(t),l=a(s).split(/\s+/),c=o.split(/\s+/);return l.filter(m=>m.length>2&&c.some(u=>u.includes(m)||m.includes(u))).length>=Math.ceil(l.length*.7)}}function fa(){const[t,s]=r.useState("home"),[n,a]=r.useState("basic-grammar"),[o,i]=r.useState("easy"),[l,c]=r.useState("intermediate"),[d,m]=r.useState("all"),[u,f]=r.useState("intermediate"),[x,j]=r.useState([]),[N,p]=r.useState(0),[h,b]=r.useState([]),[v,_]=r.useState(0),F=()=>{s("category")},D=()=>{s("vocabulary-difficulty")},Q=w=>{c(w),s("vocabulary-category")},P=w=>{m(w),s("vocabulary")},L=()=>{s("grammar-quiz-difficulty")},ee=w=>{f(w),s("grammar-quiz")},$=()=>{s("category")},U=()=>{s("combined-test")},X=()=>{s("achievements")},K=()=>{s("app-settings")},I=()=>{s("time-attack")},Y=()=>{s("simple-tower-defense")},E=()=>{s("home")},z=w=>{console.log("Category selected:",w),a(w),s("difficulty")},J=w=>{console.log("=== Debug handleSelectDifficulty ==="),console.log("Difficulty selected:",w),console.log("Selected category:",n);try{i(w);const A=rt(n,w);if(console.log("Retrieved questions:",A.length),console.log("Questions data:",A),A.length===0){console.error("No questions found for category:",n,"difficulty:",w);return}console.log("About to shuffle questions...");const y=Ne.getAppSettings().essayQuestionCount,k=ot(A).slice(0,y);console.log("Shuffled questions:",k.length),console.log("Setting questions state..."),j(k),p(0),b([]),_(Date.now()),console.log("Setting screen to question"),s("question"),console.log("handleSelectDifficulty completed successfully")}catch(A){console.error("Error in handleSelectDifficulty:",A)}},te=w=>{const A=x[N],R=ga(w,A.correctAnswer,o),y={questionId:A.id,answer:w,isCorrect:R},k=[...h,y];if(b(k),N+1<x.length)p(N+1);else{const M=Math.round((Date.now()-v)/1e3),S=k.filter(oe=>oe.isCorrect).length,T=Math.round(S/x.length*100),H=vs(k,o,n,M);Ne.recordLearningSession({date:new Date().toISOString().split("T")[0],type:"grammar-quiz",category:n,difficulty:o,score:T,totalQuestions:x.length,correctAnswers:S,xpEarned:H,duration:M}),Ne.checkAndUpdateAchievements(),s("results")}},de=()=>{const w=rt(n,o),R=Ne.getAppSettings().essayQuestionCount,y=ot(w).slice(0,R);j(y),p(0),b([]),_(Date.now()),s("question")},re=()=>{s("difficulty")},ae=()=>{s("category")};t==="question"&&(console.log("=== Question Screen State ==="),console.log("currentScreen:",t),console.log("questions.length:",x.length),console.log("selectedCategory:",n),console.log("difficulty:",o));const g=()=>e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl mb-2",children:"読み込み中..."}),e.jsx("p",{className:"text-muted-foreground",children:"コンポーネントを読み込んでいます"})]})});return e.jsxs("div",{className:"min-h-screen bg-background",children:[t==="home"&&e.jsx(Zn,{onNavigateToGrammar:F,onNavigateToVocabulary:D,onNavigateToGrammarQuiz:L,onNavigateToEssay:$,onNavigateToCombinedTest:U,onNavigateToAchievements:X,onNavigateToAppSettings:K,onNavigateToTimeAttack:I,onNavigateToSimpleTowerDefense:Y}),t==="vocabulary-difficulty"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(na,{onBack:E,onSelectDifficulty:Q})}),t==="vocabulary-category"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(aa,{onBack:()=>s("vocabulary-difficulty"),onSelectCategory:P})}),t==="vocabulary"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(sa,{onBack:()=>s("vocabulary-category"),difficulty:l,category:d})}),t==="grammar-quiz-difficulty"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(oa,{onBack:E,onSelectDifficulty:ee})}),t==="grammar-quiz"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ra,{onBack:()=>s("grammar-quiz-difficulty"),difficulty:u})}),t==="combined-test"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ia,{onBack:E})}),t==="achievements"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(la,{onBack:E})}),t==="app-settings"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ua,{onBack:E})}),t==="time-attack"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(pa,{onBack:E})}),t==="simple-tower-defense"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(xa,{onBack:E})}),t==="category"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ca,{onSelectCategory:z,onBack:E})}),t==="difficulty"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(da,{category:n,onSelectDifficulty:J,onBack:ae})}),t==="question"&&x.length>0&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ma,{question:x[N],questionNumber:N+1,totalQuestions:x.length,difficulty:o,category:n,onAnswer:te,onBack:re})}),t==="question"&&x.length===0&&e.jsx("div",{className:"min-h-screen p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl mb-2",children:"問題の読み込み中..."}),e.jsxs("p",{className:"text-muted-foreground",children:["カテゴリー: ",n,e.jsx("br",{}),"難易度: ",o]})]})}),t==="results"&&e.jsx(r.Suspense,{fallback:e.jsx(g,{}),children:e.jsx(ha,{questions:x,userAnswers:h,difficulty:o,category:n,sessionDuration:Math.round((Date.now()-v)/1e3),onRestart:de,onChangeDifficulty:re,onChangeCategory:ae,onBack:E})}),e.jsx(ea,{}),e.jsx(ta,{})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered: ",t)}).catch(t=>{console.log("SW registration failed: ",t)})});$s.createRoot(document.getElementById("root")).render(e.jsx(fa,{}));export{je as L,Mn as Q,qe as S,st as T,Te as a,ze as b,ka as c,Ce as d,se as e,Qn as f,rt as g,$n as s,Js as u};
