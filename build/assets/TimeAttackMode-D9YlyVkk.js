import{r as l,j as e}from"./ui-smpf69Zd.js";import{g as H}from"./questions-zY9y3rZJ.js";import{G as B,A as M,l as U,F as W,Z,a as O,g as X,s as J,E as K}from"./learning-B-E1ZIuS.js";import{u as Y,b as _,B as o,C as f,d as p,P as ee,f as se,h as te}from"./game-Dd6Kb0LE.js";import{D as ae}from"./progress-BPWR83xl.js";import"./vendor-D3F3s8fL.js";function de(){const h=Y();_();const[g,P]=l.useState([]),[c,A]=l.useState(0),[m,N]=l.useState(0),[x,L]=l.useState(0),[b,w]=l.useState(0),[k,$]=l.useState(0),[u,Q]=l.useState(!1),[v,E]=l.useState(!1),[R,T]=l.useState(""),[y,C]=l.useState(!1),[S,V]=l.useState(!1),[ne,q]=l.useState({gachaVocabCount:0,grammarCategoriesStudied:0});l.useEffect(()=>{try{const s=B.getUserGachaData();q({gachaVocabCount:s.ownedCards.length,grammarCategoriesStudied:3})}catch(s){console.log("ç›¸ä¹—åŠ¹æœãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—:",s)}},[]);const z=()=>{const s=[];try{const a=B.getUserGachaData(),r=a.ownedCards.slice(0,6);r.length>0&&r.forEach((t,G)=>{const j=a.ownedCards.filter(i=>i.id!==t.id).slice(0,3);j.length>=3&&s.push({id:`gacha-${t.id}`,type:"vocabulary",question:`ã€Œ${t.meaning}ã€ã‚’è‹±èªã§è¨€ã†ã¨ï¼Ÿ`,options:[t.word,...j.map(i=>i.word)].sort(()=>Math.random()-.5),correctAnswer:t.word,explanation:`ã‚¬ãƒãƒ£èªå½™: ${t.word} - ${t.meaning}`,timeLimit:8})})}catch(a){console.log("ã‚¬ãƒãƒ£èªå½™ã®å–å¾—ã«å¤±æ•—:",a)}if(["basic-grammar","tenses","modals"].forEach(a=>{s.length<10&&H(a,"easy").slice(0,2).forEach(t=>{s.push({id:`grammar-${a}-${t.id}`,type:"grammar",question:t.japanese,options:t.choices,correctAnswer:t.correctAnswer,explanation:`æ–‡æ³•å¾©ç¿’: ${t.explanation}`,timeLimit:12})})}),s.length<10){const a=K("beginner","all").slice(0,10-s.length);a.forEach((r,t)=>{s.push({id:`vocab-${1e3+t}`,type:"vocabulary",question:`ã€Œ${r.japanese}ã€ã‚’è‹±èªã§è¨€ã†ã¨ï¼Ÿ`,options:[r.word,a[(t+1)%a.length].word,a[(t+2)%a.length].word,a[(t+3)%a.length].word].sort(()=>Math.random()-.5),correctAnswer:r.word,explanation:r.meaning,timeLimit:10})})}return s.sort(()=>Math.random()-.5).slice(0,10)},D=()=>{if(!X().consumeHeart()){alert("ä½“åŠ›ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚å›å¾©ã‚’å¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚"),h("/");return}const n=z();P(n),A(0),L(0),w(0),$(0),Q(!0),E(!1),C(!1),n.length>0&&N(n[0].timeLimit),J()};l.useEffect(()=>{if(!u||v)return;const s=setInterval(()=>{N(n=>n<=1?(I(""),0):n-1)},1e3);return()=>clearInterval(s)},[u,v]);const I=s=>{if(!u||y)return;const n=g[c],a=s===n.correctAnswer;if(V(a),C(!0),a){const r=b+1;w(r),$(i=>Math.max(i,r));const t=100,G=Math.min(r*10,100),j=Math.max(m*2,0);L(i=>i+t+G+j)}else w(0);setTimeout(()=>{c+1>=g.length?(E(!0),Q(!1),F()):(A(r=>r+1),N(g[c+1].timeLimit),C(!1),T(""))},2e3)},F=()=>{const s=Math.floor(x/10),n={date:new Date().toISOString().split("T")[0],type:"time-attack",score:x,maxCombo:k,questionsAnswered:c+1,xpEarned:s,duration:0};ae.recordLearningSession(n)},d=g[c];return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{variant:"ghost",onClick:()=>h("/"),className:"p-2",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯çµæœ"}),e.jsx("div",{className:"w-10"})]}),e.jsx(f,{className:"text-center border-0 shadow-lg bg-gradient-to-br from-yellow-50 to-orange-50",children:e.jsxs(p,{className:"p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ğŸ†"}),e.jsx("h2",{className:"text-3xl font-bold text-orange-800 mb-2",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯å®Œäº†ï¼"}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"ã‚¹ã‚³ã‚¢"}),e.jsx("span",{className:"text-2xl font-bold text-orange-600",children:x.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"æœ€å¤§ã‚³ãƒ³ãƒœ"}),e.jsx("span",{className:"text-2xl font-bold text-red-600",children:k})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"æ­£è§£æ•°"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:c+1})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"ç²å¾—XP"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:Math.floor(x/10)})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(o,{onClick:D,className:"w-full",size:"lg",children:"ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦"}),e.jsx(o,{onClick:()=>h("/"),variant:"outline",className:"w-full",children:"ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹"})]})]})})]})}):u?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{variant:"ghost",onClick:onBack,className:"p-2",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯"}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ã‚¹ã‚³ã‚¢"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:x.toLocaleString()})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ã‚³ãƒ³ãƒœ"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:b})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"å•é¡Œ"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[c+1,"/10"]})]})]}),e.jsx(f,{className:"border-0 shadow-lg",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"æ®‹ã‚Šæ™‚é–“"}),e.jsx("span",{className:`text-2xl font-bold ${m<=5?"text-red-600":"text-blue-600"}`,children:m})]}),e.jsx(ee,{value:m/d.timeLimit*100,className:`h-2 ${m<=5?"bg-red-200":"bg-blue-200"}`})]})}),d&&e.jsxs(f,{className:"border-0 shadow-lg",children:[e.jsx(se,{children:e.jsx(te,{className:"text-center",children:d.type==="grammar"?"æ–‡æ³•å•é¡Œ":"å˜èªå•é¡Œ"})}),e.jsxs(p,{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted rounded-lg text-center",children:e.jsx("p",{className:"text-lg",children:d.question})}),y&&e.jsxs("div",{className:`p-4 rounded-lg text-center ${S?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsx("p",{className:"font-bold text-lg",children:S?"æ­£è§£ï¼":"ä¸æ­£è§£"}),S&&e.jsxs("p",{className:"text-sm mt-1",children:["+",100+Math.min(b*10,100)+Math.max(m*2,0)," ","ãƒã‚¤ãƒ³ãƒˆ"]})]}),!y&&d.options&&e.jsx("div",{className:"space-y-2",children:d.options.map((s,n)=>e.jsxs(o,{variant:R===s?"default":"outline",className:"w-full justify-start h-auto p-3 text-left",onClick:()=>{T(s),I(s)},children:[String.fromCharCode(65+n),". ",s]},n))})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{variant:"ghost",onClick:()=>h("/"),className:"p-2",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯"}),e.jsx("div",{className:"w-10"})]}),e.jsx(f,{className:"text-center border-0 shadow-lg bg-gradient-to-br from-red-50 to-orange-50",children:e.jsxs(p,{className:"p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš¡"}),e.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"ã‚¿ã‚¤ãƒ ã‚¢ã‚¿ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰"}),e.jsx("p",{className:"text-gray-700 mb-6",children:"åˆ¶é™æ™‚é–“å†…ã«é€£ç¶šã§æ­£è§£ã‚’é‡ã­ã¦é«˜ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ãã†ï¼"}),e.jsxs("div",{className:"space-y-3 text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{children:"å„å•é¡Œã«åˆ¶é™æ™‚é–“ã‚ã‚Š"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{children:"é€£ç¶šæ­£è§£ã§ã‚³ãƒ³ãƒœãƒœãƒ¼ãƒŠã‚¹"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{children:"æ®‹ã‚Šæ™‚é–“ã§ã‚¿ã‚¤ãƒ ãƒœãƒ¼ãƒŠã‚¹"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{children:"10å•é€£ç¶šã§æŒ‘æˆ¦"})]})]}),e.jsx(o,{onClick:D,className:"w-full mt-8",size:"lg",children:"ã‚¹ã‚¿ãƒ¼ãƒˆï¼"})]})})]})})}export{de as default};
