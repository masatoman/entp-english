import{r as l,j as e,c as ce,d as Ht,e as $t,u as ye,f as Us,A as Xs,g as oe,h as Ie,i as Qs,k as qt,l as jt,m as Ks,n as Ys,o as Js,p as Zs,q as ea,F as ta,D as sa,s as aa,t as na,v as mt,w as ra,x as ia,y as la}from"./ui-smpf69Zd.js";import{a as oa}from"./vendor-D3F3s8fL.js";import{g as V,s as de,A as Q,B as Ge,S as se,Z as He,C as zt,a as je,c as J,b as Ft,d as ca,e as da,f as Ne,v as ma,h as ht,i as Be,j as ha,I as wt,R as Ye,k as ot,l as Bt,m as Ue,n as et,o as $e,F as Wt,H as xt,p as Ve,D as Ct,q as xa,r as It,t as ua,u as Tt,w as Vt,x as ga,V as pa,y as Gt,z as fa,E as ya,G as va,J as ba,L as ja,M as wa,N as Na,O as Sa,P as he,Q as _t,U as ka,W as qe,X as ut,Y as Ut,_ as Ca,$ as Ia,a0 as Ta,a1 as _a,a2 as Aa,a3 as Pa,a4 as Ea,a5 as ct,a6 as Ra,a7 as At,a8 as Da,K as La,a9 as Ma,aa as Oa}from"./learning-BjVicPLK.js";import{D as xe,a as Ha,A as $a}from"./progress-JS8CxZEX.js";import{B as w,C as N,e as R,h as W,f as I,u as ae,d as D,i as Xt,a as Nt,P as be,j as Je,k as qa,b as ue,g as ze,l as Qt,m as za,R as Fa,n as ee,S as Ba,N as Wa}from"./game-BIfLvwvR.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var Qe={},Pt;function Va(){if(Pt)return Qe;Pt=1;var a=oa();return Qe.createRoot=a.createRoot,Qe.hydrateRoot=a.hydrateRoot,Qe}var Ga=Va();const Kt=[{id:"basic-grammar-theory",title:"英文の基本構造",category:"grammar",subcategory:"basic-grammar",level:1,contentType:"theory",duration:300,difficulty:"beginner",content:`# 英文の基本構造

## 英語の語順：SVO
英語は**主語（S）→ 動詞（V）→ 目的語（O）**の順番が基本です。

### be動詞の文
- **肯定文**: I am a student. (私は学生です)
- **否定文**: I am not a teacher. (私は先生ではありません)
- **疑問文**: Are you happy? (あなたは幸せですか？)

### 一般動詞の文
- **肯定文**: I play tennis. (私はテニスをします)
- **否定文**: I don't play soccer. (私はサッカーをしません)
- **疑問文**: Do you like music? (あなたは音楽が好きですか？)

## なぜ大切？
この基本構造を理解することで：
- ✅ 文法クイズの基本文型問題が解けるようになります
- ✅ 英作文で正しい語順で書けるようになります
- ✅ TOEICのPart5-6での語順問題に強くなります`,keyPoints:["英語の基本語順はSVO","be動詞と一般動詞の使い分け","疑問文・否定文の作り方","文法クイズ・英作文の基礎"],examples:[{english:"She is a teacher.",japanese:"彼女は先生です。",explanation:"be動詞の基本形（主語 + be動詞 + 補語）"},{english:"They study English every day.",japanese:"彼らは毎日英語を勉強します。",explanation:"一般動詞の基本形（主語 + 動詞 + 目的語）"}],relatedProblems:["basic-grammar"],prerequisites:[]},{id:"tenses-theory",title:"時制の概念と使い分け",category:"grammar",subcategory:"tenses",level:2,contentType:"theory",duration:420,difficulty:"beginner",content:`# 時制の概念と使い分け

## 時制とは？
**時制**は「いつの話をしているか」を表現する文法です。

### 現在形
- **基本用法**: 習慣・事実・状態
- **例**: I go to school every day. (毎日学校に行きます)
- **TOEIC頻出**: スケジュール・習慣の話

### 過去形
- **基本用法**: 過去の事実・完了した行動
- **例**: I went to Tokyo yesterday. (昨日東京に行きました)
- **TOEIC頻出**: 会議・イベントの報告

### 未来形
- **will**: 意志・予測
- **be going to**: 計画・予定
- **例**: I will call you tomorrow. (明日電話します)

### 現在完了形
- **基本用法**: 過去から現在への継続・経験・完了
- **例**: I have lived here for 5 years. (5年間ここに住んでいます)
- **TOEIC頻出**: 経験・継続の表現

## 実践への活用
- ✅ 文法クイズの時制問題で正答率アップ
- ✅ 英作文で適切な時制選択
- ✅ TOEICのPart5-6で時制問題に強くなる`,keyPoints:["現在形は習慣・事実を表す","過去形は完了した行動","未来形はwillとbe going toの使い分け","現在完了形は過去と現在の関係"],examples:[{english:"I have been studying English for 3 years.",japanese:"3年間英語を勉強しています。",explanation:"現在完了進行形：過去から現在まで継続している行動"},{english:"The meeting will start at 9 AM.",japanese:"会議は午前9時に始まります。",explanation:"未来形：確定した予定を表すwill"}],relatedProblems:["tenses"],prerequisites:["basic-grammar-theory"]},{id:"modals-theory",title:"助動詞の意味と使い方",category:"grammar",subcategory:"modals",level:3,contentType:"theory",duration:360,difficulty:"intermediate",content:`# 助動詞の意味と使い方

## 助動詞とは？
動詞に**意味を付け加える**単語です。

### 能力・可能性
- **can**: できる、可能性がある
- **could**: できた、可能性があった（過去・丁寧）
- **例**: I can speak English. (英語を話せます)

### 意志・予測
- **will**: ～するつもり、～でしょう
- **would**: ～するつもりだった（過去・丁寧）
- **例**: It will rain tomorrow. (明日雨が降るでしょう)

### 義務・必要性
- **must**: ～しなければならない（強い義務）
- **should**: ～すべき（アドバイス）
- **have to**: ～しなければならない（外的義務）
- **例**: You must submit the report. (レポートを提出しなければなりません)

### 許可・依頼
- **may**: ～してもよい（許可）、～かもしれない（推量）
- **might**: ～かもしれない（弱い推量）
- **例**: May I use your phone? (電話をお借りしてもよいですか？)

## ビジネス英語での重要性
TOEICでは**丁寧な表現**が頻出：
- Could you help me? (手伝っていただけますか？)
- Would you like some coffee? (コーヒーはいかがですか？)

## 実践への活用
- ✅ 文法クイズの助動詞問題で満点
- ✅ 英作文で適切な丁寧さレベル
- ✅ TOEICのビジネス場面で高得点`,keyPoints:["can/could: 能力・可能性","will/would: 意志・予測","must/should: 義務・アドバイス","may/might: 許可・推量"],examples:[{english:"Could you please send me the document?",japanese:"書類を送っていただけませんか？",explanation:"ビジネスでの丁寧な依頼表現"},{english:"You should check your email regularly.",japanese:"定期的にメールをチェックすべきです。",explanation:"アドバイスを表すshould"}],relatedProblems:["modals"],prerequisites:["basic-grammar-theory","tenses-theory"]},{id:"passive-theory",title:"受動態の理解と活用",category:"grammar",subcategory:"passive",level:4,contentType:"theory",duration:480,difficulty:"intermediate",content:`# 受動態の理解と活用

## 受動態とは？
**動作を受ける側**に焦点を当てた表現です。

### 基本形：be動詞 + 過去分詞
- **能動態**: Tom wrote this letter. (トムがこの手紙を書いた)
- **受動態**: This letter was written by Tom. (この手紙はトムによって書かれた)

### 時制別の受動態
#### 現在形
- **形**: am/is/are + 過去分詞
- **例**: English is spoken all over the world. (英語は世界中で話されています)

#### 過去形
- **形**: was/were + 過去分詞
- **例**: The meeting was canceled. (会議は中止されました)

#### 未来形
- **形**: will be + 過去分詞
- **例**: The report will be finished tomorrow. (レポートは明日完成します)

#### 現在完了形
- **形**: have/has been + 過去分詞
- **例**: The project has been completed. (プロジェクトは完了しました)

## ビジネス英語での重要性
### フォーマルな表現
- **能動**: We will send the documents.
- **受動**: The documents will be sent. (より丁寧・客観的)

### TOEIC頻出パターン
- The conference is held annually. (会議は毎年開催されます)
- All applications must be submitted by Friday. (全ての申請書は金曜日までに提出されなければなりません)

## 実践への活用
- ✅ 文法クイズの受動態問題で満点
- ✅ 英作文でフォーマルな表現
- ✅ TOEICのビジネス文書読解で高得点`,keyPoints:["be動詞 + 過去分詞の基本形","時制に応じたbe動詞の変化","by + 行為者は省略可能","ビジネスではフォーマルな印象"],examples:[{english:"The new policy will be implemented next month.",japanese:"新しい方針は来月実施されます。",explanation:"ビジネスでの未来受動態"},{english:"All employees are required to attend the training.",japanese:"全従業員は研修への参加が義務付けられています。",explanation:"義務を表す受動態"}],relatedProblems:["passive"],prerequisites:["basic-grammar-theory","tenses-theory"]},{id:"relative-theory",title:"関係詞で文を豊かに",category:"grammar",subcategory:"relative",level:5,contentType:"theory",duration:540,difficulty:"intermediate",content:`# 関係詞で文を豊かに

## 関係詞とは？
**2つの文を1つにつなげる**接続詞です。

### 関係代名詞
#### who（人）
- **例**: The man who is standing there is my teacher.
- **意味**: そこに立っている男性は私の先生です。

#### which（物・動物）
- **例**: The book which I bought yesterday is interesting.
- **意味**: 昨日買った本は面白いです。

#### that（人・物）
- **例**: The car that he drives is expensive.
- **意味**: 彼が運転する車は高価です。

### 関係副詞
#### where（場所）
- **例**: This is the place where I was born.
- **意味**: ここが私が生まれた場所です。

#### when（時）
- **例**: I remember the day when we first met.
- **意味**: 初めて会った日を覚えています。

## ビジネス英語での活用
### 効率的な情報伝達
- The client who called yesterday wants to reschedule. (昨日電話をかけた顧客は予定変更を希望しています)
- The project that we discussed is now approved. (私たちが話し合ったプロジェクトが承認されました)

### TOEIC頻出パターン
- The person who is responsible for... (責任者は...)
- The company which provides... (提供する会社は...)

## 実践への活用
- ✅ 文法クイズの関係詞問題で満点
- ✅ 英作文で複雑な文構造
- ✅ TOEICの長文読解で理解力向上`,keyPoints:["who: 人を修飾","which: 物・動物を修飾","that: 人・物両方OK","関係副詞で場所・時間を表現"],examples:[{english:"The employee who works in accounting is very helpful.",japanese:"経理部で働く従業員はとても親切です。",explanation:"人を修飾するwho"},{english:"The software which we use is very efficient.",japanese:"私たちが使用するソフトウェアはとても効率的です。",explanation:"物を修飾するwhich"}],relatedProblems:["relative"],prerequisites:["basic-grammar-theory","tenses-theory"]},{id:"subjunctive-theory",title:"仮定法で表現力アップ",category:"grammar",subcategory:"subjunctive",level:6,contentType:"theory",duration:600,difficulty:"advanced",content:`# 仮定法で表現力アップ

## 仮定法とは？
**実際とは異なる仮定**を表現する文法です。

### 仮定法過去（現在の仮定）
#### 形：If + 主語 + 動詞の過去形, 主語 + would + 動詞原形
- **例**: If I were you, I would accept the offer.
- **意味**: もし私があなたなら、その申し出を受け入れるでしょう。
- **ポイント**: be動詞は人称に関係なく「were」

### 仮定法過去完了（過去の仮定）
#### 形：If + 主語 + had + 過去分詞, 主語 + would have + 過去分詞
- **例**: If I had studied harder, I would have passed the exam.
- **意味**: もっと勉強していたら、試験に合格していたでしょう。

### ビジネスでの仮定法
#### 丁寧な提案・依頼
- **Would you mind if...?**: ～していただけませんか？
- **I would appreciate if...**: ～していただければ幸いです
- **例**: I would appreciate if you could review this document.

#### 条件付きの話
- **If we had more budget, we could hire more staff.**
- **意味**: もっと予算があれば、より多くのスタッフを雇えるのですが。

## TOEIC攻略ポイント
### Part5-6での判別
- 仮定法のキーワード：if, wish, as if
- 時制の一致に注意
- wouldとwillの使い分け

### Part7での理解
- 提案書・企画書での仮定法表現
- 条件付きの契約条項

## 実践への活用
- ✅ 文法クイズの仮定法問題で満点
- ✅ 英作文で高度な表現力
- ✅ TOEICの上級問題で高得点`,keyPoints:["仮定法過去：現在の非現実的仮定","仮定法過去完了：過去の非現実的仮定","ビジネスでの丁寧な表現","TOEICでの頻出パターン"],examples:[{english:"If I were the manager, I would change the policy.",japanese:"もし私がマネージャーなら、方針を変更するでしょう。",explanation:"仮定法過去：現在の非現実的な仮定"},{english:"I wish I could attend the conference.",japanese:"その会議に参加できればいいのですが。",explanation:"wishを使った願望の表現"}],relatedProblems:["subjunctive"],prerequisites:["basic-grammar-theory","tenses-theory","modals-theory"]},{id:"comparison-theory",title:"比較表現をマスター",category:"grammar",subcategory:"comparison",level:4,contentType:"theory",duration:360,difficulty:"intermediate",content:`# 比較表現をマスター

## 比較の基本
**2つ以上のものを比べる**表現です。

### 比較級（2つを比較）
#### 形：-er / more + 形容詞 + than
- **短い語**: tall → taller
- **例**: Tokyo is larger than Osaka. (東京は大阪より大きいです)
- **長い語**: more + beautiful
- **例**: This car is more expensive than that one. (この車はあの車より高価です)

### 最上級（3つ以上で最も）
#### 形：the + -est / the most + 形容詞
- **短い語**: the tallest
- **例**: Mt. Fuji is the highest mountain in Japan. (富士山は日本で最も高い山です)
- **長い語**: the most + beautiful
- **例**: This is the most important meeting. (これは最も重要な会議です)

### 同等比較
#### 形：as + 形容詞 + as
- **例**: This book is as interesting as that one. (この本はあの本と同じくらい面白いです)
- **否定**: not as + 形容詞 + as = ～ほど...ではない

## ビジネス英語での活用
### 提案・比較検討
- **This solution is more cost-effective than the previous one.**
- **Our new system is the most efficient in the industry.**

### TOEIC頻出表現
- **比較級 + and + 比較級**: ますます～
  - The market is getting more and more competitive.
- **the + 比較級, the + 比較級**: ～すればするほど
  - The more you practice, the better you become.

## 実践への活用
- ✅ 文法クイズの比較問題で満点
- ✅ 英作文で説得力のある比較
- ✅ TOEICのグラフ・データ問題で高得点`,keyPoints:["比較級：-er / more + than","最上級：the -est / the most","同等比較：as...as","ビジネスでの比較表現"],examples:[{english:"Our sales are higher than last year.",japanese:"売上は昨年より高いです。",explanation:"ビジネスでの比較級表現"},{english:"This is the best solution we can offer.",japanese:"これは私たちが提供できる最良の解決策です。",explanation:"最上級での強調表現"}],relatedProblems:["comparison"],prerequisites:["basic-grammar-theory","tenses-theory"]},{id:"participle-theory",title:"分詞・動名詞の使い分け",category:"grammar",subcategory:"participle",level:7,contentType:"theory",duration:540,difficulty:"advanced",content:`# 分詞・動名詞の使い分け

## 現在分詞（-ing）
### 進行形
- **形**: be動詞 + -ing
- **例**: I am reading a book. (本を読んでいます)

### 形容詞的用法
- **前置修飾**: a running man (走っている男性)
- **後置修飾**: The man running over there is my friend. (向こうで走っている男性は友人です)

### 分詞構文
- **例**: Walking in the park, I met an old friend. (公園を歩いていて、旧友に会いました)

## 過去分詞（-ed）
### 受動態
- **例**: The book was written by Shakespeare. (その本はシェイクスピアによって書かれました)

### 形容詞的用法
- **例**: I found a broken window. (壊れた窓を見つけました)
- **例**: The letter written by him was beautiful. (彼によって書かれた手紙は美しかった)

## 動名詞（-ing）
### 名詞として使用
- **主語**: Swimming is good exercise. (水泳は良い運動です)
- **目的語**: I enjoy reading books. (読書を楽しんでいます)
- **前置詞の後**: Thank you for helping me. (手伝ってくれてありがとう)

### 動名詞 vs 不定詞
#### 動名詞を取る動詞
- enjoy, finish, avoid, mind, suggest
- **例**: I finished writing the report. (レポートを書き終えました)

#### 不定詞を取る動詞  
- want, decide, hope, plan, expect
- **例**: I decided to study abroad. (留学することを決めました)

## ビジネス英語での活用
### 効率的な表現
- **Having completed the project, we can focus on the next phase.**
- **The increasing demand requires more resources.**

## 実践への活用
- ✅ 文法クイズの分詞・動名詞問題で満点
- ✅ 英作文で洗練された表現
- ✅ TOEICの複雑な文構造理解`,keyPoints:["現在分詞：進行・能動的修飾","過去分詞：完了・受動的修飾","動名詞：名詞としての-ing","動名詞と不定詞の使い分け"],examples:[{english:"The increasing sales show our success.",japanese:"増加している売上は私たちの成功を示しています。",explanation:"現在分詞の形容詞的用法"},{english:"I'm interested in learning new skills.",japanese:"新しいスキルを学ぶことに興味があります。",explanation:"前置詞の後の動名詞"}],relatedProblems:["participle"],prerequisites:["basic-grammar-theory","tenses-theory","passive-theory"]},{id:"infinitive-theory",title:"不定詞の3つの用法",category:"grammar",subcategory:"infinitive",level:5,contentType:"theory",duration:480,difficulty:"intermediate",content:`# 不定詞の3つの用法

## 不定詞とは？
**to + 動詞の原形**で、名詞・形容詞・副詞の働きをします。

### 名詞的用法（～すること）
#### 主語として
- **例**: To study English is important. (英語を勉強することは重要です)
- **改良**: It is important to study English. (英語を勉強することは重要です)

#### 目的語として
- **例**: I want to visit Japan. (日本を訪れたいです)
- **例**: I decided to change my job. (転職することを決めました)

### 形容詞的用法（～するための、～すべき）
#### 名詞を修飾
- **例**: I have something to tell you. (あなたに話すことがあります)
- **例**: This is the best way to solve the problem. (これが問題を解決する最良の方法です)

### 副詞的用法（～するために、～して）
#### 目的
- **例**: I came here to study English. (英語を勉強するためにここに来ました)
- **例**: We work hard to achieve our goals. (目標を達成するために一生懸命働きます)

#### 結果
- **例**: I woke up to find it was raining. (目を覚ますと雨が降っていました)

## ビジネス英語での重要性
### 目的・計画の表現
- **We need to improve our customer service.** (顧客サービスを改善する必要があります)
- **The goal is to increase sales by 20%.** (目標は売上を20%増加させることです)

### TOEIC頻出パターン
- **in order to**: ～するために（より丁寧）
- **so as to**: ～するために（否定形：so as not to）
- **too...to**: あまりに～すぎて...できない

## 実践への活用
- ✅ 文法クイズの不定詞問題で満点
- ✅ 英作文で目的・理由を明確に表現
- ✅ TOEICのビジネス文書で意図理解`,keyPoints:["名詞的用法：～すること","形容詞的用法：～するための","副詞的用法：～するために","ビジネスでの目的表現"],examples:[{english:"Our company plans to expand overseas.",japanese:"私たちの会社は海外展開を計画しています。",explanation:"目的語としての不定詞"},{english:"We have a meeting to discuss the budget.",japanese:"予算について話し合う会議があります。",explanation:"形容詞的用法：meetingを修飾"}],relatedProblems:["infinitive"],prerequisites:["basic-grammar-theory","tenses-theory"]},{id:"toeic-vocabulary-strategy",title:"TOEIC語彙攻略法",category:"vocabulary",subcategory:"toeic",level:3,contentType:"strategy",duration:420,difficulty:"intermediate",content:`# TOEIC語彙攻略法

## TOEIC語彙の特徴
**ビジネス場面**に特化した実用的な語彙が中心です。

### スコア帯別語彙戦略
#### 400-500点レベル
- **基本ビジネス語彙**: meeting, office, schedule, report
- **日常語彙**: important, available, necessary, possible
- **戦略**: ガチャの基礎パックで基本語彙を固める

#### 500-600点レベル  
- **中級ビジネス語彙**: conference, presentation, deadline, budget
- **動詞**: implement, analyze, collaborate, optimize
- **戦略**: ガチャの中級パックで実用語彙を拡充

#### 600-700点レベル
- **上級ビジネス語彙**: acquisition, comprehensive, substantial
- **形容詞**: sophisticated, efficient, strategic
- **戦略**: ガチャの上級パックでレア語彙を収集

### 語彙学習の相乗効果
#### ガチャシステムとの連携
1. **ガチャでカード獲得** → 新しい語彙に出会う
2. **事前学習で理論理解** → 語彙の使い方を学ぶ
3. **語彙学習で実践** → 記憶定着を図る
4. **文法クイズで応用** → 文脈での使用練習

#### 効果的な学習順序
1. **事前学習**: 語彙の背景知識・使用場面を理解
2. **ガチャ**: 楽しみながら新語彙獲得
3. **語彙学習**: 集中的な記憶練習
4. **文法クイズ**: 実際の文での使用練習

## 実践への活用
- ✅ ガチャで獲得した語彙の効率的学習
- ✅ 文法クイズでの語彙問題対策
- ✅ TOEICスコア向上の戦略的アプローチ`,keyPoints:["スコア帯別の語彙レベル","ガチャシステムとの連携学習","理論→実践の学習フロー","ビジネス場面での実用性"],examples:[{english:"The comprehensive report covers all aspects.",japanese:"包括的なレポートは全ての側面をカバーしています。",explanation:"上級語彙comprehensiveの使用例"},{english:"We need to optimize our workflow.",japanese:"ワークフローを最適化する必要があります。",explanation:"中級語彙optimizeの実用例"}],relatedProblems:["vocabulary"],prerequisites:[]},{id:"writing-strategy",title:"英作文で高得点を取る方法",category:"writing",subcategory:"strategy",level:8,contentType:"strategy",duration:480,difficulty:"advanced",content:`# 英作文で高得点を取る方法

## 英作文の基本戦略
**正確性**と**流暢性**のバランスが重要です。

### 文構造の基本パターン
#### シンプルな文から始める
1. **SVO**: I study English.
2. **SVC**: The meeting is important.
3. **SVOO**: He gave me a book.
4. **SVOC**: We found the solution effective.

#### 複雑な文への発展
1. **接続詞**: because, although, while
2. **関係詞**: who, which, that
3. **分詞構文**: Having finished the work, I went home.

### 語彙レベルの使い分け
#### 基本レベル（400-500点）
- **動詞**: go, come, make, take, get
- **形容詞**: good, bad, big, small, important
- **戦略**: 確実に使える語彙で文を構成

#### 中級レベル（500-600点）
- **動詞**: implement, analyze, collaborate
- **形容詞**: efficient, effective, appropriate
- **戦略**: ガチャで獲得した語彙を積極活用

#### 上級レベル（600-700点）
- **動詞**: optimize, enhance, facilitate
- **形容詞**: comprehensive, sophisticated, substantial
- **戦略**: レア語彙で表現力をアップ

### 文法クイズとの相乗効果
#### 学習した文法の実践
1. **基本文型** → 正確な語順で作文
2. **時制** → 適切な時制選択
3. **助動詞** → 丁寧さレベルの調整
4. **受動態** → フォーマルな表現
5. **関係詞** → 複雑な文構造
6. **仮定法** → 高度な表現力

## 実践への活用
- ✅ 文法クイズで学んだ知識の実践
- ✅ ガチャ語彙の効果的活用
- ✅ TOEICライティングセクション対策`,keyPoints:["シンプルな文から複雑な文へ","語彙レベルの戦略的使い分け","文法知識の実践的応用","ガチャ語彙との相乗効果"],examples:[{english:"Having analyzed the data, we decided to implement the new strategy.",japanese:"データを分析した結果、新戦略を実施することを決定しました。",explanation:"分詞構文 + 上級語彙の組み合わせ"},{english:"The comprehensive report, which was written by our team, provides valuable insights.",japanese:"私たちのチームが作成した包括的なレポートは、貴重な洞察を提供します。",explanation:"関係詞 + 上級語彙での複雑な文構造"}],relatedProblems:["writing"],prerequisites:["basic-grammar-theory","tenses-theory","relative-theory","participle-theory"]}];function Ua(a){return Kt.filter(t=>t.level<=a)}const Xa=()=>{const[a,t]=l.useState(()=>V().getHeartSystem()),s=()=>{const p=V();return p.getHeartSystem().current>0?(p.consumeHeart(),de(),t(p.getHeartSystem()),!0):!1},n=(p=1)=>{const b=V();b.addHeart(p),de(),t(b.getHeartSystem())},r=()=>{const p=V();p.recoverHeart(),de(),t(p.getHeartSystem())},i=()=>{const p=V();p.resetHearts(),de(),t(p.getHeartSystem())},c=()=>{const b=V().getHeartSystem(),x=Date.now()-b.lastRecoveryTime,m=300*1e3;return Math.max(0,m-x)},o=()=>a.current>0,d=()=>a.current>=a.max,h=()=>{if(a.current>=a.max)return 100;const p=c(),b=300*1e3;return Math.max(0,Math.min(100,(b-p)/b*100))},g=()=>{const b=V().processHeartRecovery();return t(b),de(),b},v=()=>{const b=V().processHeartRecovery();t(b),de()};return l.useEffect(()=>{const p=setInterval(()=>{const k=V().getHeartSystem();k.current<k.max&&c()<=0&&g()},1e3);return()=>clearInterval(p)},[a.current]),{heartSystem:a,consumeHeart:s,addHeart:n,recoverHeart:r,resetHearts:i,getTimeUntilRecovery:c,canConsumeHeart:o,isFull:d,getRecoveryProgress:h,processRecovery:g,refreshHearts:v}},Qa=()=>{const[a,t]=l.useState(()=>V().getLevel());return{userLevel:a,addXP:r=>{const i=V(),c=i.addXP(r);return t(i.getLevel()),de(),c},refreshLevel:()=>{const r=V();t(r.getLevel())}}},Ka=7200*1e3,Ya=3,Ja=10,Ze=(a,t=Date.now())=>{if(a.current>=a.max)return a.current;const s=t-a.lastRecoveryTime,n=Math.floor(s/Ka);return Math.min(a.current+n,a.max)},Et=(a,t=1)=>Ze(a)>=t,Za=a=>Ya+Math.floor((a-1)/Ja),en=a=>{const t=Za(a);return{current:t,max:t,lastRecoveryTime:Date.now()}},tn=[{id:1,sentence:"I ___ to the store yesterday.",blanks:[{id:"blank1",position:2,correctAnswer:"went"}],options:["go","went","going","goes"],explanation:"過去の時点での行動を表すため、過去形「went」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:2,sentence:"The book ___ on the table ___ mine.",blanks:[{id:"blank1",position:3,correctAnswer:"lying"},{id:"blank2",position:7,correctAnswer:"is"}],options:["lying","laying","is","are","was","were","lying","is"],explanation:"「lying」（横たわっている）と単数形の「is」が正解です。",level:"intermediate",category:"basic-sentence-patterns"},{id:3,sentence:"They ___ playing soccer when it ___ to rain.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:7,correctAnswer:"started"}],options:["were","was","started","start","are","have","were","started"],explanation:"過去進行形「were playing」と過去形「started」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:4,sentence:"I ___ my homework before I ___ to bed.",blanks:[{id:"blank1",position:1,correctAnswer:"finished"},{id:"blank2",position:5,correctAnswer:"went"}],options:["finished","finish","went","go","will finish","will go","finished","went"],explanation:"過去の順序を表すため過去形「finished」と「went」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:5,sentence:"He ___ to the store ___ some milk.",blanks:[{id:"blank1",position:2,correctAnswer:"went"},{id:"blank2",position:5,correctAnswer:"to buy"}],options:["went","goes","to buy","buying","bought","will buy","went","to buy"],explanation:"過去形「went」と目的を表す不定詞「to buy」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:6,sentence:"She ___ her keys ___ she left the house.",blanks:[{id:"blank1",position:2,correctAnswer:"forgot"},{id:"blank2",position:5,correctAnswer:"when"}],options:["forgot","forgets","when","while","before","after","forgot","when"],explanation:"過去形「forgot」と時を表す「when」が正解です。",level:"beginner",category:"basic-sentence-patterns"},{id:7,sentence:"The students ___ their homework ___ the teacher arrived.",blanks:[{id:"blank1",position:3,correctAnswer:"had finished"},{id:"blank2",position:6,correctAnswer:"when"}],options:["had finished","finished","when","before","after","while","had finished","when"],explanation:"過去完了形「had finished」と時を表す「when」が正解です。",level:"advanced",category:"basic-sentence-patterns"},{id:8,sentence:"I ___ you ___ come to the party tomorrow.",blanks:[{id:"blank1",position:2,correctAnswer:"hope"},{id:"blank2",position:4,correctAnswer:"will"}],options:["hope","hoped","will","would","can","could","hope","will"],explanation:"現在形「hope」と未来形「will」が正解です。",level:"intermediate",category:"basic-sentence-patterns"},{id:9,sentence:"She ___ been studying English ___ three years.",blanks:[{id:"blank1",position:2,correctAnswer:"has"},{id:"blank2",position:6,correctAnswer:"for"}],options:["has","have","for","since","is","was","has","for"],explanation:"現在完了形「has been studying」と期間を表す「for」が正解です。",level:"intermediate",category:"tenses"},{id:10,sentence:"By the time you arrive, I ___ finished my homework.",blanks:[{id:"blank1",position:7,correctAnswer:"will have"}],options:["will have","will","have","had","would have"],explanation:"未来完了形「will have finished」が正解です。",level:"advanced",category:"tenses"},{id:11,sentence:"She ___ English for five years ___ she started working.",blanks:[{id:"blank1",position:2,correctAnswer:"had been studying"},{id:"blank2",position:7,correctAnswer:"when"}],options:["had been studying","has been studying","when","before","after","while","had been studying","when"],explanation:"過去完了進行形「had been studying」と時を表す「when」が正解です。",level:"advanced",category:"tenses"},{id:12,sentence:"The children ___ playing in the park ___ it started raining.",blanks:[{id:"blank1",position:3,correctAnswer:"were"},{id:"blank2",position:7,correctAnswer:"when"}],options:["were","was","when","while","before","after","were","when"],explanation:"過去進行形「were playing」と時を表す「when」が正解です。",level:"beginner",category:"tenses"},{id:13,sentence:"I ___ this book three times already.",blanks:[{id:"blank1",position:2,correctAnswer:"have read"}],options:["have read","read","am reading","will read"],explanation:"現在完了形「have read」が正解です。",level:"intermediate",category:"tenses"},{id:14,sentence:"He ___ to Japan next month.",blanks:[{id:"blank1",position:2,correctAnswer:"will go"}],options:["will go","goes","is going","went"],explanation:"未来形「will go」が正解です。",level:"beginner",category:"tenses"},{id:15,sentence:"I ___ my homework when you called.",blanks:[{id:"blank1",position:2,correctAnswer:"was doing"}],options:["was doing","did","am doing","have done"],explanation:"過去進行形「was doing」が正解です。",level:"intermediate",category:"tenses"},{id:16,sentence:"She ___ here since 2020.",blanks:[{id:"blank1",position:2,correctAnswer:"has lived"}],options:["has lived","lived","is living","will live"],explanation:"現在完了形「has lived」が正解です。",level:"intermediate",category:"tenses"},{id:17,sentence:"You ___ study harder if you want to pass the exam.",blanks:[{id:"blank1",position:2,correctAnswer:"should"}],options:["should","can","must","will"],explanation:"助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:18,sentence:"I ___ speak three languages fluently.",blanks:[{id:"blank1",position:2,correctAnswer:"can"}],options:["can","should","must","will"],explanation:"助動詞「can」が正解です。",level:"beginner",category:"auxiliaries"},{id:19,sentence:"You ___ not smoke in this building.",blanks:[{id:"blank1",position:2,correctAnswer:"must"}],options:["must","can","should","will"],explanation:"助動詞「must」が正解です。",level:"intermediate",category:"auxiliaries"},{id:20,sentence:"I ___ you ___ call me if you need help.",blanks:[{id:"blank1",position:2,correctAnswer:"suggest"},{id:"blank2",position:4,correctAnswer:"should"}],options:["suggest","suggested","should","would","could","might","suggest","should"],explanation:"提案を表す「suggest」と助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:21,sentence:"You ___ have told me earlier.",blanks:[{id:"blank1",position:2,correctAnswer:"should"}],options:["should","can","must","will"],explanation:"助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:22,sentence:"I ___ not believe what I'm seeing.",blanks:[{id:"blank1",position:2,correctAnswer:"can"}],options:["can","should","must","will"],explanation:"助動詞「can」が正解です。",level:"beginner",category:"auxiliaries"},{id:23,sentence:"You ___ be more careful next time.",blanks:[{id:"blank1",position:2,correctAnswer:"should"}],options:["should","can","must","will"],explanation:"助動詞「should」が正解です。",level:"intermediate",category:"auxiliaries"},{id:24,sentence:"I ___ have finished this by tomorrow.",blanks:[{id:"blank1",position:2,correctAnswer:"will"}],options:["will","can","should","must"],explanation:"助動詞「will」が正解です。",level:"intermediate",category:"auxiliaries"},{id:25,sentence:"The house ___ by a famous architect.",blanks:[{id:"blank1",position:3,correctAnswer:"was designed"}],options:["was designed","designed","is designing","will design"],explanation:"受動態「was designed」が正解です。",level:"intermediate",category:"passive-voice"},{id:26,sentence:"The book ___ in many countries.",blanks:[{id:"blank1",position:3,correctAnswer:"is read"}],options:["is read","reads","was reading","will read"],explanation:"受動態「is read」が正解です。",level:"beginner",category:"passive-voice"},{id:27,sentence:"The door ___ by someone.",blanks:[{id:"blank1",position:3,correctAnswer:"was opened"}],options:["was opened","opened","is opening","will open"],explanation:"受動態「was opened」が正解です。",level:"intermediate",category:"passive-voice"},{id:28,sentence:"The project ___ by the team last month.",blanks:[{id:"blank1",position:3,correctAnswer:"was completed"}],options:["was completed","completed","is completing","will complete"],explanation:"受動態「was completed」が正解です。",level:"intermediate",category:"passive-voice"},{id:29,sentence:"The letter ___ yesterday.",blanks:[{id:"blank1",position:3,correctAnswer:"was sent"}],options:["was sent","sent","is sending","will send"],explanation:"受動態「was sent」が正解です。",level:"beginner",category:"passive-voice"},{id:30,sentence:"The problem ___ by the engineers.",blanks:[{id:"blank1",position:3,correctAnswer:"is being solved"}],options:["is being solved","solves","solved","will solve"],explanation:"受動態進行形「is being solved」が正解です。",level:"advanced",category:"passive-voice"},{id:31,sentence:"The meeting ___ at 3 PM tomorrow.",blanks:[{id:"blank1",position:3,correctAnswer:"will be held"}],options:["will be held","holds","held","is holding"],explanation:"受動態未来形「will be held」が正解です。",level:"intermediate",category:"passive-voice"},{id:32,sentence:"The car ___ by my father.",blanks:[{id:"blank1",position:3,correctAnswer:"was bought"}],options:["was bought","bought","is buying","will buy"],explanation:"受動態「was bought」が正解です。",level:"beginner",category:"passive-voice"},{id:33,sentence:"The movie ___ we watched last night ___ very exciting.",blanks:[{id:"blank1",position:2,correctAnswer:"that"},{id:"blank2",position:7,correctAnswer:"was"}],options:["that","which","who","was","were","is","that","was"],explanation:"関係代名詞「that」と過去形「was」が正解です。",level:"intermediate",category:"relative-clauses"},{id:34,sentence:"The book ___ I read yesterday ___ very interesting.",blanks:[{id:"blank1",position:2,correctAnswer:"which"},{id:"blank2",position:6,correctAnswer:"was"}],options:["which","that","who","was","were","is","which","was"],explanation:"関係代名詞「which」と過去形「was」が正解です。",level:"intermediate",category:"relative-clauses"},{id:35,sentence:"The man ___ is standing there is my teacher.",blanks:[{id:"blank1",position:3,correctAnswer:"who"}],options:["who","which","that","whom"],explanation:"関係代名詞「who」が正解です。",level:"beginner",category:"relative-clauses"},{id:36,sentence:"This is the house ___ I was born.",blanks:[{id:"blank1",position:4,correctAnswer:"where"}],options:["where","which","that","who"],explanation:"関係副詞「where」が正解です。",level:"intermediate",category:"relative-clauses"},{id:37,sentence:"The reason ___ he left is unknown.",blanks:[{id:"blank1",position:3,correctAnswer:"why"}],options:["why","which","that","who"],explanation:"関係副詞「why」が正解です。",level:"intermediate",category:"relative-clauses"},{id:38,sentence:"The day ___ I met you was wonderful.",blanks:[{id:"blank1",position:3,correctAnswer:"when"}],options:["when","which","that","who"],explanation:"関係副詞「when」が正解です。",level:"intermediate",category:"relative-clauses"},{id:39,sentence:"The woman ___ you saw is my sister.",blanks:[{id:"blank1",position:3,correctAnswer:"whom"}],options:["whom","who","which","that"],explanation:"関係代名詞「whom」が正解です。",level:"advanced",category:"relative-clauses"},{id:40,sentence:"The car ___ color is red belongs to me.",blanks:[{id:"blank1",position:3,correctAnswer:"whose"}],options:["whose","which","that","who"],explanation:"関係代名詞「whose」が正解です。",level:"advanced",category:"relative-clauses"},{id:41,sentence:"If I ___ rich, I ___ travel around the world.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:5,correctAnswer:"would"}],options:["were","was","would","will","am","could","were","would"],explanation:"仮定法過去「If I were rich, I would travel」が正解です。",level:"advanced",category:"subjunctive"},{id:42,sentence:"I wish I ___ more time to finish this project.",blanks:[{id:"blank1",position:3,correctAnswer:"had"}],options:["had","have","has","will have"],explanation:"願望を表す「I wish」の後は仮定法過去「had」を使います。",level:"advanced",category:"subjunctive"},{id:43,sentence:"If I ___ you, I ___ study harder.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:5,correctAnswer:"would"}],options:["were","was","would","will","should","could","were","would"],explanation:"仮定法過去「If I were you, I would study」が正解です。",level:"advanced",category:"subjunctive"},{id:44,sentence:"I wish I ___ speak French fluently.",blanks:[{id:"blank1",position:3,correctAnswer:"could"}],options:["could","can","will","would"],explanation:"願望を表す「I wish」の後は仮定法過去「could」を使います。",level:"intermediate",category:"subjunctive"},{id:45,sentence:"If I ___ known earlier, I ___ have come.",blanks:[{id:"blank1",position:2,correctAnswer:"had"},{id:"blank2",position:5,correctAnswer:"would"}],options:["had","have","would","will","could","should","had","would"],explanation:"仮定法過去完了「If I had known, I would have come」が正解です。",level:"advanced",category:"subjunctive"},{id:46,sentence:"I wish I ___ not made that mistake.",blanks:[{id:"blank1",position:3,correctAnswer:"had"}],options:["had","have","has","will have"],explanation:"願望を表す「I wish」の後は仮定法過去完了「had」を使います。",level:"advanced",category:"subjunctive"},{id:47,sentence:"If I ___ you, I ___ not do that.",blanks:[{id:"blank1",position:2,correctAnswer:"were"},{id:"blank2",position:5,correctAnswer:"would"}],options:["were","was","would","will","should","could","were","would"],explanation:"仮定法過去「If I were you, I would not do」が正解です。",level:"advanced",category:"subjunctive"},{id:48,sentence:"I wish it ___ stop raining.",blanks:[{id:"blank1",position:3,correctAnswer:"would"}],options:["would","will","can","could"],explanation:"願望を表す「I wish」の後は仮定法過去「would」を使います。",level:"intermediate",category:"subjunctive"},{id:49,sentence:"She is ___ intelligent ___ her sister.",blanks:[{id:"blank1",position:2,correctAnswer:"as"},{id:"blank2",position:4,correctAnswer:"as"}],options:["as","as","so","more","most","than","very","as","as"],explanation:"同等比較「as ... as」の構文が正解です。",level:"intermediate",category:"comparison"},{id:50,sentence:"This book is ___ than that one.",blanks:[{id:"blank1",position:3,correctAnswer:"more interesting"}],options:["more interesting","interesting","most interesting","as interesting"],explanation:"比較級「more interesting」が正解です。",level:"beginner",category:"comparison"},{id:51,sentence:"He is the ___ student in the class.",blanks:[{id:"blank1",position:4,correctAnswer:"tallest"}],options:["tallest","taller","tall","as tall"],explanation:"最上級「tallest」が正解です。",level:"beginner",category:"comparison"},{id:52,sentence:"This is ___ expensive ___ that.",blanks:[{id:"blank1",position:2,correctAnswer:"as"},{id:"blank2",position:4,correctAnswer:"as"}],options:["as","as","so","more","most","than","very","as","as"],explanation:"同等比較「as ... as」の構文が正解です。",level:"intermediate",category:"comparison"},{id:53,sentence:"She runs ___ than her brother.",blanks:[{id:"blank1",position:2,correctAnswer:"faster"}],options:["faster","fast","fastest","as fast"],explanation:"比較級「faster」が正解です。",level:"beginner",category:"comparison"},{id:54,sentence:"This is the ___ beautiful place I've ever seen.",blanks:[{id:"blank1",position:4,correctAnswer:"most"}],options:["most","more","very","as"],explanation:"最上級「most」が正解です。",level:"intermediate",category:"comparison"},{id:55,sentence:"He is ___ than I expected.",blanks:[{id:"blank1",position:2,correctAnswer:"taller"}],options:["taller","tall","tallest","as tall"],explanation:"比較級「taller」が正解です。",level:"beginner",category:"comparison"},{id:56,sentence:"This problem is ___ difficult ___ the previous one.",blanks:[{id:"blank1",position:3,correctAnswer:"as"},{id:"blank2",position:5,correctAnswer:"as"}],options:["as","as","so","more","most","than","very","as","as"],explanation:"同等比較「as ... as」の構文が正解です。",level:"intermediate",category:"comparison"},{id:57,sentence:"___ English is not easy for me.",blanks:[{id:"blank1",position:1,correctAnswer:"Learning"}],options:["Learning","Learn","Learned","To learn"],explanation:"動名詞「Learning」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:58,sentence:"I enjoy ___ books in my free time.",blanks:[{id:"blank1",position:2,correctAnswer:"reading"}],options:["reading","read","to read","reads"],explanation:"動名詞「reading」が正解です。",level:"beginner",category:"participles-gerunds"},{id:59,sentence:"The ___ child was crying loudly.",blanks:[{id:"blank1",position:2,correctAnswer:"crying"}],options:["crying","cry","cried","cries"],explanation:"現在分詞「crying」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:60,sentence:"I saw a ___ bird in the tree.",blanks:[{id:"blank1",position:3,correctAnswer:"singing"}],options:["singing","sing","sang","sings"],explanation:"現在分詞「singing」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:61,sentence:"___ tired, I went to bed early.",blanks:[{id:"blank1",position:1,correctAnswer:"Feeling"}],options:["Feeling","Feel","Felt","To feel"],explanation:"現在分詞「Feeling」が正解です。",level:"advanced",category:"participles-gerunds"},{id:62,sentence:"The ___ book is on the table.",blanks:[{id:"blank1",position:2,correctAnswer:"opened"}],options:["opened","opening","open","opens"],explanation:"過去分詞「opened」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:63,sentence:"I'm looking forward to ___ you again.",blanks:[{id:"blank1",position:4,correctAnswer:"seeing"}],options:["seeing","see","saw","sees"],explanation:"動名詞「seeing」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:64,sentence:"The ___ door was difficult to open.",blanks:[{id:"blank1",position:2,correctAnswer:"broken"}],options:["broken","breaking","break","breaks"],explanation:"過去分詞「broken」が正解です。",level:"intermediate",category:"participles-gerunds"},{id:65,sentence:"I want ___ a doctor when I grow up.",blanks:[{id:"blank1",position:2,correctAnswer:"to become"}],options:["to become","become","becoming","became"],explanation:"不定詞「to become」が正解です。",level:"beginner",category:"infinitives"},{id:66,sentence:"It's important ___ English every day.",blanks:[{id:"blank1",position:3,correctAnswer:"to practice"}],options:["to practice","practice","practicing","practiced"],explanation:"不定詞「to practice」が正解です。",level:"intermediate",category:"infinitives"},{id:67,sentence:"I need ___ some money from the bank.",blanks:[{id:"blank1",position:2,correctAnswer:"to withdraw"}],options:["to withdraw","withdraw","withdrawing","withdrew"],explanation:"不定詞「to withdraw」が正解です。",level:"intermediate",category:"infinitives"},{id:68,sentence:"She decided ___ her job.",blanks:[{id:"blank1",position:2,correctAnswer:"to quit"}],options:["to quit","quit","quitting","quits"],explanation:"不定詞「to quit」が正解です。",level:"intermediate",category:"infinitives"},{id:69,sentence:"It's difficult ___ this problem.",blanks:[{id:"blank1",position:3,correctAnswer:"to solve"}],options:["to solve","solve","solving","solved"],explanation:"不定詞「to solve」が正解です。",level:"intermediate",category:"infinitives"},{id:70,sentence:"I hope ___ you soon.",blanks:[{id:"blank1",position:2,correctAnswer:"to see"}],options:["to see","see","seeing","saw"],explanation:"不定詞「to see」が正解です。",level:"beginner",category:"infinitives"},{id:71,sentence:"She asked me ___ her with the homework.",blanks:[{id:"blank1",position:3,correctAnswer:"to help"}],options:["to help","help","helping","helped"],explanation:"不定詞「to help」が正解です。",level:"intermediate",category:"infinitives"},{id:72,sentence:"It's nice ___ you again.",blanks:[{id:"blank1",position:3,correctAnswer:"to meet"}],options:["to meet","meet","meeting","met"],explanation:"不定詞「to meet」が正解です。",level:"beginner",category:"infinitives"}];function sn(a,t){let s=tn;return s=s.filter(n=>n.level===a),t&&(s=s.filter(n=>n.category===t)),s}const an=[{id:"basic-sentence-patterns",name:"基本文型",description:"SV, SVC, SVO, SVOO, SVOCの基本文型"},{id:"tenses",name:"時制",description:"現在、過去、未来、完了形の時制"},{id:"auxiliaries",name:"助動詞",description:"can, may, must, should等の助動詞"},{id:"passive-voice",name:"受動態",description:"be動詞 + 過去分詞の受動態"},{id:"relative-clauses",name:"関係詞",description:"who, which, that等の関係詞"},{id:"subjunctive",name:"仮定法",description:"if文、wish等の仮定法"},{id:"comparison",name:"比較",description:"比較級、最上級の比較表現"},{id:"participles-gerunds",name:"分詞・動名詞",description:"-ing形の使い分け"},{id:"infinitives",name:"不定詞",description:"to不定詞の用法"}];function nn({onSelectCategory:a,onBack:t}){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(w,{variant:"outline",onClick:t,className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"文法カテゴリー選択"}),e.jsx("p",{className:"text-gray-600",children:"学習したい文法カテゴリーを選択してください"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:an.map(s=>e.jsxs(N,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>a(s.id),children:[e.jsx(R,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center",children:[e.jsx(Ge,{className:"w-5 h-5 mr-2 text-blue-600"}),s.name]})}),e.jsxs(I,{children:[e.jsx("p",{className:"text-sm text-gray-600",children:s.description}),e.jsxs("div",{className:"mt-4 flex items-center text-sm text-blue-600",children:["クリックして開始",e.jsx(Q,{className:"w-4 h-4 ml-1 rotate-180"})]})]})]},s.id))})]})})}function rn({categoryName:a,onSelectDifficulty:t,onBack:s}){const n=[{id:"beginner",name:"簡単",description:"基本的な文法問題",icon:se,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200"},{id:"intermediate",name:"普通",description:"中級レベルの文法問題",icon:He,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200"},{id:"advanced",name:"難しい",description:"上級レベルの文法問題",icon:zt,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:s,className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"難易度選択"}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:a}),e.jsx("p",{className:"text-gray-600",children:"学習したい難易度を選択してください"})]}),e.jsx("div",{className:"space-y-4",children:n.map(r=>{const i=r.icon;return e.jsxs(N,{className:`hover:shadow-lg transition-shadow cursor-pointer ${r.bgColor} ${r.borderColor} border-2`,onClick:()=>t(r.id),children:[e.jsx(R,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center",children:[e.jsx(i,{className:`w-5 h-5 mr-2 ${r.color}`}),r.name]})}),e.jsxs(I,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:r.description}),e.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:["クリックして開始",e.jsx(Q,{className:"w-4 h-4 ml-1 rotate-180"})]})]})]},r.id)})})]})})}const Rt="entp-daily-challenge";class dt{static getTodayChallenge(){const t=this.getTodayString(),s=this.getProgress();if(s.currentChallenge&&s.currentChallenge.date===t)return s.currentChallenge;const n=this.generateDailyChallenge(t);return this.saveProgress({...s,currentChallenge:n}),n}static generateDailyChallenge(t){const s=this.getChallengeTemplates(),n=this.dateToSeed(t);return{...s[n%s.length],id:`challenge-${t}`,date:t,isCompleted:!1}}static getChallengeTemplates(){return[{name:"スピードマスター",description:"制限時間半分で語彙学習をクリア！",type:"vocabulary",rules:[{type:"time-limit",value:30,description:"1単語あたり30秒以内で回答"},{type:"accuracy-target",value:80,description:"正解率80%以上を維持"}],bonusXP:50,bonusMultiplier:1.5,icon:"⚡",color:"bg-yellow-500"},{name:"完璧主義者",description:"文法クイズで100%の正解率を目指そう！",type:"grammar",rules:[{type:"accuracy-target",value:100,description:"正解率100%でクリア"},{type:"word-count",value:10,description:"最低10問解答"}],bonusXP:75,bonusMultiplier:2,icon:"🎯",color:"bg-red-500"},{name:"創造力テスト",description:"学んだ単語で短いストーリーを作ろう！",type:"creative",rules:[{type:"word-count",value:5,description:"今日学んだ単語を5個以上使用"},{type:"special-mode",value:"creative-writing",description:"英語で50文字以上のストーリー"}],bonusXP:100,bonusMultiplier:2.5,icon:"✨",color:"bg-purple-500"},{name:"効率の鬼",description:"最短時間で最大XPを獲得せよ！",type:"efficiency",rules:[{type:"time-limit",value:300,description:"5分以内に学習完了"},{type:"accuracy-target",value:90,description:"正解率90%以上"}],bonusXP:60,bonusMultiplier:1.8,icon:"🚀",color:"bg-blue-500"},{name:"逆転の発想",description:"間違いから学ぶ！あえて難しい問題に挑戦",type:"grammar",rules:[{type:"special-mode",value:"hard-mode",description:"上級レベルの問題のみ"},{type:"accuracy-target",value:70,description:"正解率70%以上で合格"}],bonusXP:80,bonusMultiplier:2.2,icon:"🔄",color:"bg-green-500"},{name:"タイムアタッカー",description:"タイムアタックで連続正解記録を作ろう！",type:"time-attack",rules:[{type:"word-count",value:5,description:"連続5問正解"},{type:"time-limit",value:120,description:"2分以内で達成"}],bonusXP:70,bonusMultiplier:1.7,icon:"⏱️",color:"bg-orange-500"},{name:"語彙コレクター",description:"新しい単語を20個覚えよう！",type:"vocabulary",rules:[{type:"word-count",value:20,description:"新しい単語を20個学習"},{type:"accuracy-target",value:85,description:"平均正解率85%以上"}],bonusXP:90,bonusMultiplier:2,icon:"📚",color:"bg-indigo-500"}]}static completeChallenge(t){const s=this.getProgress();if(!s.currentChallenge||s.currentChallenge.id!==t)return!1;const n=this.getTodayString(),r={...s.currentChallenge,isCompleted:!0,completedAt:new Date};let i=s.streakCount;s.lastCompletedDate===this.getYesterdayString()?i+=1:s.lastCompletedDate!==n&&(i=1);const c={currentChallenge:r,completedChallenges:[...s.completedChallenges,t],streakCount:i,totalCompleted:s.totalCompleted+1,lastCompletedDate:n};return this.saveProgress(c),!0}static getProgress(){try{const t=localStorage.getItem(Rt);if(t)return JSON.parse(t)}catch(t){console.error("デイリーチャレンジ進捗読み込みエラー:",t)}return{currentChallenge:null,completedChallenges:[],streakCount:0,totalCompleted:0,lastCompletedDate:""}}static canCompleteChallenge(t,s){return t.rules.every(n=>{switch(n.type){case"accuracy-target":return s.accuracy*100>=n.value;case"time-limit":return s.timeSpent<=n.value;case"word-count":return s.questionsAnswered>=n.value;case"special-mode":return n.value==="hard-mode"?s.difficulty==="advanced":n.value==="creative-writing"?s.mode==="creative":!0;default:return!0}})}static getChallengeDescription(t){const s=t.rules.map(n=>n.description);return`${t.description}

条件:
${s.map((n,r)=>`${r+1}. ${n}`).join(`
`)}`}static getTodayString(){return new Date().toISOString().split("T")[0]}static getYesterdayString(){const t=new Date;return t.setDate(t.getDate()-1),t.toISOString().split("T")[0]}static dateToSeed(t){return t.split("-").map(Number).reduce((s,n)=>s+n,0)}static saveProgress(t){try{localStorage.setItem(Rt,JSON.stringify(t))}catch(s){console.error("デイリーチャレンジ進捗保存エラー:",s)}}static getStats(){const t=this.getProgress();this.getTodayString();const s=new Date;s.setDate(s.getDate()-30);const r=t.completedChallenges.filter(i=>i.split("-")[1]>=s.toISOString().split("T")[0]).length/30;return{currentStreak:t.streakCount,totalCompleted:t.totalCompleted,completionRate:Math.min(r,1),favoriteType:"vocabulary"}}}function ln(){const a=ae(),[t,s]=l.useState(null),[n,r]=l.useState(null),[i,c]=l.useState(null);l.useEffect(()=>{const h=dt.getTodayChallenge(),g=dt.getProgress(),v=dt.getStats();s(h),r(g),c(v)},[]);const o=()=>{if(t)switch(t.type){case"vocabulary":a("/learning/vocabulary/difficulty?challenge=true");break;case"grammar":a("/learning/grammar/category?challenge=true");break;case"time-attack":a("/learning/time-attack?challenge=true");break;case"creative":a("/learning/essay-writing?challenge=true");break;case"efficiency":a("/learning/vocabulary/difficulty?challenge=true&mode=efficiency");break;default:a("/learning/vocabulary/difficulty")}},d=h=>{switch(h){case"vocabulary":return"語彙";case"grammar":return"文法";case"time-attack":return"タイムアタック";case"creative":return"創作";case"efficiency":return"効率";default:return"チャレンジ"}};return!t||!n||!i?e.jsx(N,{className:"border-0 shadow-md",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})})}):e.jsxs(N,{className:`border-0 shadow-lg overflow-hidden ${t.isCompleted?"opacity-75":""}`,children:[e.jsx("div",{className:`h-2 ${t.color}`}),e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"text-2xl",children:t.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:t.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{variant:"outline",className:"text-xs",children:d(t.type)}),e.jsx(D,{variant:"secondary",className:"text-xs",children:"今日限定"})]})]})]}),t.isCompleted&&e.jsx("div",{className:"text-green-500 text-2xl",children:"✅"})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:t.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-800",children:"クリア条件"}),e.jsx("div",{className:"space-y-1",children:t.rules.map((h,g)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-600",children:h.description})]},g))})]}),e.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 p-3 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{className:"text-sm font-semibold text-yellow-800",children:"ボーナス報酬"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-bold text-yellow-800",children:["+",t.bonusXP," XP"]}),e.jsxs("div",{className:"text-xs text-yellow-600",children:[t.bonusMultiplier,"x倍率"]})]})]})}),i.currentStreak>0&&e.jsxs("div",{className:"flex items-center justify-between p-2 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(He,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"text-sm text-orange-800",children:"チャレンジストリーク"})]}),e.jsxs("div",{className:"text-sm font-bold text-orange-800",children:[i.currentStreak,"日連続"]})]}),e.jsx("div",{className:"pt-2",children:t.isCompleted?e.jsx(w,{disabled:!0,className:"w-full h-12 bg-green-500 text-white",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("span",{children:"✅ 今日のチャレンジ完了！"})})}):e.jsx(w,{onClick:o,className:"w-full h-12 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-semibold",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"w-5 h-5"}),e.jsx("span",{children:"チャレンジ開始"})]})})}),e.jsx("div",{className:"pt-2 border-t border-gray-100",children:e.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[e.jsxs("span",{children:["総完了: ",i.totalCompleted,"回"]}),e.jsxs("span",{children:["完了率: ",Math.round(i.completionRate*100),"%"]})]})})]})]})}const Xe=l.forwardRef(({className:a,...t},s)=>e.jsx("textarea",{className:J("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...t}));Xe.displayName="Textarea";var on="Label",Yt=l.forwardRef((a,t)=>e.jsx(ce.label,{...a,ref:t,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(a.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));Yt.displayName=on;var Jt=Yt;const cn=Xt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fe=l.forwardRef(({className:a,...t},s)=>e.jsx(Jt,{ref:s,className:J(cn(),a),...t}));fe.displayName=Jt.displayName;function Dt(a,[t,s]){return Math.min(s,Math.max(t,a))}function Zt(a){const t=l.useRef({value:a,previous:a});return l.useMemo(()=>(t.current.value!==a&&(t.current.previous=t.current.value,t.current.value=a),t.current.previous),[a])}var es=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),dn="VisuallyHidden",mn=l.forwardRef((a,t)=>e.jsx(ce.span,{...a,ref:t,style:{...es,...a.style}}));mn.displayName=dn;var hn=[" ","Enter","ArrowUp","ArrowDown"],xn=[" ","Enter"],De="Select",[st,at,un]=Us(De),[Fe]=$t(De,[un,Ht]),nt=Ht(),[gn,Te]=Fe(De),[pn,fn]=Fe(De),ts=a=>{const{__scopeSelect:t,children:s,open:n,defaultOpen:r,onOpenChange:i,value:c,defaultValue:o,onValueChange:d,dir:h,name:g,autoComplete:v,disabled:p,required:b,form:k}=a,x=nt(t),[m,f]=l.useState(null),[S,j]=l.useState(null),[O,H]=l.useState(!1),Z=na(h),[T,u]=mt({prop:n,defaultProp:r??!1,onChange:i,caller:De}),[y,$]=mt({prop:c,defaultProp:o,onChange:d,caller:De}),z=l.useRef(null),K=m?k||!!m.closest("form"):!0,[le,L]=l.useState(new Set),U=Array.from(le).map(_=>_.props.value).join(";");return e.jsx(ra,{...x,children:e.jsxs(gn,{required:b,scope:t,trigger:m,onTriggerChange:f,valueNode:S,onValueNodeChange:j,valueNodeHasChildren:O,onValueNodeHasChildrenChange:H,contentId:jt(),value:y,onValueChange:$,open:T,onOpenChange:u,dir:Z,triggerPointerDownPosRef:z,disabled:p,children:[e.jsx(st.Provider,{scope:t,children:e.jsx(pn,{scope:a.__scopeSelect,onNativeOptionAdd:l.useCallback(_=>{L(Y=>new Set(Y).add(_))},[]),onNativeOptionRemove:l.useCallback(_=>{L(Y=>{const q=new Set(Y);return q.delete(_),q})},[]),children:s})}),K?e.jsxs(ks,{"aria-hidden":!0,required:b,tabIndex:-1,name:g,autoComplete:v,value:y,onChange:_=>$(_.target.value),disabled:p,form:k,children:[y===void 0?e.jsx("option",{value:""}):null,Array.from(le)]},U):null]})})};ts.displayName=De;var ss="SelectTrigger",as=l.forwardRef((a,t)=>{const{__scopeSelect:s,disabled:n=!1,...r}=a,i=nt(s),c=Te(ss,s),o=c.disabled||n,d=ye(t,c.onTriggerChange),h=at(s),g=l.useRef("touch"),[v,p,b]=Is(x=>{const m=h().filter(j=>!j.disabled),f=m.find(j=>j.value===c.value),S=Ts(m,x,f);S!==void 0&&c.onValueChange(S.value)}),k=x=>{o||(c.onOpenChange(!0),b()),x&&(c.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return e.jsx(Xs,{asChild:!0,...i,children:e.jsx(ce.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Cs(c.value)?"":void 0,...r,ref:d,onClick:oe(r.onClick,x=>{x.currentTarget.focus(),g.current!=="mouse"&&k(x)}),onPointerDown:oe(r.onPointerDown,x=>{g.current=x.pointerType;const m=x.target;m.hasPointerCapture(x.pointerId)&&m.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(k(x),x.preventDefault())}),onKeyDown:oe(r.onKeyDown,x=>{const m=v.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&p(x.key),!(m&&x.key===" ")&&hn.includes(x.key)&&(k(),x.preventDefault())})})})});as.displayName=ss;var ns="SelectValue",rs=l.forwardRef((a,t)=>{const{__scopeSelect:s,className:n,style:r,children:i,placeholder:c="",...o}=a,d=Te(ns,s),{onValueNodeHasChildrenChange:h}=d,g=i!==void 0,v=ye(t,d.onValueNodeChange);return Ie(()=>{h(g)},[h,g]),e.jsx(ce.span,{...o,ref:v,style:{pointerEvents:"none"},children:Cs(d.value)?e.jsx(e.Fragment,{children:c}):i})});rs.displayName=ns;var yn="SelectIcon",is=l.forwardRef((a,t)=>{const{__scopeSelect:s,children:n,...r}=a;return e.jsx(ce.span,{"aria-hidden":!0,...r,ref:t,children:n||"▼"})});is.displayName=yn;var vn="SelectPortal",ls=a=>e.jsx(Qs,{asChild:!0,...a});ls.displayName=vn;var Le="SelectContent",os=l.forwardRef((a,t)=>{const s=Te(Le,a.__scopeSelect),[n,r]=l.useState();if(Ie(()=>{r(new DocumentFragment)},[]),!s.open){const i=n;return i?qt.createPortal(e.jsx(cs,{scope:a.__scopeSelect,children:e.jsx(st.Slot,{scope:a.__scopeSelect,children:e.jsx("div",{children:a.children})})}),i):null}return e.jsx(ds,{...a,ref:t})});os.displayName=Le;var ve=10,[cs,_e]=Fe(Le),bn="SelectContentImpl",jn=ea("SelectContent.RemoveScroll"),ds=l.forwardRef((a,t)=>{const{__scopeSelect:s,position:n="item-aligned",onCloseAutoFocus:r,onEscapeKeyDown:i,onPointerDownOutside:c,side:o,sideOffset:d,align:h,alignOffset:g,arrowPadding:v,collisionBoundary:p,collisionPadding:b,sticky:k,hideWhenDetached:x,avoidCollisions:m,...f}=a,S=Te(Le,s),[j,O]=l.useState(null),[H,Z]=l.useState(null),T=ye(t,C=>O(C)),[u,y]=l.useState(null),[$,z]=l.useState(null),K=at(s),[le,L]=l.useState(!1),U=l.useRef(!1);l.useEffect(()=>{if(j)return Ys(j)},[j]),Js();const _=l.useCallback(C=>{const[B,...te]=K().map(P=>P.ref.current),[E]=te.slice(-1),A=document.activeElement;for(const P of C)if(P===A||(P?.scrollIntoView({block:"nearest"}),P===B&&H&&(H.scrollTop=0),P===E&&H&&(H.scrollTop=H.scrollHeight),P?.focus(),document.activeElement!==A))return},[K,H]),Y=l.useCallback(()=>_([u,j]),[_,u,j]);l.useEffect(()=>{le&&Y()},[le,Y]);const{onOpenChange:q,triggerPointerDownPosRef:ne}=S;l.useEffect(()=>{if(j){let C={x:0,y:0};const B=E=>{C={x:Math.abs(Math.round(E.pageX)-(ne.current?.x??0)),y:Math.abs(Math.round(E.pageY)-(ne.current?.y??0))}},te=E=>{C.x<=10&&C.y<=10?E.preventDefault():j.contains(E.target)||q(!1),document.removeEventListener("pointermove",B),ne.current=null};return ne.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",te,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",te,{capture:!0})}}},[j,q,ne]),l.useEffect(()=>{const C=()=>q(!1);return window.addEventListener("blur",C),window.addEventListener("resize",C),()=>{window.removeEventListener("blur",C),window.removeEventListener("resize",C)}},[q]);const[me,re]=Is(C=>{const B=K().filter(A=>!A.disabled),te=B.find(A=>A.ref.current===document.activeElement),E=Ts(B,C,te);E&&setTimeout(()=>E.ref.current.focus())}),Ae=l.useCallback((C,B,te)=>{const E=!U.current&&!te;(S.value!==void 0&&S.value===B||E)&&(y(C),E&&(U.current=!0))},[S.value]),Pe=l.useCallback(()=>j?.focus(),[j]),ge=l.useCallback((C,B,te)=>{const E=!U.current&&!te;(S.value!==void 0&&S.value===B||E)&&z(C)},[S.value]),M=n==="popper"?gt:ms,X=M===gt?{side:o,sideOffset:d,align:h,alignOffset:g,arrowPadding:v,collisionBoundary:p,collisionPadding:b,sticky:k,hideWhenDetached:x,avoidCollisions:m}:{};return e.jsx(cs,{scope:s,content:j,viewport:H,onViewportChange:Z,itemRefCallback:Ae,selectedItem:u,onItemLeave:Pe,itemTextRefCallback:ge,focusSelectedItem:Y,selectedItemText:$,position:n,isPositioned:le,searchRef:me,children:e.jsx(Zs,{as:jn,allowPinchZoom:!0,children:e.jsx(ta,{asChild:!0,trapped:S.open,onMountAutoFocus:C=>{C.preventDefault()},onUnmountAutoFocus:oe(r,C=>{S.trigger?.focus({preventScroll:!0}),C.preventDefault()}),children:e.jsx(sa,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:C=>C.preventDefault(),onDismiss:()=>S.onOpenChange(!1),children:e.jsx(M,{role:"listbox",id:S.contentId,"data-state":S.open?"open":"closed",dir:S.dir,onContextMenu:C=>C.preventDefault(),...f,...X,onPlaced:()=>L(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...f.style},onKeyDown:oe(f.onKeyDown,C=>{const B=C.ctrlKey||C.altKey||C.metaKey;if(C.key==="Tab"&&C.preventDefault(),!B&&C.key.length===1&&re(C.key),["ArrowUp","ArrowDown","Home","End"].includes(C.key)){let E=K().filter(A=>!A.disabled).map(A=>A.ref.current);if(["ArrowUp","End"].includes(C.key)&&(E=E.slice().reverse()),["ArrowUp","ArrowDown"].includes(C.key)){const A=C.target,P=E.indexOf(A);E=E.slice(P+1)}setTimeout(()=>_(E)),C.preventDefault()}})})})})})})});ds.displayName=bn;var wn="SelectItemAlignedPosition",ms=l.forwardRef((a,t)=>{const{__scopeSelect:s,onPlaced:n,...r}=a,i=Te(Le,s),c=_e(Le,s),[o,d]=l.useState(null),[h,g]=l.useState(null),v=ye(t,T=>g(T)),p=at(s),b=l.useRef(!1),k=l.useRef(!0),{viewport:x,selectedItem:m,selectedItemText:f,focusSelectedItem:S}=c,j=l.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&h&&x&&m&&f){const T=i.trigger.getBoundingClientRect(),u=h.getBoundingClientRect(),y=i.valueNode.getBoundingClientRect(),$=f.getBoundingClientRect();if(i.dir!=="rtl"){const A=$.left-u.left,P=y.left-A,G=T.left-P,pe=T.width+G,we=Math.max(pe,u.width),it=window.innerWidth-ve,lt=Dt(P,[ve,Math.max(ve,it-we)]);o.style.minWidth=pe+"px",o.style.left=lt+"px"}else{const A=u.right-$.right,P=window.innerWidth-y.right-A,G=window.innerWidth-T.right-P,pe=T.width+G,we=Math.max(pe,u.width),it=window.innerWidth-ve,lt=Dt(P,[ve,Math.max(ve,it-we)]);o.style.minWidth=pe+"px",o.style.right=lt+"px"}const z=p(),K=window.innerHeight-ve*2,le=x.scrollHeight,L=window.getComputedStyle(h),U=parseInt(L.borderTopWidth,10),_=parseInt(L.paddingTop,10),Y=parseInt(L.borderBottomWidth,10),q=parseInt(L.paddingBottom,10),ne=U+_+le+q+Y,me=Math.min(m.offsetHeight*5,ne),re=window.getComputedStyle(x),Ae=parseInt(re.paddingTop,10),Pe=parseInt(re.paddingBottom,10),ge=T.top+T.height/2-ve,M=K-ge,X=m.offsetHeight/2,C=m.offsetTop+X,B=U+_+C,te=ne-B;if(B<=ge){const A=z.length>0&&m===z[z.length-1].ref.current;o.style.bottom="0px";const P=h.clientHeight-x.offsetTop-x.offsetHeight,G=Math.max(M,X+(A?Pe:0)+P+Y),pe=B+G;o.style.height=pe+"px"}else{const A=z.length>0&&m===z[0].ref.current;o.style.top="0px";const G=Math.max(ge,U+x.offsetTop+(A?Ae:0)+X)+te;o.style.height=G+"px",x.scrollTop=B-ge+x.offsetTop}o.style.margin=`${ve}px 0`,o.style.minHeight=me+"px",o.style.maxHeight=K+"px",n?.(),requestAnimationFrame(()=>b.current=!0)}},[p,i.trigger,i.valueNode,o,h,x,m,f,i.dir,n]);Ie(()=>j(),[j]);const[O,H]=l.useState();Ie(()=>{h&&H(window.getComputedStyle(h).zIndex)},[h]);const Z=l.useCallback(T=>{T&&k.current===!0&&(j(),S?.(),k.current=!1)},[j,S]);return e.jsx(Sn,{scope:s,contentWrapper:o,shouldExpandOnScrollRef:b,onScrollButtonChange:Z,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:O},children:e.jsx(ce.div,{...r,ref:v,style:{boxSizing:"border-box",maxHeight:"100%",...r.style}})})})});ms.displayName=wn;var Nn="SelectPopperPosition",gt=l.forwardRef((a,t)=>{const{__scopeSelect:s,align:n="start",collisionPadding:r=ve,...i}=a,c=nt(s);return e.jsx(aa,{...c,...i,ref:t,align:n,collisionPadding:r,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});gt.displayName=Nn;var[Sn,St]=Fe(Le,{}),pt="SelectViewport",hs=l.forwardRef((a,t)=>{const{__scopeSelect:s,nonce:n,...r}=a,i=_e(pt,s),c=St(pt,s),o=ye(t,i.onViewportChange),d=l.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(st.Slot,{scope:s,children:e.jsx(ce.div,{"data-radix-select-viewport":"",role:"presentation",...r,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...r.style},onScroll:oe(r.onScroll,h=>{const g=h.currentTarget,{contentWrapper:v,shouldExpandOnScrollRef:p}=c;if(p?.current&&v){const b=Math.abs(d.current-g.scrollTop);if(b>0){const k=window.innerHeight-ve*2,x=parseFloat(v.style.minHeight),m=parseFloat(v.style.height),f=Math.max(x,m);if(f<k){const S=f+b,j=Math.min(k,S),O=S-j;v.style.height=j+"px",v.style.bottom==="0px"&&(g.scrollTop=O>0?O:0,v.style.justifyContent="flex-end")}}}d.current=g.scrollTop})})})]})});hs.displayName=pt;var xs="SelectGroup",[kn,Cn]=Fe(xs),In=l.forwardRef((a,t)=>{const{__scopeSelect:s,...n}=a,r=jt();return e.jsx(kn,{scope:s,id:r,children:e.jsx(ce.div,{role:"group","aria-labelledby":r,...n,ref:t})})});In.displayName=xs;var us="SelectLabel",gs=l.forwardRef((a,t)=>{const{__scopeSelect:s,...n}=a,r=Cn(us,s);return e.jsx(ce.div,{id:r.id,...n,ref:t})});gs.displayName=us;var tt="SelectItem",[Tn,ps]=Fe(tt),fs=l.forwardRef((a,t)=>{const{__scopeSelect:s,value:n,disabled:r=!1,textValue:i,...c}=a,o=Te(tt,s),d=_e(tt,s),h=o.value===n,[g,v]=l.useState(i??""),[p,b]=l.useState(!1),k=ye(t,S=>d.itemRefCallback?.(S,n,r)),x=jt(),m=l.useRef("touch"),f=()=>{r||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(Tn,{scope:s,value:n,disabled:r,textId:x,isSelected:h,onItemTextChange:l.useCallback(S=>{v(j=>j||(S?.textContent??"").trim())},[]),children:e.jsx(st.ItemSlot,{scope:s,value:n,disabled:r,textValue:g,children:e.jsx(ce.div,{role:"option","aria-labelledby":x,"data-highlighted":p?"":void 0,"aria-selected":h&&p,"data-state":h?"checked":"unchecked","aria-disabled":r||void 0,"data-disabled":r?"":void 0,tabIndex:r?void 0:-1,...c,ref:k,onFocus:oe(c.onFocus,()=>b(!0)),onBlur:oe(c.onBlur,()=>b(!1)),onClick:oe(c.onClick,()=>{m.current!=="mouse"&&f()}),onPointerUp:oe(c.onPointerUp,()=>{m.current==="mouse"&&f()}),onPointerDown:oe(c.onPointerDown,S=>{m.current=S.pointerType}),onPointerMove:oe(c.onPointerMove,S=>{m.current=S.pointerType,r?d.onItemLeave?.():m.current==="mouse"&&S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:oe(c.onPointerLeave,S=>{S.currentTarget===document.activeElement&&d.onItemLeave?.()}),onKeyDown:oe(c.onKeyDown,S=>{d.searchRef?.current!==""&&S.key===" "||(xn.includes(S.key)&&f(),S.key===" "&&S.preventDefault())})})})})});fs.displayName=tt;var We="SelectItemText",ys=l.forwardRef((a,t)=>{const{__scopeSelect:s,className:n,style:r,...i}=a,c=Te(We,s),o=_e(We,s),d=ps(We,s),h=fn(We,s),[g,v]=l.useState(null),p=ye(t,f=>v(f),d.onItemTextChange,f=>o.itemTextRefCallback?.(f,d.value,d.disabled)),b=g?.textContent,k=l.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:b},d.value),[d.disabled,d.value,b]),{onNativeOptionAdd:x,onNativeOptionRemove:m}=h;return Ie(()=>(x(k),()=>m(k)),[x,m,k]),e.jsxs(e.Fragment,{children:[e.jsx(ce.span,{id:d.textId,...i,ref:p}),d.isSelected&&c.valueNode&&!c.valueNodeHasChildren?qt.createPortal(i.children,c.valueNode):null]})});ys.displayName=We;var vs="SelectItemIndicator",bs=l.forwardRef((a,t)=>{const{__scopeSelect:s,...n}=a;return ps(vs,s).isSelected?e.jsx(ce.span,{"aria-hidden":!0,...n,ref:t}):null});bs.displayName=vs;var ft="SelectScrollUpButton",js=l.forwardRef((a,t)=>{const s=_e(ft,a.__scopeSelect),n=St(ft,a.__scopeSelect),[r,i]=l.useState(!1),c=ye(t,n.onScrollButtonChange);return Ie(()=>{if(s.viewport&&s.isPositioned){let o=function(){const h=d.scrollTop>0;i(h)};const d=s.viewport;return o(),d.addEventListener("scroll",o),()=>d.removeEventListener("scroll",o)}},[s.viewport,s.isPositioned]),r?e.jsx(Ns,{...a,ref:c,onAutoScroll:()=>{const{viewport:o,selectedItem:d}=s;o&&d&&(o.scrollTop=o.scrollTop-d.offsetHeight)}}):null});js.displayName=ft;var yt="SelectScrollDownButton",ws=l.forwardRef((a,t)=>{const s=_e(yt,a.__scopeSelect),n=St(yt,a.__scopeSelect),[r,i]=l.useState(!1),c=ye(t,n.onScrollButtonChange);return Ie(()=>{if(s.viewport&&s.isPositioned){let o=function(){const h=d.scrollHeight-d.clientHeight,g=Math.ceil(d.scrollTop)<h;i(g)};const d=s.viewport;return o(),d.addEventListener("scroll",o),()=>d.removeEventListener("scroll",o)}},[s.viewport,s.isPositioned]),r?e.jsx(Ns,{...a,ref:c,onAutoScroll:()=>{const{viewport:o,selectedItem:d}=s;o&&d&&(o.scrollTop=o.scrollTop+d.offsetHeight)}}):null});ws.displayName=yt;var Ns=l.forwardRef((a,t)=>{const{__scopeSelect:s,onAutoScroll:n,...r}=a,i=_e("SelectScrollButton",s),c=l.useRef(null),o=at(s),d=l.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return l.useEffect(()=>()=>d(),[d]),Ie(()=>{o().find(g=>g.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[o]),e.jsx(ce.div,{"aria-hidden":!0,...r,ref:t,style:{flexShrink:0,...r.style},onPointerDown:oe(r.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(n,50))}),onPointerMove:oe(r.onPointerMove,()=>{i.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(n,50))}),onPointerLeave:oe(r.onPointerLeave,()=>{d()})})}),_n="SelectSeparator",Ss=l.forwardRef((a,t)=>{const{__scopeSelect:s,...n}=a;return e.jsx(ce.div,{"aria-hidden":!0,...n,ref:t})});Ss.displayName=_n;var vt="SelectArrow",An=l.forwardRef((a,t)=>{const{__scopeSelect:s,...n}=a,r=nt(s),i=Te(vt,s),c=_e(vt,s);return i.open&&c.position==="popper"?e.jsx(ia,{...r,...n,ref:t}):null});An.displayName=vt;var Pn="SelectBubbleInput",ks=l.forwardRef(({__scopeSelect:a,value:t,...s},n)=>{const r=l.useRef(null),i=ye(n,r),c=Zt(t);return l.useEffect(()=>{const o=r.current;if(!o)return;const d=window.HTMLSelectElement.prototype,g=Object.getOwnPropertyDescriptor(d,"value").set;if(c!==t&&g){const v=new Event("change",{bubbles:!0});g.call(o,t),o.dispatchEvent(v)}},[c,t]),e.jsx(ce.select,{...s,style:{...es,...s.style},ref:i,defaultValue:t})});ks.displayName=Pn;function Cs(a){return a===""||a===void 0}function Is(a){const t=Ks(a),s=l.useRef(""),n=l.useRef(0),r=l.useCallback(c=>{const o=s.current+c;t(o),(function d(h){s.current=h,window.clearTimeout(n.current),h!==""&&(n.current=window.setTimeout(()=>d(""),1e3))})(o)},[t]),i=l.useCallback(()=>{s.current="",window.clearTimeout(n.current)},[]);return l.useEffect(()=>()=>window.clearTimeout(n.current),[]),[s,r,i]}function Ts(a,t,s){const r=t.length>1&&Array.from(t).every(h=>h===t[0])?t[0]:t,i=s?a.indexOf(s):-1;let c=En(a,Math.max(i,0));r.length===1&&(c=c.filter(h=>h!==s));const d=c.find(h=>h.textValue.toLowerCase().startsWith(r.toLowerCase()));return d!==s?d:void 0}function En(a,t){return a.map((s,n)=>a[(t+n)%a.length])}var Rn=ts,_s=as,Dn=rs,Ln=is,Mn=ls,As=os,On=hs,Ps=gs,Es=fs,Hn=ys,$n=bs,Rs=js,Ds=ws,Ls=Ss;const Ee=Rn,Re=Dn,ke=l.forwardRef(({className:a,children:t,...s},n)=>e.jsxs(_s,{ref:n,className:J("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[t,e.jsx(Ln,{asChild:!0,children:e.jsx(Ft,{className:"h-4 w-4 opacity-50"})})]}));ke.displayName=_s.displayName;const Ms=l.forwardRef(({className:a,...t},s)=>e.jsx(Rs,{ref:s,className:J("flex cursor-default items-center justify-center py-1",a),...t,children:e.jsx(ca,{className:"h-4 w-4"})}));Ms.displayName=Rs.displayName;const Os=l.forwardRef(({className:a,...t},s)=>e.jsx(Ds,{ref:s,className:J("flex cursor-default items-center justify-center py-1",a),...t,children:e.jsx(Ft,{className:"h-4 w-4"})}));Os.displayName=Ds.displayName;const Ce=l.forwardRef(({className:a,children:t,position:s="popper",...n},r)=>e.jsx(Mn,{children:e.jsxs(As,{ref:r,className:J("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...n,children:[e.jsx(Ms,{}),e.jsx(On,{className:J("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Os,{})]})}));Ce.displayName=As.displayName;const qn=l.forwardRef(({className:a,...t},s)=>e.jsx(Ps,{ref:s,className:J("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...t}));qn.displayName=Ps.displayName;const F=l.forwardRef(({className:a,children:t,...s},n)=>e.jsxs(Es,{ref:n,className:J("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx($n,{children:e.jsx(da,{className:"h-4 w-4"})})}),e.jsx(Hn,{children:t})]}));F.displayName=Es.displayName;const zn=l.forwardRef(({className:a,...t},s)=>e.jsx(Ls,{ref:s,className:J("-mx-1 my-1 h-px bg-muted",a),...t}));zn.displayName=Ls.displayName;const Fn=({onClose:a})=>{const[t,s]=l.useState({userLevel:"",learningMode:"",feedback:"",rating:"",suggestions:""}),n=async r=>{r.preventDefault();const i=new FormData;i.append("form-name","learning-feedback"),Object.entries(t).forEach(([c,o])=>{i.append(c,o)});try{await fetch("/",{method:"POST",body:i}),alert("フィードバックを送信しました！ありがとうございます。"),a()}catch(c){console.error("Error submitting feedback:",c),alert("送信に失敗しました。もう一度お試しください。")}};return e.jsxs(N,{className:"w-full max-w-md",children:[e.jsx(R,{children:e.jsx(W,{children:"学習フィードバック"})}),e.jsx(I,{children:e.jsxs("form",{name:"learning-feedback",onSubmit:n,children:[e.jsx("input",{type:"hidden",name:"form-name",value:"learning-feedback"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"userLevel",children:"現在のレベル"}),e.jsxs(Ee,{value:t.userLevel,onValueChange:r=>s(i=>({...i,userLevel:r})),children:[e.jsx(ke,{children:e.jsx(Re,{placeholder:"レベルを選択"})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"beginner",children:"初級"}),e.jsx(F,{value:"intermediate",children:"中級"}),e.jsx(F,{value:"advanced",children:"上級"})]})]})]}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"learningMode",children:"お気に入りの学習モード"}),e.jsxs(Ee,{value:t.learningMode,onValueChange:r=>s(i=>({...i,learningMode:r})),children:[e.jsx(ke,{children:e.jsx(Re,{placeholder:"学習モードを選択"})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"vocabulary",children:"語彙学習"}),e.jsx(F,{value:"grammar",children:"文法クイズ"}),e.jsx(F,{value:"combined",children:"総合テスト"}),e.jsx(F,{value:"time-attack",children:"タイムアタック"}),e.jsx(F,{value:"tower-defense",children:"タワーディフェンス"})]})]})]}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"rating",children:"満足度"}),e.jsxs(Ee,{value:t.rating,onValueChange:r=>s(i=>({...i,rating:r})),children:[e.jsx(ke,{children:e.jsx(Re,{placeholder:"満足度を選択"})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"5",children:"とても満足"}),e.jsx(F,{value:"4",children:"満足"}),e.jsx(F,{value:"3",children:"普通"}),e.jsx(F,{value:"2",children:"不満"}),e.jsx(F,{value:"1",children:"とても不満"})]})]})]}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"feedback",children:"学習体験のフィードバック"}),e.jsx(Xe,{id:"feedback",placeholder:"学習体験について教えてください...",value:t.feedback,onChange:r=>s(i=>({...i,feedback:r.target.value})),rows:4})]}),e.jsxs("div",{children:[e.jsx(fe,{htmlFor:"suggestions",children:"改善提案"}),e.jsx(Xe,{id:"suggestions",placeholder:"改善してほしい点や追加してほしい機能があれば教えてください...",value:t.suggestions,onChange:r=>s(i=>({...i,suggestions:r.target.value})),rows:3})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{type:"submit",className:"flex-1",children:"送信"}),e.jsx(w,{type:"button",variant:"outline",onClick:a,children:"キャンセル"})]})]})]})})]})},Bn=({showDetailed:a=!0,showChapterProgress:t=!0,compact:s=!1})=>{const[n,r]=l.useState(()=>V().getLevel()),[i,c]=l.useState(()=>V().getChapterProgress());l.useEffect(()=>{const h=V(),g=h.getLevel(),v=h.getChapterProgress();r(g),c(v)},[]);const o=h=>({1:"bg-green-500",2:"bg-blue-500",3:"bg-purple-500",4:"bg-orange-500",5:"bg-red-500"})[h],d=h=>({1:"from-green-400 to-green-600",2:"from-blue-400 to-blue-600",3:"from-purple-400 to-purple-600",4:"from-orange-400 to-orange-600",5:"from-red-400 to-red-600"})[h];return s?e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${o(n.chapter)} text-foreground flex items-center justify-center text-sm font-bold`,children:n.chapter}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Level ",n.level]}),e.jsx("div",{className:"text-xs text-gray-500",children:Ne[n.chapter].name})]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Level ",n.level]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",n.xp-(n.level-1)*50,"/50 XP)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full bg-gradient-to-r ${d(n.chapter)}`,style:{width:`${(n.xp-(n.level-1)*50)/50*100}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["次レベルまで: ",50-(n.xp-(n.level-1)*50),"XP"]})]})})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"レベル情報"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-full ${o(n.chapter)} text-foreground flex items-center justify-center text-lg font-bold`,children:n.chapter}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:"章"}),e.jsx("div",{className:"text-xs text-gray-400",children:Ne[n.chapter].name})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-lg font-medium text-gray-700",children:["Level ",n.level]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[n.xp," XP"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full bg-gradient-to-r ${d(n.chapter)} transition-all duration-500`,style:{width:`${n.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["進捗: ",n.progress.toFixed(1),"%"]}),e.jsxs("span",{children:["次のレベルまで: ",n.xpToNext," XP"]})]})]}),t&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[Ne[n.chapter].name,"の進捗"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[i.progress.toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full bg-gradient-to-r ${d(n.chapter)} transition-all duration-500`,style:{width:`${i.progress}%`}})}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Ne[n.chapter].description})]}),a&&e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"章"}),e.jsx("div",{className:"font-medium",children:Ne[n.chapter].name})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"レベル範囲"}),e.jsx("div",{className:"font-medium",children:Ne[n.chapter].levelRange})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"必要XP/レベル"}),e.jsxs("div",{className:"font-medium",children:[Ne[n.chapter].xpPerLevel," XP"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"最大ハート数"}),e.jsxs("div",{className:"font-medium",children:[Ne[n.chapter].maxHearts,"個"]})]})]}),e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{const h=V(),g=h.addXP(100);r(h.getLevel()),de(),g.leveledUp&&alert(`レベルアップ！ Level ${g.newLevel?.level} に上がりました！`)},className:"px-3 py-1 rounded-md text-xs font-medium bg-blue-500 text-foreground hover:bg-blue-600 transition-colors",title:"テスト用: 100XP追加",children:"+100XP"}),e.jsx("button",{onClick:()=>{const h=V(),g=h.addXP(500);r(h.getLevel()),de(),g.leveledUp&&alert(`レベルアップ！ Level ${g.newLevel?.level} に上がりました！`)},className:"px-3 py-1 rounded-md text-xs font-medium bg-purple-500 text-foreground hover:bg-purple-600 transition-colors",title:"テスト用: 500XP追加",children:"+500XP"}),e.jsx("button",{onClick:()=>{const h=V();h.addXP(1e3),r(h.getLevel()),de(),alert("1000XP追加しました！")},className:"px-3 py-1 rounded-md text-xs font-medium bg-orange-500 text-foreground hover:bg-orange-600 transition-colors",title:"テスト用: 1000XP追加",children:"+1000XP"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"※ テスト用ボタンです"})]})]})]})]})},Wn=Xt("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Vn({className:a,variant:t,...s}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:Nt(Wn({variant:t}),a),...s})}function Gn({className:a,...t}){return e.jsx("div",{"data-slot":"alert-description",className:Nt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...t})}var Un="Separator",Lt="horizontal",Xn=["horizontal","vertical"],Hs=l.forwardRef((a,t)=>{const{decorative:s,orientation:n=Lt,...r}=a,i=Qn(n)?n:Lt,o=s?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(ce.div,{"data-orientation":i,...o,...r,ref:t})});Hs.displayName=Un;function Qn(a){return Xn.includes(a)}var Kn=Hs;function bt({className:a,orientation:t="horizontal",decorative:s=!0,...n}){return e.jsx(Kn,{"data-slot":"separator-root",decorative:s,orientation:t,className:Nt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...n})}const Yn=({onAllocationChange:a,readOnly:t=!1})=>{const[s,n]=l.useState(()=>{try{return V().getStatusAllocation()}catch(m){return console.error("Failed to get status allocation:",m),{listening:5,reading:5,writing:5,grammar:5,idioms:5,vocabulary:5}}}),[r,i]=l.useState(!0),[c,o]=l.useState("");l.useEffect(()=>{const m=ma(s);i(m),a?.(s)},[s]);const d=(m,f)=>{const S={...s,[m]:Math.max(0,Math.min(30,f))};n(S)},h=m=>{const f=ot[m];n({...f}),o(m)},g=()=>{n({...ot.balanced}),o("balanced")},v=()=>Object.values(s).reduce((m,f)=>m+f,0),p=()=>30-v(),b=m=>s[m]/30*100,k=["listening","reading","writing","grammar","idioms","vocabulary"],x={balanced:"バランス型",vocabulary:"語彙重視型",practical:"実践重視型",grammar:"文法強化型"};return t?e.jsxs(N,{className:"shadow-md",children:[e.jsx(R,{children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(ht,{className:"w-5 h-5"}),"現在のステータス配分"]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:k.map(m=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:Be[m].icon}),e.jsx("span",{className:"text-sm font-medium",children:Be[m].name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{value:b(m),className:"w-24 h-2"}),e.jsxs(D,{variant:"outline",className:"text-xs font-mono w-12 justify-center",children:[s[m],"pt"]})]})]},m))}),e.jsx(bt,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"合計ポイント"}),e.jsxs(D,{variant:"secondary",className:"font-mono",children:[v(),"/30pt"]})]})]})]}):e.jsxs(N,{className:"shadow-md",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(ht,{className:"w-5 h-5"}),"ステータス配分"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"残りポイント"}),e.jsx(D,{variant:p()<0?"destructive":"secondary",className:"font-mono",children:p()})]})]})}),e.jsxs(I,{className:"space-y-6",children:[!r&&e.jsxs(Vn,{variant:"destructive",children:[e.jsx(ha,{className:"h-4 w-4"}),e.jsx(Gn,{children:"合計が30ポイントになるように調整してください。"})]}),e.jsx("div",{className:"space-y-4",children:k.map(m=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:Be[m].icon}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:Be[m].name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:Be[m].description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{type:"number",min:"0",max:"30",value:s[m],onChange:f=>d(m,parseInt(f.target.value)||0),className:"w-16 text-center text-sm"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"pt"})]})]}),e.jsx(be,{value:b(m),className:"h-2"})]},m))}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"合計ポイント"}),e.jsxs(D,{variant:v()===30?"default":"destructive",className:"font-mono",children:[v(),"/30pt"]})]}),e.jsx(bt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"テンプレート"}),e.jsxs(w,{onClick:g,variant:"ghost",size:"sm",className:"text-xs h-auto p-1",children:[e.jsx(Ye,{className:"w-3 h-3 mr-1"}),"リセット"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(ot).map(([m,f])=>e.jsx(w,{onClick:()=>h(m),variant:c===m?"default":"outline",size:"sm",className:"text-xs",children:x[m]},m))})]}),e.jsx(w,{onClick:()=>{V().updateStatusAllocation(s),de()},disabled:!r,className:"w-full",size:"lg",children:"配分を保存"})]})]})]})};function ie({id:a,title:t,description:s,detail:n,icon:r,difficulty:i,level:c,color:o="bg-white border-gray-200",isLocked:d=!1,isCompleted:h=!1,isRecommended:g=!1,duration:v,category:p,keyPoints:b,onClick:k}){const x=f=>{switch(f){case"初級":case"beginner":return"bg-green-100 text-green-800 border-green-200";case"初〜中級":case"intermediate":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"中級":return"bg-orange-100 text-orange-800 border-orange-200";case"上級":case"advanced":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},m=J("cursor-pointer transition-all duration-200 border-2 hover:shadow-lg active:scale-[0.98]",d&&"cursor-not-allowed opacity-60",h&&"border-green-300 bg-green-50",g&&"ring-2 ring-blue-400 ring-opacity-50",!d&&!h&&o,d&&"bg-gray-50 border-gray-200");return e.jsxs(N,{className:m,onClick:()=>!d&&k(a),children:[e.jsxs(R,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("span",{className:"text-lg",children:r}),e.jsx(W,{className:"text-lg",children:t}),h&&e.jsx("span",{className:"text-green-600",children:"✓"}),d&&e.jsx("span",{className:"text-gray-400",children:"🔒"})]}),e.jsxs("div",{className:"flex gap-2",children:[i&&e.jsx(D,{variant:"outline",className:J("text-xs",x(i)),children:i}),c&&e.jsxs(D,{variant:"outline",className:"text-xs",children:["Level ",c]})]})]}),e.jsx(Je,{className:d?"text-gray-400":"",children:s})]}),e.jsxs(I,{className:"space-y-3",children:[n&&e.jsx("p",{className:J("text-sm",d?"text-gray-400":"text-gray-600"),children:n}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[v&&e.jsxs("span",{className:"flex items-center gap-1",children:["⏱️ ",v]}),p&&e.jsx("span",{className:"capitalize",children:p})]}),b&&b.length>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("div",{className:"font-medium mb-1",children:"重要ポイント:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:b.slice(0,2).map((f,S)=>e.jsx("li",{className:"truncate",children:f},S))})]}),g&&e.jsx("div",{className:"flex items-center gap-1 text-sm font-medium text-blue-600",children:"🎯 推奨コンテンツ"})]})]})}function Jn(){const a=ae(),{userLevel:t,refreshLevel:s}=Qa(),{heartSystem:n,processRecovery:r,refreshHearts:i}=Xa(),c=()=>{i()},[o,d]=l.useState(xe.getUserStats()),[h,g]=l.useState(!1),[v,p]=l.useState(!1),[b,k]=l.useState(!1),[x,m]=l.useState(!1),[f,S]=l.useState(!1),[j,O]=l.useState(""),[H,Z]=l.useState("beginner"),[T,u]=l.useState(!1),[y,$]=l.useState(!1),[z,K]=l.useState(()=>{const A=xe.getUserStats();return A.stars?{current:Ze(A.stars),max:A.stars.max,lastRecoveryTime:A.stars.lastRecoveryTime}:en(t.level)}),[le,L]=l.useState(()=>xe.getUserStats().preStudyProgress||{totalContentsStudied:0,contentsByCategory:{},averageComprehension:0,totalTimeSpent:0,completedContents:[]}),[U,_]=l.useState(()=>xe.getUserStats().preStudySessions||[]),[Y,q]=l.useState(!1),[ne,me]=l.useState(null);l.useEffect(()=>{(()=>{const G=xe.getUserStats();d(G),s(),G.stars&&K({current:Ze(G.stars),max:G.stars.max,lastRecoveryTime:G.stars.lastRecoveryTime}),G.preStudyProgress&&L(G.preStudyProgress),G.preStudySessions&&_(G.preStudySessions)})();const P=setInterval(()=>{r();const G=xe.getUserStats();if(G.stars){const pe=Ze(G.stars);if(pe>G.stars.current){const we={...G,stars:{...G.stars,current:pe,lastRecoveryTime:Date.now()}};xe.saveUserStats(we),K(we.stars)}}},6e4);return()=>clearInterval(P)},[]);const re=A=>{switch(A){case"grammar":a("/learning/grammar/category");break;case"vocabulary":a("/learning/vocabulary/difficulty");break;case"writing":a("/learning/grammar/category");break;case"combined":a("/learning/combined-test");break;case"timeattack":a("/learning/time-attack");break}},Ae=A=>{O(A),k(!1),m(!0)},Pe=A=>{Z(A),m(!1),S(!0)},ge=()=>{S(!1),m(!1),k(!1)},M=()=>{m(!1),k(!0)},X=()=>{k(!1)},C=n.current>0,B=()=>{a("/learning/pre-study/menu")},te=()=>{a("/progress/dashboard")},E=()=>{$(!1)};return l.useEffect(()=>{const A=setInterval(()=>{c()},1e3);return()=>clearInterval(A)},[]),y?e.jsx(GrowthDashboard,{userStats:o,onBack:E}):b?e.jsx(nn,{onSelectCategory:Ae,onBack:X}):x?e.jsx(rn,{categoryName:j,onSelectDifficulty:Pe,onBack:M}):f?e.jsx(EnhancedGrammarQuiz,{category:j,difficulty:H,onBack:ge}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-2",children:"ENTP英語学習アプリ"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"あなたの英語学習をサポートします"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>g(!h),className:"flex items-center gap-2",children:[e.jsx(Bt,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:h?"統計を隠す":"統計を表示"}),e.jsx("span",{className:"sm:hidden",children:"統計"})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>a("/progress/insights"),className:"flex items-center gap-2 bg-gradient-to-r from-purple-50 to-blue-50 border-purple-200 hover:from-purple-100 hover:to-blue-100",children:[e.jsx(Ue,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"hidden sm:inline text-purple-700",children:"学習分析"}),e.jsx("span",{className:"sm:hidden text-purple-700",children:"分析"})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>p(!v),className:"flex items-center gap-2",children:[e.jsx(ht,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"ステータス設定"}),e.jsx("span",{className:"sm:hidden",children:"設定"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Bn,{showDetailed:h,showChapterProgress:h})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"体力システム"}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"体力"}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:n.max},(A,P)=>e.jsx("span",{className:`text-2xl ${P<n.current?"text-red-500":"text-gray-300"}`,children:P<n.current?"♥":"♡"},P))}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["(",n.current,"/",n.max,")"]})]})}),e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"スタミナ"}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:z.max},(A,P)=>e.jsx("span",{className:`text-2xl ${P<z.current?"text-yellow-500":"text-gray-300"}`,children:P<z.current?"⭐️":"☆"},P))}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["(",z.current,"/",z.max,")"]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"1問題につき1体力消費"}),e.jsx("p",{className:"text-xs text-gray-500",children:"5分で1体力回復"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{V().consumeHeart(),c(),de()},className:"px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded",disabled:n.current===0,children:"体力を消費"}),e.jsx("button",{onClick:()=>{const P=V().getHeartSystem();P.current=P.max,c(),de()},className:"px-2 py-1 text-xs bg-green-100 hover:bg-green-200 text-green-700 rounded",children:"♥回復"})]})]})]})})]}),e.jsx("div",{className:"mb-6",children:e.jsx(ln,{})}),v&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsx(Yn,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(ie,{id:"pre-study",title:"事前学習",description:"理論を理解してから実践へ",icon:"⭐️",difficulty:"理論",detail:"必要スター: 1 ⭐️",color:"bg-purple-50 border-purple-200 text-purple-800",isLocked:!Et(z),onClick:()=>Et(z)&&B()}),e.jsx(ie,{id:"grammar-quiz",title:"文法クイズ",description:"9つのカテゴリーから文法問題に挑戦",icon:"✏️",difficulty:"文法",detail:"必要体力: 1 ♥",color:"bg-blue-50 border-blue-200 text-blue-800",isLocked:!C,onClick:()=>C&&re("grammar")}),e.jsx(ie,{id:"vocabulary",title:"語彙学習",description:"レベル別・カテゴリー別の単語学習",icon:"📚",difficulty:"語彙",detail:"必要体力: 1 ♥",color:"bg-green-50 border-green-200 text-green-800",isLocked:!C,onClick:()=>C&&re("vocabulary")}),e.jsx(ie,{id:"combined-test",title:"総合テスト",description:"全分野から出題される総合テスト",icon:"🎯",difficulty:"総合",detail:"必要体力: 1 ♥",color:"bg-purple-50 border-purple-200 text-purple-800",isLocked:!C,onClick:()=>C&&re("combined")}),e.jsx(ie,{id:"time-attack",title:"タイムアタック",description:"制限時間内で問題を解くスピード重視モード",icon:"⏰",difficulty:"スピード",detail:"必要体力: 1 ♥",color:"bg-orange-50 border-orange-200 text-orange-800",isLocked:!C,onClick:()=>C&&re("timeattack")}),e.jsx(ie,{id:"essay",title:"英作文",description:"文法・語彙を実践で活用する英作文課題",icon:"✍️",difficulty:"ライティング",detail:"必要体力: 1 ♥",color:"bg-indigo-50 border-indigo-200 text-indigo-800",isLocked:!C,onClick:()=>{C&&(V().consumeHeart()?a("/learning/essay-writing"):alert("体力が不足しています。"))}}),e.jsx(ie,{id:"tower-defense",title:"タワーディフェンス",description:"🚧 機能改善中です（近日公開予定）",icon:"🎮",difficulty:"準備中",detail:"機能改善中",color:"bg-gray-50 border-gray-200 text-gray-500",isLocked:!0,onClick:()=>{}}),e.jsx(ie,{id:"gacha",title:"TOEIC単語ガチャ",description:"新しい単語をゲット！レアカードを集めよう",icon:"🎁",difficulty:"ガチャ",detail:"XP消費",color:"bg-purple-50 border-purple-200 text-purple-800",onClick:()=>a("/games/gacha")}),e.jsx(ie,{id:"achievements",title:"実績",description:"学習の進捗とアチーブメントを確認",icon:"🏆",difficulty:"進捗",detail:"体力不要",color:"bg-yellow-50 border-yellow-200 text-yellow-800",onClick:()=>a("/progress/achievements")}),e.jsx(ie,{id:"growth-dashboard",title:"成長ダッシュボード",description:"あなたの学習成長を可視化",icon:"📈",difficulty:"分析",detail:"体力不要",color:"bg-green-50 border-green-200 text-green-800",onClick:()=>te()})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs(w,{variant:"outline",onClick:()=>u(!0),className:"flex items-center space-x-2",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"学習フィードバック"})]})}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(N,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"今日のXP"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o.todayXP||0})]}),e.jsx(et,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(N,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"総学習時間"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[Math.floor((o.totalStudyTime||0)/60),"分"]})]}),e.jsx($e,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(N,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"正解率"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[o.totalQuestionsAnswered>0?(o.correctAnswers/o.totalQuestionsAnswered*100).toFixed(1):"0.0","%"]})]}),e.jsx(je,{className:"w-8 h-8 text-purple-600"})]})})}),e.jsx(N,{children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"連続学習日数"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[o.currentStreak||0,"日"]})]}),e.jsx(Wt,{className:"w-8 h-8 text-orange-600"})]})})})]}),!C&&e.jsx(N,{className:"border-yellow-200 bg-yellow-50",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xt,{className:"w-5 h-5 text-yellow-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-800",children:"体力が不足しています"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"体力が回復するまで待つか、他の機能を利用してください。"})]})]})})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsx(Fn,{onClose:()=>u(!1)})})})]})})}function Zn(){const{pathname:a}=qa();return l.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},[a]),null}class Oe{static instance;settings;reminderTimeoutId=null;constructor(){this.settings=this.loadSettings()}static getInstance(){return Oe.instance||(Oe.instance=new Oe),Oe.instance}isSupported(){return"Notification"in window&&"serviceWorker"in navigator}getPermissionStatus(){return Notification.permission}async requestPermission(){if(!this.isSupported())throw new Error("Notifications are not supported in this browser");const t=await Notification.requestPermission();return console.log("Notification permission:",t),t}async showNotification(t){if(!this.isSupported())throw new Error("Notifications are not supported");if(Notification.permission!=="granted")throw new Error("Notification permission not granted");"serviceWorker"in navigator?await(await navigator.serviceWorker.ready).showNotification(t.title,{body:t.body,icon:t.icon||"/pwa-192x192.png",badge:t.badge||"/pwa-192x192.png",tag:t.tag||"default",requireInteraction:t.requireInteraction||!1,actions:t.actions||[]}):new Notification(t.title,{body:t.body,icon:t.icon||"/pwa-192x192.png",tag:t.tag||"default"})}scheduleDailyReminder(){if(this.clearDailyReminder(),!this.settings.dailyReminder||!this.settings.enabled)return;const[t,s]=this.settings.reminderTime.split(":").map(Number),n=new Date,r=new Date;r.setHours(t,s,0,0),r<=n&&r.setDate(r.getDate()+1);const i=r.getTime()-n.getTime();this.reminderTimeoutId=setTimeout(()=>{this.showNotification({title:"ENTP英語学習アプリ",body:"学習の時間です！今日も頑張りましょう 🎯",tag:"daily-reminder"}),this.scheduleDailyReminder()},i),console.log("Daily reminder scheduled for:",r)}clearDailyReminder(){this.reminderTimeoutId&&(clearTimeout(this.reminderTimeoutId),this.reminderTimeoutId=null)}async showStreakReminder(t){!this.settings.streakReminder||!this.settings.enabled||await this.showNotification({title:"連続学習記録更新！",body:`${t}日連続学習中です！この調子で頑張りましょう 🔥`,tag:"streak-reminder"})}async showAchievementNotification(t){!this.settings.achievementReminder||!this.settings.enabled||await this.showNotification({title:"実績解除！",body:`「${t}」を獲得しました！🎉`,tag:"achievement-notification"})}async showLearningReminder(){await this.showNotification({title:"学習リマインダー",body:"今日の学習はまだですか？少しでも進めましょう 📚",tag:"learning-reminder"})}updateSettings(t){this.settings={...this.settings,...t},this.saveSettings(),(t.dailyReminder!==void 0||t.reminderTime!==void 0||t.enabled!==void 0)&&this.scheduleDailyReminder()}getSettings(){return{...this.settings}}loadSettings(){const t={enabled:!1,dailyReminder:!1,reminderTime:"19:00",streakReminder:!0,achievementReminder:!0};try{const s=localStorage.getItem("notification-settings");if(s)return{...t,...JSON.parse(s)}}catch(s){console.error("Error loading notification settings:",s)}return t}saveSettings(){try{localStorage.setItem("notification-settings",JSON.stringify(this.settings))}catch(t){console.error("Error saving notification settings:",t)}}async testNotification(){await this.showNotification({title:"テスト通知",body:"プッシュ通知が正常に動作しています！",tag:"test-notification"})}}const Se=Oe.getInstance(),Kr=Object.freeze(Object.defineProperty({__proto__:null,notificationManager:Se},Symbol.toStringTag,{value:"Module"}));var rt="Switch",[er]=$t(rt),[tr,sr]=er(rt),$s=l.forwardRef((a,t)=>{const{__scopeSwitch:s,name:n,checked:r,defaultChecked:i,required:c,disabled:o,value:d="on",onCheckedChange:h,form:g,...v}=a,[p,b]=l.useState(null),k=ye(t,j=>b(j)),x=l.useRef(!1),m=p?g||!!p.closest("form"):!0,[f,S]=mt({prop:r,defaultProp:i??!1,onChange:h,caller:rt});return e.jsxs(tr,{scope:s,checked:f,disabled:o,children:[e.jsx(ce.button,{type:"button",role:"switch","aria-checked":f,"aria-required":c,"data-state":Bs(f),"data-disabled":o?"":void 0,disabled:o,value:d,...v,ref:k,onClick:oe(a.onClick,j=>{S(O=>!O),m&&(x.current=j.isPropagationStopped(),x.current||j.stopPropagation())})}),m&&e.jsx(Fs,{control:p,bubbles:!x.current,name:n,value:d,checked:f,required:c,disabled:o,form:g,style:{transform:"translateX(-100%)"}})]})});$s.displayName=rt;var qs="SwitchThumb",zs=l.forwardRef((a,t)=>{const{__scopeSwitch:s,...n}=a,r=sr(qs,s);return e.jsx(ce.span,{"data-state":Bs(r.checked),"data-disabled":r.disabled?"":void 0,...n,ref:t})});zs.displayName=qs;var ar="SwitchBubbleInput",Fs=l.forwardRef(({__scopeSwitch:a,control:t,checked:s,bubbles:n=!0,...r},i)=>{const c=l.useRef(null),o=ye(c,i),d=Zt(s),h=la(t);return l.useEffect(()=>{const g=c.current;if(!g)return;const v=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(v,"checked").set;if(d!==s&&b){const k=new Event("click",{bubbles:n});b.call(g,s),g.dispatchEvent(k)}},[d,s,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...r,tabIndex:-1,ref:o,style:{...r.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Fs.displayName=ar;function Bs(a){return a?"checked":"unchecked"}var Ws=$s,nr=zs;const Me=l.forwardRef(({className:a,...t},s)=>e.jsx(Ws,{className:J("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...t,ref:s,children:e.jsx(nr,{className:J("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Me.displayName=Ws.displayName;function rr(){const a=ae();ue();const[t,s]=l.useState({dailyXPGoal:100,grammarQuizQuestionCount:10,vocabularyQuestionCount:10,essayQuestionCount:10}),[n,r]=l.useState(Se.getSettings()),[i,c]=l.useState(Se.getPermissionStatus()),[o,d]=l.useState(!1),[h,g]=l.useState(!1),[v,p]=l.useState(Ve.getEnabled());l.useEffect(()=>{b(),d(Se.isSupported()),c(Se.getPermissionStatus())},[]);const b=()=>{const y=xe.getAppSettings();s(y)},k=y=>{const $={...t,...y};s($),xe.saveAppSettings($)},x=(y,$)=>{k({[y]:$})},m=(y,$)=>{const z={...n,[y]:$};r(z),Se.updateSettings(z)},f=y=>{p(y),Ve.setEnabled(y),y&&Ve.sounds.click()},S=async()=>{try{const y=await Se.requestPermission();c(y)}catch(y){console.error("Error requesting permission:",y),alert("通知の許可を取得できませんでした。ブラウザの設定を確認してください。")}},j=async()=>{if(i!=="granted"){alert("通知の許可が必要です。");return}g(!0);try{await Se.testNotification()}catch(y){console.error("Error showing test notification:",y),alert("テスト通知の表示に失敗しました。")}finally{g(!1)}},H=(()=>{switch(i){case"granted":return{text:"許可済み",color:"text-green-600",icon:Vt};case"denied":return{text:"拒否済み",color:"text-red-600",icon:Tt};default:return{text:"未設定",color:"text-yellow-600",icon:It}}})(),Z=H.icon,T=()=>{confirm("すべての学習データを削除しますか？この操作は取り消せません。")&&confirm("本当に削除しますか？")&&(localStorage.clear(),window.location.reload())},u=()=>{try{const y={userStats:xe.getUserStats(),learningHistory:xe.getLearningHistory(),achievements:xe.getAchievements(),vocabularyProgress:xe.getVocabularyProgress(),appSettings:t,notificationSettings:n,exportDate:new Date().toISOString()},$=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),z=URL.createObjectURL($),K=document.createElement("a");K.href=z,K.download=`entp-english-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(z)}catch(y){console.error("Error exporting data:",y),alert("データのエクスポートに失敗しました。")}};return e.jsx("div",{className:"min-h-screen p-4 flex flex-col justify-center",children:e.jsxs("div",{className:"max-w-md mx-auto w-full space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{variant:"ghost",onClick:()=>a("/"),className:"p-2",children:"←"}),e.jsx("h1",{className:"text-2xl font-bold",children:"アプリ設定"}),e.jsx("div",{className:"w-10"})]}),e.jsxs(N,{children:[e.jsxs(R,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"学習設定"]}),e.jsx(Je,{children:"学習目標をカスタマイズできます"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"1日のXP目標"}),e.jsxs(Ee,{value:t.dailyXPGoal.toString(),onValueChange:y=>x("dailyXPGoal",parseInt(y)),children:[e.jsx(ke,{children:e.jsx(Re,{})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"50",children:"50 XP"}),e.jsx(F,{value:"100",children:"100 XP"}),e.jsx(F,{value:"150",children:"150 XP"}),e.jsx(F,{value:"200",children:"200 XP"}),e.jsx(F,{value:"300",children:"300 XP"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"ホーム画面の進捗バーに反映されます"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"文法クイズの問題数"}),e.jsxs(Ee,{value:t.grammarQuizQuestionCount.toString(),onValueChange:y=>x("grammarQuizQuestionCount",parseInt(y)),children:[e.jsx(ke,{children:e.jsx(Re,{})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"5",children:"5問"}),e.jsx(F,{value:"10",children:"10問"}),e.jsx(F,{value:"15",children:"15問"}),e.jsx(F,{value:"20",children:"20問"}),e.jsx(F,{value:"25",children:"25問"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"文法クイズで出題される問題数を設定します"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"語彙学習の問題数"}),e.jsxs(Ee,{value:t.vocabularyQuestionCount.toString(),onValueChange:y=>x("vocabularyQuestionCount",parseInt(y)),children:[e.jsx(ke,{children:e.jsx(Re,{})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"5",children:"5問"}),e.jsx(F,{value:"10",children:"10問"}),e.jsx(F,{value:"15",children:"15問"}),e.jsx(F,{value:"20",children:"20問"}),e.jsx(F,{value:"25",children:"25問"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"語彙学習で出題される問題数を設定します"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"英作文の問題数"}),e.jsxs(Ee,{value:t.essayQuestionCount.toString(),onValueChange:y=>x("essayQuestionCount",parseInt(y)),children:[e.jsx(ke,{children:e.jsx(Re,{})}),e.jsxs(Ce,{children:[e.jsx(F,{value:"5",children:"5問"}),e.jsx(F,{value:"10",children:"10問"}),e.jsx(F,{value:"15",children:"15問"}),e.jsx(F,{value:"20",children:"20問"}),e.jsx(F,{value:"25",children:"25問"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"英作文で出題される問題数を設定します"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(fe,{htmlFor:"sound-enabled",children:"効果音を有効にする"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"操作時の効果音を有効/無効にします"})]}),e.jsx(Me,{id:"sound-enabled",checked:v,onCheckedChange:f})]})]})]}),e.jsxs(N,{children:[e.jsxs(R,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"w-5 h-5"}),"データ管理"]}),e.jsx(Je,{children:"学習データのバックアップと管理"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs(w,{onClick:u,variant:"outline",className:"w-full",children:[e.jsx(Ct,{className:"w-4 h-4 mr-2"}),"データをエクスポート"]}),e.jsxs(w,{onClick:T,variant:"destructive",className:"w-full",children:[e.jsx(xa,{className:"w-4 h-4 mr-2"}),"すべてのデータを削除"]})]})]}),o?e.jsxs(e.Fragment,{children:[e.jsxs(N,{children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"w-5 h-5"}),"通知の許可状況"]})}),e.jsxs(I,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:`w-5 h-5 ${H.color}`}),e.jsx("span",{className:H.color,children:H.text})]}),i!=="granted"&&e.jsx(w,{onClick:S,size:"sm",children:"許可をリクエスト"})]}),i==="denied"&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:"通知が拒否されています。ブラウザの設定から許可してください。"})]})]}),e.jsxs(N,{children:[e.jsxs(R,{children:[e.jsx(W,{children:"通知設定"}),e.jsx(Je,{children:"学習のリマインダーや実績通知を設定できます"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(fe,{htmlFor:"enable-notifications",children:"通知を有効にする"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"すべての通知機能を有効/無効にします"})]}),e.jsx(Me,{id:"enable-notifications",checked:n.enabled,onCheckedChange:y=>m("enabled",y),disabled:i!=="granted"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(fe,{htmlFor:"daily-reminder",children:"毎日の学習リマインダー"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"指定した時間に学習を促す通知を送信します"})]}),e.jsx(Me,{id:"daily-reminder",checked:n.dailyReminder,onCheckedChange:y=>m("dailyReminder",y),disabled:!n.enabled||i!=="granted"})]}),n.dailyReminder&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(fe,{htmlFor:"reminder-time",children:"通知時間"}),e.jsx(wt,{id:"reminder-time",type:"time",value:n.reminderTime,onChange:y=>m("reminderTime",y.target.value),className:"w-32"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(fe,{htmlFor:"streak-reminder",children:"連続学習記録通知"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"連続学習記録が更新された時に通知します"})]}),e.jsx(Me,{id:"streak-reminder",checked:n.streakReminder,onCheckedChange:y=>m("streakReminder",y),disabled:!n.enabled||i!=="granted"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(fe,{htmlFor:"achievement-reminder",children:"実績解除通知"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"新しい実績を獲得した時に通知します"})]}),e.jsx(Me,{id:"achievement-reminder",checked:n.achievementReminder,onCheckedChange:y=>m("achievementReminder",y),disabled:!n.enabled||i!=="granted"})]})]})]}),e.jsx(N,{children:e.jsxs(I,{className:"pt-6",children:[e.jsxs(w,{onClick:j,disabled:i!=="granted"||h,className:"w-full",variant:"outline",children:[e.jsx(ua,{className:"w-4 h-4 mr-2"}),h?"テスト中...":"テスト通知を送信"]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mt-2",children:"通知が正常に動作するかテストできます"})]})})]}):e.jsx(N,{children:e.jsx(I,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Tt,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"通知機能が利用できません"}),e.jsx("p",{className:"text-sm text-gray-600",children:"お使いのブラウザは通知機能をサポートしていません。"})]})})})]})})}function ir(){const a=ae(),{cardId:t}=ze(),s=ga.find(o=>o.id===parseInt(t||"0"));if(!s)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(N,{className:"p-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"エラー: カードが見つかりません"}),e.jsx(w,{onClick:()=>a("/games/gacha"),children:"ガチャに戻る"})]})})});ue([s.id]);const n=o=>({common:{color:"text-gray-600",bgColor:"bg-gray-100",borderColor:"border-gray-300",icon:se,label:"コモン"},uncommon:{color:"text-green-600",bgColor:"bg-green-100",borderColor:"border-green-300",icon:se,label:"アンコモン"},rare:{color:"text-blue-600",bgColor:"bg-blue-100",borderColor:"border-blue-300",icon:se,label:"レア"},epic:{color:"text-purple-600",bgColor:"bg-purple-100",borderColor:"border-purple-300",icon:se,label:"エピック"},legendary:{color:"text-yellow-600",bgColor:"bg-yellow-100",borderColor:"border-yellow-300",icon:se,label:"レジェンダリー"}})[o],r=o=>({"400-500":"bg-red-100 text-red-800","500-600":"bg-orange-100 text-orange-800","600-700":"bg-yellow-100 text-yellow-800","700-800":"bg-green-100 text-green-800","800+":"bg-blue-100 text-blue-800"})[o]||"bg-gray-100 text-gray-800",i=n(s.rarity),c=i.icon;return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs(w,{variant:"outline",onClick:()=>a("/games/gacha"),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"ガチャに戻る"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.bgColor}`,children:e.jsx(c,{className:`w-6 h-6 ${i.color}`})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",children:s.word}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.bgColor} ${i.color}`,children:i.label}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r(s.toeicSpecific.scoreBand)}`,children:s.toeicSpecific.scoreBand})]})]})]})}),e.jsxs(N,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-blue-600"}),"基本情報"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"意味"}),e.jsx("div",{className:"font-medium",children:s.meaning})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"品詞"}),e.jsx("div",{className:"font-medium",children:s.partOfSpeech})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"発音"}),e.jsxs("div",{className:"font-medium flex items-center gap-1",children:[e.jsx(pa,{className:"w-4 h-4"}),s.phonetic]})]})]})]}),e.jsxs(N,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-green-600"}),"例文"]}),e.jsx("div",{className:"space-y-3",children:s.examples.slice(0,2).map((o,d)=>e.jsxs("div",{className:"border-l-2 border-green-200 pl-3",children:[e.jsx("div",{className:"font-medium mb-1",children:o.sentence}),e.jsx("div",{className:"text-gray-600 text-sm mb-1",children:o.translation}),e.jsx("div",{className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded inline-block",children:o.situation})]},d))})]}),s.combinations.length>0&&e.jsxs(N,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-purple-600"}),"組み合わせ表現"]}),e.jsx("div",{className:"space-y-3",children:s.combinations.slice(0,2).map((o,d)=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o.type==="idiom"?"bg-orange-100 text-orange-800":o.type==="phrasal_verb"?"bg-blue-100 text-blue-800":o.type==="collocation"?"bg-green-100 text-green-800":o.type==="slang"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:o.type==="idiom"?"イディオム":o.type==="phrasal_verb"?"句動詞":o.type==="collocation"?"コロケーション":o.type==="slang"?"スラング":"フォーマル"})}),e.jsx("div",{className:"font-medium mb-1",children:o.expression}),e.jsx("div",{className:"text-gray-600 text-sm mb-1",children:o.meaning}),e.jsxs("div",{className:"text-xs text-gray-500 italic",children:[o.example," - ",o.translation]})]},d))})]}),s.commonUsages.length>0&&e.jsxs(N,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(Gt,{className:"w-5 h-5 text-yellow-600"}),"よく使われるパターン"]}),e.jsx("div",{className:"space-y-3",children:s.commonUsages.slice(0,1).map((o,d)=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("div",{className:"font-medium mb-1 text-blue-600",children:o.pattern}),e.jsx("div",{className:"text-gray-600 text-sm mb-1",children:o.explanation}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:o.example})]},d))})]}),e.jsxs(N,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-red-600"}),"TOEIC特化情報"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"対象パート"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.toeicSpecific.parts.map((o,d)=>e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:o},d))})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"頻出度"}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium inline-block ${s.toeicSpecific.frequency==="very_high"?"bg-red-100 text-red-800":s.toeicSpecific.frequency==="high"?"bg-orange-100 text-orange-800":s.toeicSpecific.frequency==="medium"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.toeicSpecific.frequency==="very_high"?"非常に高い":s.toeicSpecific.frequency==="high"?"高い":s.toeicSpecific.frequency==="medium"?"中程度":"低い"})]}),s.toeicSpecific.synonyms.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"類義語"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.toeicSpecific.synonyms.slice(0,2).map((o,d)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:o},d))})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"ビジネス文脈"}),e.jsx("div",{className:"text-sm",children:s.toeicSpecific.businessContext})]})]})]})]})]})})}const lr=[{id:"basic-grammar",title:"基本文型",description:"be動詞・一般動詞",detail:"I am / You are / He has など基本的な文の構造",color:"bg-blue-50 border-blue-200 text-blue-800",difficulty:"初級"},{id:"tenses",title:"時制",description:"現在・過去・未来・完了",detail:"現在形、過去形、未来形、現在完了形など",color:"bg-green-50 border-green-200 text-green-800",difficulty:"初〜中級"},{id:"modals",title:"助動詞",description:"can / will / should など",detail:"可能性、意志、義務を表す助動詞",color:"bg-yellow-50 border-yellow-200 text-yellow-800",difficulty:"初〜中級"},{id:"passive",title:"受動態",description:"be + 過去分詞",detail:"「～される」という受身の表現",color:"bg-purple-50 border-purple-200 text-purple-800",difficulty:"中級"},{id:"relative",title:"関係詞",description:"who / which / that など",detail:"関係代名詞・関係副詞を使った修飾",color:"bg-orange-50 border-orange-200 text-orange-800",difficulty:"中級"},{id:"subjunctive",title:"仮定法",description:"if文・仮定の表現",detail:"「もし～だったら」という仮定の文",color:"bg-red-50 border-red-200 text-red-800",difficulty:"中〜上級"},{id:"comparison",title:"比較",description:"比較級・最上級",detail:"より～、最も～という比較の表現",color:"bg-teal-50 border-teal-200 text-teal-800",difficulty:"中級"},{id:"participle",title:"分詞・動名詞",description:"-ing / -ed の使い方",detail:"現在分詞、過去分詞、動名詞の用法",color:"bg-indigo-50 border-indigo-200 text-indigo-800",difficulty:"中〜上級"},{id:"infinitive",title:"不定詞",description:"to + 動詞の原形",detail:"名詞的・形容詞的・副詞的用法",color:"bg-pink-50 border-pink-200 text-pink-800",difficulty:"中級"}];function or(){const a=ae();return ue(),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:()=>a("/"),className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"カテゴリー選択"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"学習したい文法カテゴリーを選択してください"})]}),e.jsx("div",{className:"w-24"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:lr.map(t=>e.jsx(ie,{id:t.id,title:t.title,description:t.description,detail:t.detail,difficulty:t.difficulty,color:t.color,onClick:s=>{console.log("Category clicked:",s),a(`/learning/grammar/difficulty/${s}`)}},t.id))})]})})}const cr={"basic-grammar":"基本文型",tenses:"時制",modals:"助動詞",passive:"受動態",relative:"関係詞",subjunctive:"仮定法",comparison:"比較",participle:"分詞・動名詞",infinitive:"不定詞"};function dr(){const a=ae(),{category:t}=ze(),s=t||"basic-grammar";return ue(),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:()=>a("/learning/grammar/category"),className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"難易度選択"}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(D,{variant:"outline",className:"text-sm",children:cr[s]})})]}),e.jsx("div",{className:"w-24"})]}),e.jsx("p",{className:"text-center text-gray-600 mb-6",children:"難易度を選択してください"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(ie,{id:"easy",title:"簡単",description:"4択問題形式",detail:"与えられた日本語に対して、4つの選択肢から適切な英文を選びます。",icon:"⭐",difficulty:"初級",color:"bg-green-50 border-green-200 text-green-800",onClick:()=>{console.log("Easy difficulty clicked"),a(`/learning/grammar/question/${s}/easy`)}}),e.jsx(ie,{id:"normal",title:"普通",description:"ヒント付き入力",detail:"キーワードのヒントを参考に英文を入力します。",icon:"⚡",difficulty:"中級",color:"bg-yellow-50 border-yellow-200 text-yellow-800",onClick:()=>{console.log("Normal difficulty clicked"),a(`/learning/grammar/question/${s}/normal`)}}),e.jsx(ie,{id:"hard",title:"難しい",description:"ヒントなし入力",detail:"ヒントなしで日本語を英語に翻訳します。",icon:"👑",difficulty:"上級",color:"bg-red-50 border-red-200 text-red-800",onClick:()=>{console.log("Hard difficulty clicked"),a(`/learning/grammar/question/${s}/hard`)}})]})]})})}const Mt=[{id:1,type:"quote",category:"grammar",content:"Grammar is the grave of letters.",translation:"文法は文字の墓場である。",explanation:"マーク・トウェインの言葉。文法にこだわりすぎると、自然な表現力が失われるという意味。"},{id:2,type:"quote",category:"grammar",content:"The limits of my language mean the limits of my world.",translation:"私の言語の限界が、私の世界の限界を意味する。",explanation:"哲学者ルートヴィヒ・ウィトゲンシュタインの言葉。言語が思考の枠組みを作ることを示している。"},{id:3,type:"tip",category:"grammar",content:"English has no future tense!",translation:"英語には未来時制がない！",explanation:"英語では 'will' や 'going to' を使って未来を表現しますが、動詞の形自体は変わりません。"},{id:4,type:"tip",category:"grammar",content:"The word 'set' has the most meanings in English.",translation:"「set」という単語が英語で最も多くの意味を持つ。",explanation:"Oxford English Dictionaryによると、'set'は464の異なる意味を持つ最も多義的な単語です。"},{id:5,type:"quote",category:"grammar",content:"A language is a dialect with an army and navy.",translation:"言語とは、軍隊と海軍を持つ方言である。",explanation:"社会言語学者マックス・ワインライヒの言葉。政治的な力が言語の地位を決定することを示している。"},{id:6,type:"quote",category:"vocabulary",content:"Words are, of course, the most powerful drug used by mankind.",translation:"言葉は、もちろん、人類が使用する最も強力な薬である。",explanation:"小説家ラドヤード・キップリングの言葉。言葉の影響力の大きさを表現している。"},{id:7,type:"tip",category:"vocabulary",content:"English borrows from over 350 languages!",translation:"英語は350以上の言語から借用している！",explanation:"英語の語彙の約80%が他の言語から借用されたもので、特にラテン語、フランス語、ギリシャ語からの借用が多い。"},{id:8,type:"tip",category:"vocabulary",content:"The longest English word is 45 letters long!",translation:"最も長い英語の単語は45文字！",explanation:"'pneumonoultramicroscopicsilicovolcanoconiosis'（塵肺症）が最も長い英単語として知られています。"},{id:9,type:"quote",category:"vocabulary",content:"The difference between the right word and the almost right word is the difference between lightning and a lightning bug.",translation:"正しい単語とほぼ正しい単語の違いは、稲妻と蛍の違いである。",explanation:"マーク・トウェインの言葉。単語選択の重要性を強調している。"},{id:10,type:"tip",category:"vocabulary",content:"Shakespeare invented over 1,700 words!",translation:"シェイクスピアは1,700以上の単語を発明した！",explanation:"'eyeball', 'swagger', 'lonely'など、現在も使われている多くの単語をシェイクスピアが初めて使用した。"},{id:11,type:"quote",category:"general",content:"The best way to learn a language is to speak it.",translation:"言語を学ぶ最良の方法は、それを話すことである。",explanation:"理論だけでなく、実際に使うことで言語は身につくという学習の基本原則。"},{id:12,type:"quote",category:"general",content:"A different language is a different vision of life.",translation:"異なる言語は、異なる人生観である。",explanation:"映画監督フェデリコ・フェリーニの言葉。言語が世界観を形成することを示している。"},{id:13,type:"tip",category:"general",content:"English is spoken by 1.5 billion people worldwide!",translation:"英語は世界中で15億人に話されている！",explanation:"世界人口の約20%が英語を話し、そのうち約4億人が母語として使用している。"},{id:14,type:"tip",category:"general",content:"The word 'OK' comes from 'oll korrect'!",translation:"「OK」という単語は「oll korrect」から来ている！",explanation:"19世紀のアメリカで、'all correct'のスペルミス版として生まれた略語が定着した。"},{id:15,type:"quote",category:"general",content:"If you talk to a man in a language he understands, that goes to his head. If you talk to him in his language, that goes to his heart.",translation:"人が理解する言語で話せば、それは頭に届く。その人の言語で話せば、それは心に届く。",explanation:"ネルソン・マンデラの言葉。母語で話すことの深い影響力を表現している。"},{id:16,type:"tip",category:"general",content:"English has more words than any other language!",translation:"英語は他のどの言語よりも多くの単語を持つ！",explanation:"Oxford English Dictionaryには約60万語が収録されており、これは他の言語を大きく上回る。"},{id:17,type:"quote",category:"general",content:"Language is the road map of a culture. It tells you where its people come from and where they are going.",translation:"言語は文化の地図である。その人々がどこから来て、どこへ向かうかを教えてくれる。",explanation:"言語学者リタ・メイ・ブラウンの言葉。言語と文化の深い関係を示している。"},{id:18,type:"tip",category:"general",content:"The word 'queue' is pronounced the same even if you remove 4 letters!",translation:"「queue」という単語は4文字削除しても発音が同じ！",explanation:"'queue' → 'que' → 'qu' → 'q' と文字を削除しても、すべて 'kyu' と発音される。"},{id:19,type:"quote",category:"general",content:"One language sets you in a corridor for life. Two languages open every door along the way.",translation:"一つの言語は人生の廊下にあなたを置く。二つの言語は道中のすべての扉を開く。",explanation:"フランク・スミスの言葉。多言語習得の価値を表現している。"},{id:20,type:"tip",category:"general",content:"The shortest complete sentence in English is 'I am.'",translation:"英語で最も短い完全な文は「I am.」である。",explanation:"主語と動詞を含む完全な文として、最も短い形の例。"},{id:21,type:"quote",category:"general",content:"May the Force be with you.",translation:"フォースが共にあらんことを。",explanation:"スター・ウォーズシリーズの有名なセリフ。日常でも「頑張って」の意味で使われる。"},{id:22,type:"quote",category:"general",content:"I'll be back.",translation:"また戻ってくる。",explanation:"ターミネーターシリーズのアーノルド・シュワルツェネッガーの名セリフ。最も有名な映画のセリフの一つ。"},{id:23,type:"quote",category:"general",content:"Life is like a box of chocolates. You never know what you're gonna get.",translation:"人生はチョコレートの箱のようなもの。何が入っているかわからない。",explanation:"映画「フォレスト・ガンプ」の名セリフ。人生の不確実性を表現した美しい比喩。"},{id:24,type:"quote",category:"general",content:"To infinity and beyond!",translation:"無限の彼方へ！",explanation:"トイ・ストーリーのバズ・ライトイヤーの決めゼリフ。目標に向かって突き進む気持ちを表現。"},{id:25,type:"quote",category:"general",content:"I'm the king of the world!",translation:"俺は世界の王だ！",explanation:"映画「タイタニック」のジャックのセリフ。自由と希望を表現した名シーン。"},{id:26,type:"quote",category:"general",content:"You can't handle the truth!",translation:"お前には真実は扱えない！",explanation:"映画「ア・フュー・グッドメン」の名セリフ。真実の重さを表現した力強い言葉。"},{id:27,type:"quote",category:"general",content:"Houston, we have a problem.",translation:"ヒューストン、問題が発生しました。",explanation:"映画「アポロ13」のセリフ。危機的状況を冷静に報告する際の表現として使われる。"},{id:28,type:"quote",category:"general",content:"Elementary, my dear Watson.",translation:"初歩的なことだ、ワトソン君。",explanation:"シャーロック・ホームズの名セリフ。推理小説やドラマでよく使われる表現。"},{id:29,type:"quote",category:"general",content:"I'll make him an offer he can't refuse.",translation:"断れない条件を提示してやる。",explanation:"映画「ゴッドファーザー」の名セリフ。ビジネスでも使われる強気な表現。"},{id:30,type:"quote",category:"general",content:"Keep your friends close, but your enemies closer.",translation:"友人は近くに、敵はもっと近くに置け。",explanation:"映画「ゴッドファーザー」の名セリフ。戦略的思考を表現した格言として使われる。"},{id:31,type:"quote",category:"general",content:"I'm walking here!",translation:"歩いてるんだよ！",explanation:"映画「ミッドナイト・カウボーイ」の名セリフ。ニューヨークの街角でよく使われる表現。"},{id:32,type:"quote",category:"general",content:"Here's looking at you, kid.",translation:"君を見つめているよ、坊や。",explanation:"映画「カサブランカ」の名セリフ。別れの際の美しい表現として知られる。"},{id:33,type:"quote",category:"general",content:"I'll be there for you.",translation:"君のためにそこにいるよ。",explanation:"ドラマ「フレンズ」のテーマソングの歌詞。友情を表現した温かい言葉。"},{id:34,type:"quote",category:"general",content:"Winter is coming.",translation:"冬が来る。",explanation:"ドラマ「ゲーム・オブ・スローンズ」の名セリフ。警告や予兆を表現する際に使われる。"},{id:35,type:"quote",category:"general",content:"You know nothing, Jon Snow.",translation:"君は何も知らない、ジョン・スノー。",explanation:"ドラマ「ゲーム・オブ・スローンズ」のイグリットのセリフ。無知を指摘する際に使われる。"},{id:36,type:"quote",category:"general",content:"I am Iron Man.",translation:"俺はアイアンマンだ。",explanation:"映画「アイアンマン」シリーズのトニー・スタークのセリフ。自信を表現する際に使われる。"},{id:37,type:"quote",category:"general",content:"With great power comes great responsibility.",translation:"大きな力には大きな責任が伴う。",explanation:"スパイダーマンシリーズの名セリフ。責任感の重要性を表現した格言。"},{id:38,type:"quote",category:"general",content:"I'm Batman.",translation:"俺はバットマンだ。",explanation:"バットマンシリーズの名セリフ。シンプルで力強い自己紹介の表現。"},{id:39,type:"quote",category:"general",content:"I'm not a smart man, but I know what love is.",translation:"俺は賢い男じゃないが、愛が何かは知っている。",explanation:"映画「フォレスト・ガンプ」の名セリフ。シンプルで心に響く愛の表現。"},{id:40,type:"quote",category:"general",content:"I'm the captain now.",translation:"俺が船長だ。",explanation:"映画「キャプテン・フィリップス」の名セリフ。主導権を握った際の表現として使われる。"},{id:41,type:"quote",category:"general",content:"I see dead people.",translation:"死んだ人が見える。",explanation:"映画「シックス・センス」の名セリフ。超自然現象を表現する際に使われる。"},{id:42,type:"quote",category:"general",content:"There's no place like home.",translation:"家ほど良い場所はない。",explanation:"映画「オズの魔法使い」のドロシーのセリフ。故郷の大切さを表現した名セリフ。"},{id:43,type:"quote",category:"general",content:"I'm going to make him an offer he can't refuse.",translation:"断れない条件を提示してやる。",explanation:"映画「ゴッドファーザー」の名セリフ。ビジネスでも使われる強気な表現。"},{id:44,type:"quote",category:"general",content:"I'll have what she's having.",translation:"彼女と同じものをください。",explanation:"映画「ハリーとサリー」の名セリフ。レストランでよく使われる表現。"},{id:45,type:"quote",category:"general",content:"I'm the king of the world!",translation:"俺は世界の王だ！",explanation:"映画「タイタニック」のジャックのセリフ。自由と希望を表現した名シーン。"},{id:46,type:"quote",category:"general",content:"I'm walking here!",translation:"歩いてるんだよ！",explanation:"映画「ミッドナイト・カウボーイ」の名セリフ。ニューヨークの街角でよく使われる表現。"},{id:47,type:"quote",category:"general",content:"I'll be back.",translation:"また戻ってくる。",explanation:"ターミネーターシリーズのアーノルド・シュワルツェネッガーの名セリフ。最も有名な映画のセリフの一つ。"},{id:48,type:"quote",category:"general",content:"I'm the king of the world!",translation:"俺は世界の王だ！",explanation:"映画「タイタニック」のジャックのセリフ。自由と希望を表現した名シーン。"},{id:49,type:"quote",category:"general",content:"I'm walking here!",translation:"歩いてるんだよ！",explanation:"映画「ミッドナイト・カウボーイ」の名セリフ。ニューヨークの街角でよく使われる表現。"},{id:50,type:"quote",category:"general",content:"I'll be back.",translation:"また戻ってくる。",explanation:"ターミネーターシリーズのアーノルド・シュワルツェネッガーの名セリフ。最も有名な映画のセリフの一つ。"}];function mr(a){let t=Mt;t=Mt.filter(n=>n.category===a);const s=Math.floor(Math.random()*t.length);return t[s]}const hr={normal:{min:3,max:8},rare:{min:10,max:18},epic:{min:25,max:40},legendary:{min:50,max:100}};function xr(a){if(a<=20){const t=Math.random();return t<.8?"normal":t<.98?"rare":"epic"}else if(a<=40){const t=Math.random();return t<.6?"normal":t<.9?"rare":t<.99?"epic":"legendary"}else if(a<=60){const t=Math.random();return t<.4?"normal":t<.75?"rare":t<.95?"epic":"legendary"}else if(a<=80){const t=Math.random();return t<.25?"normal":t<.6?"rare":t<.9?"epic":"legendary"}else{const t=Math.random();return t<.15?"normal":t<.45?"rare":t<.8?"epic":"legendary"}}function ur(a,t=!1){const s=hr[a],n=Math.floor(Math.random()*(s.max-s.min+1))+s.min;return t?Math.floor(n*1.5):n}function gr(a,t,s){return a.filter(n=>{const i=["normal","rare","epic","legendary"].indexOf(n.rank);return i>=i})}function pr(a,t){if(a.length===0)return null;const s=a.map(c=>{const o=t[c.skillField]/30,d=fr(c.rank);return o*d}),n=s.reduce((c,o)=>c+o,0);if(n===0)return a[Math.floor(Math.random()*a.length)];const r=Math.random()*n;let i=0;for(let c=0;c<a.length;c++)if(i+=s[c],r<=i)return a[c];return a[0]}function fr(a){return{normal:1,rare:2,epic:3,legendary:5}[a]}const yr=({rank:a,showIcon:t=!0,showName:s=!0,showXP:n=!1,question:r,size:i="md",className:c=""})=>{const o=fa[a],d={sm:"text-xs px-2 py-1",md:"text-sm px-3 py-1.5",lg:"text-base px-4 py-2"},h={sm:"text-sm",md:"text-base",lg:"text-lg"};return e.jsxs("div",{className:`inline-flex items-center space-x-1 ${o.bgColor} ${o.color} rounded-full ${d[i]} ${c}`,children:[t&&e.jsx("span",{className:h[i],children:o.icon}),s&&e.jsx("span",{className:"font-medium",children:o.name}),n&&r&&e.jsxs("span",{className:"text-xs opacity-75",children:["+",r.xpReward,"XP"]})]})},vr="ontouchstart"in window||navigator.maxTouchPoints>0;function br({blankId:a,droppedWord:t,onDrop:s}){const[{isOver:n},r]=Sa({accept:"word",drop:i=>s(a,i.word),collect:i=>({isOver:i.isOver()})});return e.jsx("span",{ref:r,className:`
        inline-block min-w-[80px] h-8 px-3 mx-1 border-2 border-dashed rounded-md
        flex items-center justify-center text-center
        ${n?"border-blue-500 bg-blue-50":"border-gray-300"}
        ${t?"bg-blue-100 border-blue-400 border-solid":""}
        transition-all duration-200
      `,children:t||"?"})}function jr({word:a}){const[{isDragging:t},s]=Na({type:"word",item:{word:a},collect:n=>({isDragging:n.isDragging()})});return e.jsx("span",{ref:s,className:`
        inline-block px-3 py-1 mx-1 mb-2 bg-blue-100 text-blue-800 rounded-md cursor-move
        hover:bg-blue-200 transition-colors duration-200
        ${t?"opacity-50":""}
      `,children:a})}function wr(){const a=ae(),{category:t,difficulty:s}=ze();ue();const n=t,r=s||"intermediate",[i,c]=l.useState([]),[o,d]=l.useState(0),[h,g]=l.useState({}),[v,p]=l.useState(0),[b,k]=l.useState(!1),[x,m]=l.useState(0),[f,S]=l.useState([]),[j,O]=l.useState(!1),[H,Z]=l.useState(null),[T,u]=l.useState(null),[y]=l.useState(()=>V()),[$,z]=l.useState(y.getHeartSystem()),[K,le]=l.useState(y.getLevel()),[L]=l.useState(y.getStatusAllocation());l.useEffect(()=>{if(!y.consumeHeart()){alert("体力が不足しています。回復を待ってから再試行してください。"),a(`/learning/grammar/difficulty/${n}`);return}U(),m(Date.now()),z(y.getHeartSystem()),de()},[]);const U=()=>{console.log("Generating questions for category:",n,"difficulty:",r);const M=sn(r,n);if(console.log("Original questions:",M),!M||M.length===0){console.error("No grammar questions found for difficulty:",r),c([]);return}const X=M.map((E,A)=>{const P=xr(K.level),G="grammar",pe=ur(P);return{id:E.id,question:E.sentence,options:E.options,correctAnswer:E.blanks.map(we=>we.correctAnswer).join(" "),explanation:E.explanation,category:"basic-grammar",difficulty:"normal",rank:P,skillField:G,xpReward:pe,blanks:E.blanks}});console.log("Enhanced questions:",X);const C=gr(X,K.level);console.log("Filtered questions:",C);const B=[],te=8;for(let E=0;E<te;E++){const A=C.filter(P=>!B.some(G=>G.id===P.id));if(A.length>0){const P=pr(A,L);P&&B.push(P)}}console.log("Selected questions:",B),c(B)},_=i[o]||null,Y=i.length>0?(o+1)/i.length*100:0;l.useEffect(()=>{if(_&&_.options){const M=[..._.options].sort(()=>Math.random()-.5);S(M),g({}),O(!1),Z(null),u(null)}},[o,_]);const q=(M,X)=>{g(C=>({...C,[M]:X}))},ne=()=>{if(!_||!_.blanks)return!1;let M=!0;for(const X of _.blanks){const C=h[X.id];if(!C||C!==X.correctAnswer){M=!1;break}}return M},me=()=>{const M=ne();Z(M),M&&p(X=>X+1),u(mr("grammar")),O(!0)},re=()=>{O(!1),Z(null),o<i.length-1?d(M=>M+1):Ae()},Ae=()=>{k(!0);const M=wa(i.length>0?i.map((C,B)=>({questionId:C.id,answer:h[`blank_${B}`]||"",isCorrect:v>0})):[],_?.rank||"normal",!0),X=y.addXP(M);le(y.getLevel()),de(),X.leveledUp?Ve.sounds.levelUp():Ve.sounds.complete()},Pe=()=>{if(!_||!_.blanks)return null;const M=_.question,X=_.blanks,C=M.split(" "),B=[];let te=0;for(let E=0;E<C.length;E++){const A=C[E],P=X.find(G=>G.position===E+1);P?(B.push(e.jsx(br,{blankId:P.id,droppedWord:h[P.id]||null,onDrop:q},`blank_${te}`)),te++):B.push(e.jsx("span",{className:"mx-1",children:A},E))}return B},ge=()=>{d(0),g({}),p(0),k(!1),U(),m(Date.now())};return i.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(N,{className:"mb-6",children:[e.jsx(R,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(w,{onClick:()=>a(`/learning/grammar/difficulty/${n}`),variant:"outline",size:"sm",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"文法クイズ"})]})})}),e.jsx(I,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-lg text-gray-600",children:"問題を読み込み中..."}),e.jsx("div",{className:"text-sm text-gray-500",children:"しばらくお待ちください"}),e.jsxs(w,{onClick:ge,variant:"outline",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"再読み込み"]})]})})]})})}):b?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(N,{className:"mb-6",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"クイズ結果"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xt,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[$.current,"/",$.max]})]})]})}),e.jsx(I,{children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"text-4xl font-bold text-blue-600",children:[v," / ",i.length]}),e.jsxs("div",{className:"text-lg text-gray-600",children:["正解率: ",Math.round(v/i.length*100),"%"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["獲得XP: ",i.reduce((M,X)=>M+X.xpReward,0)]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"問題解説"}),i.map((M,X)=>e.jsxs("div",{className:"text-left p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"font-medium text-gray-800 mb-2",children:["問題 ",X+1,": ",M.question]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"解説:"})," ",M.explanation]})]},M.id))]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs(w,{onClick:ge,className:"flex items-center",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"もう一度挑戦"]}),e.jsxs(w,{onClick:()=>a(`/learning/grammar/difficulty/${n}`),variant:"outline",className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"ホームに戻る"]})]})]})})]})})}):!_||i.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(N,{children:e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-lg text-gray-600",children:i.length===0?"問題が見つかりませんでした":"問題を読み込み中..."}),e.jsxs(w,{onClick:()=>a(`/learning/grammar/difficulty/${n}`),className:"mt-4",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]})]})})})}):e.jsx(ya,{backend:vr?va:ba,children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(N,{className:"mb-6",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(w,{onClick:()=>a(`/learning/grammar/difficulty/${n}`),variant:"outline",size:"sm",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"文法クイズ"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xt,{className:"w-5 h-5 text-red-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[$.current,"/",$.max]})]}),e.jsxs(D,{variant:"secondary",children:["Level ",K.level]})]})]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["問題 ",o+1,"/",i.length]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[o+1," / ",i.length]})]}),e.jsx(be,{value:Y,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["スコア: ",v," / ",i.length]}),e.jsx(yr,{rank:_.rank,showXP:!0,question:_,size:"sm"})]})]})})]}),e.jsx(N,{className:"mb-6",children:e.jsx(I,{className:"p-6",children:_?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-800 mb-2",children:_.question}),e.jsx("p",{className:"text-sm text-gray-600",children:"空欄に適切な単語をドラッグして文を完成させてください"})]}),e.jsx("div",{className:"text-center text-lg",children:Pe()}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"単語を選んでください"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:f.map((M,X)=>e.jsx(jr,{word:M},X))})]})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"text-lg text-gray-600",children:"問題を読み込み中..."}),e.jsx("div",{className:"text-sm text-gray-500",children:"しばらくお待ちください"}),e.jsxs(w,{onClick:ge,variant:"outline",children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),"再読み込み"]})]})})}),j&&_&&e.jsx(N,{className:"mb-6 border-2 border-blue-200 bg-blue-50",children:e.jsx(I,{className:"p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2",children:H?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{className:"w-6 h-6 text-green-500"}),e.jsx("span",{className:"text-xl font-bold text-green-600",children:"正解！"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ja,{className:"w-6 h-6 text-red-500"}),e.jsx("span",{className:"text-xl font-bold text-red-600",children:"不正解"})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"正解:"}),e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:_.blanks?.map(M=>M.correctAnswer).join(" ")})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"解説:"}),e.jsx("div",{className:"text-gray-800",children:_.explanation})]}),T&&e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-4 rounded-lg border border-purple-200",children:[e.jsx("div",{className:"text-sm text-purple-700 mb-2 font-medium",children:T.type==="quote"?"💭 英語の格言":"💡 英語の豆知識"}),e.jsxs("div",{className:"text-purple-800 mb-2 font-semibold",children:['"',T.content,'"']}),e.jsx("div",{className:"text-sm text-purple-600 mb-1",children:T.translation}),T.explanation&&e.jsx("div",{className:"text-xs text-purple-500 italic",children:T.explanation}),e.jsx("div",{className:"mt-2 text-xs text-purple-600",children:H?`+${_.xpReward}XP 獲得！`:"正解を覚えて次回に活かしましょう！"})]}),e.jsx(w,{onClick:re,size:"lg",className:"mt-4",children:o<i.length-1?"次の問題へ":"結果を見る"})]})})}),!j&&e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{onClick:me,size:"lg",children:o<i.length-1?"次の問題":"答え合わせ"})})]})})})}const kt=[{id:"basic-grammar-intro",title:"自己紹介文を書こう",category:"grammar",subcategory:"basic-grammar",difficulty:"beginner",level:1,promptType:"guided",instruction:"英語で簡単な自己紹介を3-4文で書いてください。",context:"初めて会う人に自分のことを紹介する場面です。",keyWords:["student","work","like","live"],grammarFocus:["be動詞","一般動詞","SVO構造"],evaluationCriteria:{grammar:40,vocabulary:20,fluency:30,creativity:10},sampleAnswers:[{level:"basic",text:"I am Taro. I am a student. I like music. I live in Tokyo.",explanation:"基本的なbe動詞と一般動詞を使った簡潔な自己紹介",grammarPoints:["be動詞の基本形","一般動詞の現在形"],vocabularyHighlights:["student","like","live"]},{level:"good",text:"My name is Taro Yamada. I am a university student studying English. I enjoy listening to music and reading books. I live in Tokyo with my family.",explanation:"より詳細で自然な表現を使った自己紹介",grammarPoints:["現在進行形","動名詞","前置詞句"],vocabularyHighlights:["university","studying","enjoy","listening"]}],relatedGrammarCategories:["basic-grammar"],relatedPreStudyContent:["basic-grammar-theory"]},{id:"tenses-weekend-plan",title:"週末の予定を説明しよう",category:"grammar",subcategory:"tenses",difficulty:"beginner",level:2,promptType:"guided",instruction:"今度の週末の予定について、過去・現在・未来の時制を使って4-5文で書いてください。",context:"友人に週末の予定を説明する場面です。",keyWords:["weekend","plan","yesterday","today","tomorrow"],grammarFocus:["現在形","過去形","未来形"],evaluationCriteria:{grammar:50,vocabulary:20,fluency:25,creativity:5},sampleAnswers:[{level:"basic",text:"Yesterday I studied English. Today I am working. Tomorrow I will go shopping. I will meet my friends on Sunday.",explanation:"基本的な時制を正しく使い分けた表現",grammarPoints:["過去形","現在進行形","未来形will"],vocabularyHighlights:["studied","working","shopping","meet"]},{level:"excellent",text:"Last weekend I visited my grandparents in the countryside. Today I'm preparing for next week's presentation at work. Tomorrow I'm planning to go to the new art museum that opened recently. On Sunday, I will have lunch with my college friends and we'll catch up on each other's lives.",explanation:"複雑な時制と自然な表現を組み合わせた高度な文章",grammarPoints:["過去形","現在進行形","be going to","未来完了"],vocabularyHighlights:["visited","countryside","preparing","presentation","museum","catch up"]}],relatedGrammarCategories:["tenses"],relatedPreStudyContent:["tenses-theory"]},{id:"modals-business-request",title:"丁寧なビジネス依頼文を書こう",category:"grammar",subcategory:"modals",difficulty:"intermediate",level:3,promptType:"guided",instruction:"同僚に仕事の依頼をする丁寧なメールを3-4文で書いてください。助動詞を必ず使用してください。",context:"忙しい同僚に追加の作業をお願いする場面です。",keyWords:["could","would","please","help","appreciate"],grammarFocus:["助動詞","丁寧表現","依頼文"],evaluationCriteria:{grammar:35,vocabulary:25,fluency:30,creativity:10},sampleAnswers:[{level:"good",text:"Could you please help me with the report? I would appreciate it if you could review the data. Would you mind checking the calculations? Thank you for your time.",explanation:"基本的な助動詞を使った丁寧な依頼表現",grammarPoints:["Could you","would appreciate","Would you mind"],vocabularyHighlights:["appreciate","review","calculations"]},{level:"excellent",text:"I hope this email finds you well. I was wondering if you might be able to assist me with the quarterly report that's due next week. Would it be possible for you to review the financial data and provide your insights? I would greatly appreciate any feedback you could offer, and I understand if you're too busy at the moment.",explanation:"非常に丁寧で自然なビジネス英語表現",grammarPoints:["I was wondering if","might be able to","Would it be possible","would greatly appreciate"],vocabularyHighlights:["quarterly","assist","financial","insights","feedback"]}],relatedGrammarCategories:["modals"],relatedPreStudyContent:["modals-theory"]},{id:"vocabulary-toeic-business",title:"TOEIC語彙を使ったビジネス場面描写",category:"vocabulary",difficulty:"intermediate",level:3,promptType:"guided",instruction:"あなたが獲得したTOEIC語彙カードから5個以上の単語を使って、ビジネス会議の様子を4-5文で描写してください。",context:"重要なプロジェクトの会議が行われている場面です。",grammarFocus:["現在進行形","受動態","関係詞"],evaluationCriteria:{grammar:30,vocabulary:40,fluency:25,creativity:5},sampleAnswers:[{level:"good",text:"The meeting is being conducted in the conference room. The manager is presenting the quarterly report to the team. Several important issues are being discussed by the participants. The deadline for the project has been extended until next month.",explanation:"TOEIC頻出語彙と基本的な文法を組み合わせた表現",grammarPoints:["現在進行受動態","現在完了受動態"],vocabularyHighlights:["conducted","conference","quarterly","participants","deadline","extended"]}],relatedGrammarCategories:["passive","tenses"],relatedPreStudyContent:["toeic-vocabulary-strategy"]},{id:"relative-clauses-description",title:"関係詞を使った人物・場所の説明",category:"grammar",subcategory:"relative",difficulty:"intermediate",level:5,promptType:"guided",instruction:"あなたの尊敬する人について、関係詞（who, which, that）を使って4-5文で説明してください。",context:"友人にあなたが尊敬する人について紹介する場面です。",grammarFocus:["関係代名詞","関係副詞"],evaluationCriteria:{grammar:45,vocabulary:25,fluency:25,creativity:5},sampleAnswers:[{level:"good",text:"The person whom I respect most is my English teacher who taught me in high school. She is someone who always encouraged students to challenge themselves. The teaching method which she used was very effective. I still remember the advice that she gave me about studying abroad.",explanation:"様々な関係詞を適切に使用した説明文",grammarPoints:["関係代名詞whom","関係代名詞who","関係代名詞which","関係代名詞that"],vocabularyHighlights:["respect","encouraged","challenge","effective","advice"]}],relatedGrammarCategories:["relative"],relatedPreStudyContent:["relative-theory"]},{id:"subjunctive-career-dreams",title:"仮定法を使った理想のキャリア描写",category:"grammar",subcategory:"subjunctive",difficulty:"advanced",level:6,promptType:"free-writing",instruction:"もし理想的な条件が整ったら、どのようなキャリアを築きたいか仮定法を使って5-6文で書いてください。",context:"キャリアカウンセラーとの面談で将来の夢を語る場面です。",grammarFocus:["仮定法過去","仮定法過去完了","wishの用法"],evaluationCriteria:{grammar:40,vocabulary:30,fluency:20,creativity:10},sampleAnswers:[{level:"excellent",text:"If I had unlimited resources, I would establish my own international consulting firm. I wish I could travel to different countries and help businesses expand globally. If I had studied business administration earlier, I would have been better prepared for this career path. I would hire talented people who share my vision, and we would make a positive impact on the world economy.",explanation:"複雑な仮定法表現を使った創造的な文章",grammarPoints:["仮定法過去","I wish + 仮定法","仮定法過去完了","関係詞との組み合わせ"],vocabularyHighlights:["unlimited","establish","consulting","expand","administration","impact","economy"]}],relatedGrammarCategories:["subjunctive"],relatedPreStudyContent:["subjunctive-theory"]},{id:"mixed-presentation-prep",title:"プレゼンテーション準備の説明",category:"mixed",difficulty:"advanced",level:7,promptType:"free-writing",instruction:"重要なプレゼンテーションの準備過程について、様々な文法項目と語彙を使って6-8文で説明してください。",context:"上司にプレゼンテーションの準備状況を報告する場面です。",grammarFocus:["複合時制","受動態","分詞構文","関係詞"],evaluationCriteria:{grammar:35,vocabulary:35,fluency:20,creativity:10},sampleAnswers:[{level:"excellent",text:"Having analyzed the market data thoroughly, I have been preparing a comprehensive presentation for next week's board meeting. The slides that I created yesterday incorporate the latest research findings which were published by our analytics team. While reviewing the content, I realized that some additional charts would be needed to support our recommendations. The presentation, which will be delivered to senior executives, focuses on strategic initiatives that could significantly improve our market position. I am confident that the proposal will be well-received by the audience.",explanation:"高度な文法構造と豊富な語彙を組み合わせた専門的な文章",grammarPoints:["分詞構文","現在完了進行形","関係詞","受動態","複合文"],vocabularyHighlights:["analyzed","comprehensive","incorporate","findings","analytics","executives","initiatives","significantly","proposal"]}],relatedGrammarCategories:["participle","relative","passive","tenses"],relatedPreStudyContent:["writing-strategy","toeic-vocabulary-strategy"]}];function Nr(a){return kt.filter(t=>t.level<=a)}function Sr(a){return kt.filter(t=>t.keyWords?t.keyWords.some(s=>a.includes(s)):!1)}function kr(a){return kt.filter(t=>t.relatedGrammarCategories?t.relatedGrammarCategories.some(s=>a.includes(s)):!1)}function Cr(){const a=ae();ue();const[t,s]=l.useState(null),[n,r]=l.useState(""),[i,c]=l.useState(!0),[o,d]=l.useState(!1),[h]=l.useState({difficulty:3,satisfaction:3,grammarConfidence:3,vocabularyUsage:3}),g=V(),v=g.getLevel(),p=typeof v=="object"?v.level||1:v||1,b=Nr(p),k=he.getUserGachaData(),x=k.ownedCards.map(u=>u.word),m=xe.getPreStudyProgress(),f=["basic-grammar","tenses"],S=Sr(x),j=kr(f),O=[...S.slice(0,2),...j.slice(0,2)].filter((u,y,$)=>$.findIndex(z=>z.id===u.id)===y),H=u=>{s(u),r(""),d(!1),c(!0)},Z=()=>{if(!t||!n.trim())return;const u={id:`essay_${Date.now()}`,promptId:t.id,userId:"current_user",text:n,submittedAt:Date.now(),selfAssessment:h,analysis:{wordCount:n.trim().split(/\s+/).length,grammarIssues:[],vocabularyUsed:x.filter($=>n.toLowerCase().includes($.toLowerCase())),suggestions:[],estimatedLevel:t.difficulty}};console.log("Essay submitted:",u);const y=t.difficulty==="beginner"?15:t.difficulty==="intermediate"?25:35;g.addXP(y),d(!0)},T=()=>{s(null),r(""),d(!1),c(!0)};return t?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:T,className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"課題選択に戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 justify-center mt-1",children:[e.jsx(D,{variant:"outline",className:"text-xs",children:t.category}),e.jsx(D,{variant:"outline",className:"text-xs",children:t.difficulty}),e.jsxs(D,{variant:"outline",className:"text-xs",children:["Level ",t.level]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"文字数"}),e.jsxs("div",{className:"text-xl font-bold text-indigo-600",children:[n.trim().split(/\s+/).filter(u=>u).length,"語"]})]})]}),i&&e.jsxs(N,{className:"mb-6 bg-white shadow-sm border",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center gap-2 text-lg",children:[e.jsx(je,{className:"w-5 h-5 text-blue-500"}),"課題の指示"]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"📝 指示内容"}),e.jsx("p",{className:"text-gray-700",children:t.instruction})]}),t.context&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"🎭 場面設定"}),e.jsx("p",{className:"text-gray-700",children:t.context})]}),t.keyWords&&t.keyWords.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"🎯 推奨語彙"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.keyWords.map(u=>e.jsxs(D,{variant:x.includes(u)?"default":"outline",className:"text-xs",children:[u," ",x.includes(u)&&"✓"]},u))})]}),t.grammarFocus&&t.grammarFocus.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"📚 重点文法"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.grammarFocus.map(u=>e.jsx(D,{variant:"outline",className:"text-xs",children:u},u))})]}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(!1),className:"mt-4",children:"指示を隠す"})]})]}),!i&&e.jsxs(w,{variant:"ghost",size:"sm",onClick:()=>c(!0),className:"mb-4 flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4"}),"指示を表示"]}),!o&&e.jsxs(N,{className:"mb-6 bg-white shadow-sm border",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"w-5 h-5 text-indigo-500"}),"英作文を書いてください"]})}),e.jsxs(I,{children:[e.jsx(Xe,{value:n,onChange:u=>r(u.target.value),placeholder:"ここに英作文を入力してください...",className:"min-h-[300px] text-base leading-relaxed"}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"💡 ヒント: 推奨語彙や重点文法を意識して書いてみましょう"}),e.jsx(w,{onClick:Z,disabled:!n.trim(),className:"bg-indigo-600 hover:bg-indigo-700",children:"提出する"})]})]})]}),o&&e.jsxs(N,{className:"mb-6 bg-green-50 border-green-200",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center gap-2 text-green-800",children:[e.jsx(se,{className:"w-5 h-5"}),"英作文完了！"]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"あなたの英作文"}),e.jsx("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:n})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"文字数"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[n.trim().split(/\s+/).filter(u=>u).length,"語"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"獲得XP"}),e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:["+",t.difficulty==="beginner"?15:t.difficulty==="intermediate"?25:35,"XP"]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(w,{onClick:T,variant:"outline",children:"新しい課題に挑戦"}),e.jsxs(w,{onClick:()=>a("/learning/grammar/category"),variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4"}),"文法クイズで復習"]})]})]})]}),o&&t.sampleAnswers.length>0&&e.jsxs(N,{className:"bg-white shadow-sm border",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-yellow-500"}),"参考解答例"]})}),e.jsx(I,{className:"space-y-4",children:t.sampleAnswers.map((u,y)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx(D,{variant:"outline",className:"text-xs",children:u.level})}),e.jsxs("p",{className:"text-gray-700 mb-3 italic",children:['"',u.text,'"']}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:u.explanation}),e.jsx("div",{className:"flex flex-wrap gap-1",children:u.grammarPoints.map(($,z)=>e.jsx(D,{variant:"outline",className:"text-xs",children:$},z))})]},y))})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:()=>a("/"),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(_t,{className:"w-8 h-8 text-indigo-600"}),"英作文"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"文法と語彙を実践で活用しよう"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"ユーザーレベル"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:p})]})]}),e.jsxs(N,{className:"mb-8 p-6 bg-white shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🔗 学習連携状況"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"獲得語彙カード"}),e.jsxs("div",{className:"font-bold text-purple-600",children:[k.ownedCards.length,"枚"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"完了した事前学習"}),e.jsxs("div",{className:"font-bold text-blue-600",children:[m.completedContents.length,"件"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"文法カテゴリー"}),e.jsxs("div",{className:"font-bold text-green-600",children:[f.length,"分野"]})]})]})]}),O.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-yellow-500"}),"あなたにおすすめの英作文"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.map(u=>e.jsx(ie,{id:u.id,title:u.title,description:u.instruction,detail:`${u.category} | ${u.difficulty}`,icon:"✨",difficulty:u.difficulty,level:u.level,color:"bg-yellow-50 border-yellow-200",isRecommended:!0,onClick:()=>H(u)},u.id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ka,{className:"w-5 h-5 text-indigo-500"}),"利用可能な英作文課題"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(u=>e.jsx(ie,{id:u.id,title:u.title,description:u.instruction,detail:`レベル ${u.level} | ${u.promptType}`,icon:u.category==="grammar"?"📚":u.category==="vocabulary"?"🎯":"🔀",difficulty:u.difficulty,level:u.level,color:u.difficulty==="beginner"?"bg-green-50 border-green-200":u.difficulty==="intermediate"?"bg-blue-50 border-blue-200":"bg-red-50 border-red-200",onClick:()=>H(u)},u.id))})]})]})})}function Vs({card:a,onClick:t,className:s,size:n="md",showDetails:r=!0,isNew:i=!1,isAnimated:c=!0,isFavorite:o=!1,onFavoriteToggle:d}){const g=(b=>{switch(b){case"common":return{icon:se,gradient:"from-gray-400 via-gray-500 to-gray-600",bgGradient:"from-white to-white",borderColor:"border-gray-400",shadowColor:"shadow-gray-200/50",glowColor:"shadow-gray-400/20",textColor:"text-gray-900",badgeColor:"bg-gray-500",name:"コモン"};case"uncommon":return{icon:se,gradient:"from-green-400 via-green-500 to-green-600",bgGradient:"from-white to-white",borderColor:"border-green-500",shadowColor:"shadow-green-200/50",glowColor:"shadow-green-400/30",textColor:"text-gray-900",badgeColor:"bg-green-500",name:"アンコモン"};case"rare":return{icon:He,gradient:"from-blue-400 via-blue-500 to-blue-600",bgGradient:"from-white to-white",borderColor:"border-blue-500",shadowColor:"shadow-blue-200/50",glowColor:"shadow-blue-400/40",textColor:"text-gray-900",badgeColor:"bg-blue-500",name:"レア"};case"epic":return{icon:zt,gradient:"from-purple-400 via-purple-500 to-purple-600",bgGradient:"from-white to-white",borderColor:"border-purple-500",shadowColor:"shadow-purple-200/50",glowColor:"shadow-purple-400/50",textColor:"text-gray-900",badgeColor:"bg-purple-500",name:"エピック"};case"legendary":return{icon:Ut,gradient:"from-yellow-400 via-amber-500 to-orange-500",bgGradient:"from-white to-white",borderColor:"border-yellow-500",shadowColor:"shadow-yellow-200/50",glowColor:"shadow-yellow-400/60",textColor:"text-gray-900",badgeColor:"bg-gradient-to-r from-yellow-400 to-orange-500",name:"レジェンダリー"};default:return{icon:se,gradient:"from-gray-400 via-gray-500 to-gray-600",bgGradient:"from-white to-white",borderColor:"border-gray-400",shadowColor:"shadow-gray-200/50",glowColor:"shadow-gray-400/20",textColor:"text-gray-900",badgeColor:"bg-gray-500",name:"コモン"}}})(a.rarity),p={sm:{card:"p-2 min-h-[120px]",icon:"w-3 h-3",title:"text-xs font-bold",meaning:"text-xs",badge:"text-xs px-1.5 py-0.5",phonetic:"text-xs"},md:{card:"p-3 min-h-[140px]",icon:"w-4 h-4",title:"text-sm font-bold",meaning:"text-xs",badge:"text-xs px-2 py-1",phonetic:"text-xs"},lg:{card:"p-4 min-h-[160px]",icon:"w-5 h-5",title:"text-base font-bold",meaning:"text-sm",badge:"text-sm px-3 py-1",phonetic:"text-sm"}}[n];return e.jsxs(N,{className:J("relative overflow-hidden cursor-pointer border-2 transition-all duration-300","bg-white",n==="sm"?"!rounded-md":"!rounded-sm",g.borderColor,g.shadowColor,p.card,"hover:scale-105 hover:-translate-y-1",`hover:${g.glowColor}`,"hover:shadow-xl",c&&"transform-gpu",i&&"ring-2 ring-yellow-400 ring-opacity-75",s),onClick:t,children:[i&&e.jsx("div",{className:J("absolute top-2 z-10",d?"right-10":"right-2"),children:e.jsxs(D,{className:"bg-yellow-500 text-white text-xs animate-pulse",children:[e.jsx(ut,{className:"w-3 h-3 mr-1"}),"NEW"]})}),d&&e.jsx("button",{className:"absolute top-2 right-2 z-10 p-1 rounded-full hover:bg-black/10 transition-colors",onClick:b=>{b.stopPropagation(),d()},children:e.jsx(se,{className:J("w-4 h-4 transition-colors",o?"text-yellow-500 fill-yellow-500":"text-gray-400 hover:text-yellow-500")})}),e.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-between pt-2",children:[e.jsxs("div",{className:"text-center flex-1 flex flex-col justify-center space-y-2",children:[e.jsx("h3",{className:J(p.title,g.textColor,"line-clamp-1"),children:a.word}),a.phonetic&&e.jsx("p",{className:J(p.phonetic,"text-gray-500 font-mono"),children:a.phonetic}),e.jsx("p",{className:J(p.meaning,"text-gray-600 line-clamp-2"),children:a.meaning}),r&&a.partOfSpeech&&e.jsx("p",{className:"text-xs text-gray-500 italic",children:a.partOfSpeech})]}),r&&e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["#",a.id]})})]})]})}function Ir(){const a=ae(),[t]=Qt();ue();const s=t.get("cards"),n=t.get("packName")||"パック";let r=[];try{s&&(r=JSON.parse(decodeURIComponent(s)))}catch(i){console.error("Error parsing cards from URL:",i)}return r.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(N,{children:[e.jsx(R,{children:e.jsx(W,{className:"text-center text-red-600",children:"エラー: 開封結果が見つかりません"})}),e.jsx(I,{className:"text-center",children:e.jsx(w,{onClick:()=>a("/games/gacha"),children:"ガチャに戻る"})})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs(w,{variant:"outline",onClick:()=>a("/games/gacha"),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"ガチャに戻る"]})}),e.jsx(N,{className:"mb-8 bg-gradient-to-r from-yellow-100 to-orange-100 border-yellow-300",children:e.jsxs(R,{className:"text-center",children:[e.jsxs(W,{className:"text-3xl font-bold text-yellow-800 flex items-center justify-center gap-3",children:[e.jsx(ut,{className:"w-8 h-8"}),"🎉 ",n," 開封結果 🎉",e.jsx(ut,{className:"w-8 h-8"})]}),e.jsxs("p",{className:"text-lg text-yellow-700 mt-2",children:[r.length,"枚の新しいカードを獲得しました！"]})]})}),e.jsxs(N,{children:[e.jsxs(R,{children:[e.jsx(W,{className:"text-xl",children:"獲得したカード"}),e.jsx("p",{className:"text-gray-600",children:"カードをクリックすると詳細情報が見れます"})]}),e.jsx(I,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:r.map((i,c)=>e.jsx(Vs,{card:i,onClick:()=>a(`/games/gacha/card/${i.id}`),size:"md",showDetails:!0,isNew:!0,isAnimated:!0,isFavorite:!1,onFavoriteToggle:()=>{console.log(`Toggle favorite for card: ${i.word}`)},className:"hover:z-10 animate-bounce-in"},`${i.id}-${c}`))})})]}),e.jsxs("div",{className:"mt-8 text-center space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(w,{onClick:()=>a("/games/gacha"),size:"lg",className:"bg-purple-600 hover:bg-purple-700",children:"もう一度引く"}),e.jsx(w,{variant:"outline",onClick:()=>a("/learning/vocabulary/difficulty"),size:"lg",children:"語彙学習で使用する"}),e.jsx(w,{variant:"outline",onClick:()=>a("/"),size:"lg",children:"ホームに戻る"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"💡 獲得したカードは語彙学習で使用できます"})]})]})})}function Tr({cards:a,onCardClick:t,title:s="カードコレクション",showFilters:n=!0,showSearch:r=!0,className:i}){const[c,o]=l.useState(""),[d,h]=l.useState("name"),[g,v]=l.useState("asc"),[p,b]=l.useState("all"),[k,x]=l.useState("grid"),[m,f]=l.useState("2"),S={common:1,uncommon:2,rare:3,epic:4,legendary:5},j=a.filter(T=>{const u=T.word.toLowerCase().includes(c.toLowerCase())||T.meaning.toLowerCase().includes(c.toLowerCase()),y=p==="all"||T.rarity===p;return u&&y}).sort((T,u)=>{let y=0;switch(d){case"name":y=T.word.localeCompare(u.word);break;case"rarity":y=S[T.rarity]-S[u.rarity];break;case"recent":y=T.id-u.id;break}return g==="asc"?y:-y}),O=a.reduce((T,u)=>(T[u.rarity]=(T[u.rarity]||0)+1,T),{}),H={common:"コモン",uncommon:"アンコモン",rare:"レア",epic:"エピック",legendary:"レジェンダリー"},Z={common:"bg-gray-100 text-gray-700 border-gray-300",uncommon:"bg-green-100 text-green-700 border-green-300",rare:"bg-blue-100 text-blue-700 border-blue-300",epic:"bg-purple-100 text-purple-700 border-purple-300",legendary:"bg-yellow-100 text-yellow-700 border-yellow-300"};return e.jsxs("div",{className:J("space-y-6",i),children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s}),e.jsxs("p",{className:"text-gray-600",children:[j.length," / ",a.length," カード"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 border rounded-md p-1",children:[e.jsx(w,{variant:k==="grid"&&m==="2"?"default":"ghost",size:"sm",onClick:()=>{x("grid"),f("2")},className:"h-8 w-8 p-1",children:e.jsx(Ca,{className:"w-4 h-4"})}),e.jsx(w,{variant:k==="grid"&&m==="3"?"default":"ghost",size:"sm",onClick:()=>{x("grid"),f("3")},className:"h-8 w-8 p-1",children:e.jsx(Ia,{className:"w-4 h-4"})}),e.jsx(w,{variant:k==="list"?"default":"ghost",size:"sm",onClick:()=>x("list"),className:"h-8 w-8 p-1",children:e.jsx(Ta,{className:"w-4 h-4"})})]})})]}),n&&e.jsxs(N,{children:[e.jsx(R,{children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(_a,{className:"w-5 h-5"}),"フィルター・ソート"]})}),e.jsxs(I,{className:"space-y-4",children:[r&&e.jsxs("div",{className:"relative",children:[e.jsx(Aa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(wt,{placeholder:"カード名や意味で検索...",value:c,onChange:T=>o(T.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(D,{variant:p==="all"?"default":"outline",className:"cursor-pointer",onClick:()=>b("all"),children:["全て (",a.length,")"]}),Object.entries(O).map(([T,u])=>e.jsxs(D,{variant:p===T?"default":"outline",className:J("cursor-pointer",p===T?"":Z[T]),onClick:()=>b(T),children:[H[T]," (",u,")"]},T))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:d,onChange:T=>h(T.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"name",children:"名前順"}),e.jsx("option",{value:"rarity",children:"レアリティ順"}),e.jsx("option",{value:"recent",children:"取得順"})]}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>v(g==="asc"?"desc":"asc"),children:g==="asc"?e.jsx(Pa,{className:"w-4 h-4"}):e.jsx(Ea,{className:"w-4 h-4"})})]})]})]})]}),j.length===0?e.jsx(N,{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"該当するカードが見つかりませんでした"})}):e.jsx("div",{className:J("grid gap-2",k==="grid"?m==="2"?"grid-cols-2":"grid-cols-3":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"),children:j.map((T,u)=>e.jsx(Vs,{card:T,onClick:()=>t?.(T),size:k==="grid"&&m==="3"?"sm":"md",showDetails:k==="list",isAnimated:!0,isFavorite:!1,onFavoriteToggle:()=>{console.log(`Toggle favorite for card: ${T.word}`)},className:"hover:z-10"},`${T.id}-${u}`))})]})}const _r=({onBack:a,userXP:t,onXPChange:s})=>{const n=ae();ue();const[r,i]=l.useState(!1),[c,o]=l.useState(null),[d,h]=l.useState(he.getUserGachaData()),[g]=l.useState(he.getAvailablePacks()),[v,p]=l.useState(!1);l.useEffect(()=>{const m=()=>{const S=he.updateAvailablePacksCount(d);h(S)};m();const f=setInterval(m,3e4);return()=>clearInterval(f)},[]);const b=async m=>{const f=he.getPackById(m);if(!f)return;const S=he.canOpenPack(m,t);if(!S.canOpen){alert(S.reason);return}i(!0),o(m),await new Promise(j=>setTimeout(j,2e3));try{console.log("Opening pack:",m,"with userXP:",t);const j=he.openPackAndSave(m);console.log("Cards drawn:",j);const O=t-f.cost;console.log("Updating XP from",t,"to",O),s(O),console.log("Adding cards to vocabulary system..."),he.addToVocabularySystem(j),console.log("Updating user gacha data..."),h(he.getUserGachaData()),console.log("Pack opening completed successfully"),i(!1),o(null);const H=encodeURIComponent(JSON.stringify(j));n(`/games/gacha/result?cards=${H}&packName=${encodeURIComponent(f.name)}`)}catch(j){console.error("Error opening pack:",j),alert("ガチャの開封中にエラーが発生しました: "+(j instanceof Error?j.message:"不明なエラー")),console.error("Error details:",{packId:m,userXP:t,packCost:f.cost,error:j instanceof Error?j.message:String(j)}),alert(`パックの開封中にエラーが発生しました: ${j instanceof Error?j.message:String(j)}`),i(!1),o(null)}},k=m=>{switch(m){case"part1_2":return"🎧";case"part3_4":return"💬";case"part5_6":return"📝";case"part7":return"📖";case"mixed":return"🎯";default:return"📦"}},x=m=>{switch(m){case"400-500":return"bg-green-100 text-green-800";case"500-600":return"bg-blue-100 text-blue-800";case"600-700":return"bg-purple-100 text-purple-800";case"700-800":return"bg-orange-100 text-orange-800";case"800+":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>n("/"),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"戻る"]}),e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(ct,{className:"w-8 h-8 text-purple-600"}),"TOEIC単語ガチャ"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>p(!v),className:"flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4"}),v?"パック選択":"コレクション"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"所持XP"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t})]})]})]}),e.jsxs(N,{className:"p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"コレクション統計"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"総カード数"}),e.jsx("div",{className:"font-bold",children:d.collection.totalCards})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"ユニークカード"}),e.jsx("div",{className:"font-bold",children:d.collection.uniqueCards})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"開封パック数"}),e.jsx("div",{className:"font-bold",children:d.totalPacks})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"利用可能パック"}),e.jsxs("div",{className:"font-bold",children:[he.getAvailablePacksCount(d),"/2"]})]})]})]}),he.getAvailablePacksCount(d)<2&&e.jsx(N,{className:"mb-6",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-yellow-500"}),"パック回復システム"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"次のパック回復まで"}),e.jsx("span",{className:"font-bold text-purple-600",children:(()=>{const m=he.getNextPackRecoveryTime(d),f=Math.max(0,m-Date.now());return`${Math.ceil(f/(1e3*60))}分`})()})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"💡 5分ごとに1パック回復します（最大2パック）"}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>{localStorage.removeItem("userGachaData"),h(he.getUserGachaData())},className:"mt-2 text-xs",children:"🔄 テスト用リセット"})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:v?"所持カードコレクション":"パックを選択"}),v?e.jsx("div",{children:d.ownedCards.length===0?e.jsxs(N,{className:"text-center py-12",children:[e.jsx(ct,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"まだカードを所持していません"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"パックを開封してカードを集めよう！"}),e.jsx(w,{onClick:()=>p(!1),className:"bg-purple-600 hover:bg-purple-700",children:"パックを開封する"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-6 mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600",children:d.ownedCards.length}),e.jsx("div",{className:"text-xs text-gray-600",children:"総カード数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:d.collection.uniqueCards}),e.jsx("div",{className:"text-xs text-gray-600",children:"ユニークカード"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:d.ownedCards.filter(m=>m.rarity==="rare"||m.rarity==="epic"||m.rarity==="legendary").length}),e.jsx("div",{className:"text-xs text-gray-600",children:"レア以上"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-yellow-600",children:d.ownedCards.filter(m=>m.rarity==="legendary").length}),e.jsx("div",{className:"text-xs text-gray-600",children:"レジェンダリー"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:()=>p(!v),className:"text-xs",children:"全て"}),[{rarity:"common",name:"コモン",color:"text-gray-700 border-gray-400"},{rarity:"uncommon",name:"アンコモン",color:"text-green-700 border-green-500"},{rarity:"rare",name:"レア",color:"text-blue-700 border-blue-500"},{rarity:"epic",name:"エピック",color:"text-purple-700 border-purple-500"},{rarity:"legendary",name:"レジェンダリー",color:"text-yellow-700 border-yellow-500"}].map(({rarity:m,name:f,color:S})=>{const j=d.ownedCards.filter(O=>O.rarity===m).length;return e.jsxs(w,{variant:"outline",size:"sm",className:`text-xs ${S} border-2`,children:[f," (",j,")"]},m)})]}),e.jsx(Tr,{cards:d.ownedCards,onCardClick:m=>{console.log("Card clicked:",m)},title:"マイコレクション",showFilters:!0,showSearch:!0})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(m=>{const f=he.canOpenPack(m.id,t),S=m.rarity==="normal"?se:m.rarity==="premium"?He:Ut;return e.jsxs(N,{className:`p-4 transition-all hover:shadow-lg cursor-pointer ${c===m.id?"ring-2 ring-purple-500":""} ${f.canOpen?"":"opacity-60 cursor-not-allowed"}`,onClick:()=>f.canOpen&&!r&&b(m.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:k(m.theme)}),e.jsx(S,{className:"w-5 h-5 text-purple-600"})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(m.targetScore)}`,children:m.targetScore})]}),e.jsx("h3",{className:"font-bold text-lg mb-1",children:m.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:m.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[m.cost," XP"]}),e.jsx("div",{className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${f.canOpen&&!r?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500"}`,children:r&&c===m.id?"開封中...":f.canOpen?"クリックして開封":"開封不可"})]}),!f.canOpen&&e.jsxs("div",{className:"text-xs text-red-600 mt-2",children:[f.reason,f.nextPackTime&&e.jsxs("div",{className:"mt-1 text-gray-500",children:["次の回復:"," ",(()=>{const j=Math.max(0,f.nextPackTime-Date.now());return`${Math.ceil(j/(1e3*60))}分後`})()]})]})]},m.id)})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg text-center",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"パックを開封中..."}),e.jsx("p",{className:"text-gray-600",children:"素晴らしいカードが待っています！"})]})})]})};function Ar(){const a=ae(),[t,s]=l.useState(1e3);l.useEffect(()=>{try{const c=V().userLevel.xp;console.log("Initial XP loaded:",c),s(c||1e3)}catch(i){console.error("Error getting initial XP:",i),s(1e3)}},[]);const n=i=>{console.log("handleXPChange called with:",i),s(i);try{const c=V(),o=c.userLevel.xp;console.log("Current XP in manager:",o,"Setting to:",i);const d=i-o;d!==0&&c.addXP(d),de(),console.log("XP updated successfully")}catch(c){console.error("Error updating XP:",c)}},r=()=>{a("/")};return e.jsx(_r,{onBack:r,userXP:t,onXPChange:n})}function Pr(){const a=ae();ue();const t={totalXP:0,preStudySessions:[]},n=(()=>{const h=(t.preStudySessions||[]).filter(u=>u.completed&&u.comprehensionRating);if(h.length===0)return{averageComprehension:0,comprehensionImprovement:0,totalStudyDays:0,recentImprovement:0,categoryProgress:{},streakGrowth:0,learningConsistency:0,actualLearningTime:0,confidenceScore:0};const g=h.slice(-10),v=h.slice(0,10),p=g.reduce((u,y)=>u+(y.comprehensionRating||0),0)/g.length,b=v.length>0?v.reduce((u,y)=>u+(y.comprehensionRating||0),0)/v.length:p,k=p-b,m=new Set(h.map(u=>new Date(u.startTime).toDateString())).size,f={};h.forEach(u=>{const y=u.contentId.split("_")[1]||"unknown";f[y]||(f[y]={count:0,avgRating:0}),f[y].count++,f[y].avgRating+=u.comprehensionRating||0}),Object.keys(f).forEach(u=>{f[u].avgRating/=f[u].count});const S=t.currentStreak,j=h.reduce((u,y)=>{const $=y.endTime?(y.endTime-y.startTime)/1e3/60:3;return u+$},0),O=j/h.length,H=Math.min(O/3,1),Z=1-(Math.max(...h.map(u=>u.comprehensionRating||0))-Math.min(...h.map(u=>u.comprehensionRating||0)))/4,T=(H+Z)/2;return{averageComprehension:p,comprehensionImprovement:k,totalStudyDays:m,recentImprovement:p,categoryProgress:f,streakGrowth:t.currentStreak,learningConsistency:S,actualLearningTime:j,confidenceScore:T}})(),i=(d=>d>=1.5?{level:"S",color:"from-purple-500 to-pink-500",text:"ネイティブレベル！"}:d>=1?{level:"A",color:"from-green-500 to-emerald-500",text:"ビジネス英語OK！"}:d>=.5?{level:"B",color:"from-blue-500 to-cyan-500",text:"日常会話できます！"}:d>=0?{level:"C",color:"from-yellow-500 to-orange-500",text:"基礎は完璧！"}:{level:"D",color:"from-gray-500 to-slate-500",text:"基礎固め中"})(n.comprehensionImprovement),o=(d=>d>=4.5?"英検1級レベル！ネイティブと対等に話せます":d>=4?"英検準1級レベル！ビジネス英語で活躍できます":d>=3.5?"英検2級レベル！日常会話は完璧です":d>=3?"英検3級レベル！基本的な会話ができます":d>=2.5?"英検4級レベル！簡単な会話ができます":d>=2?"英検5級レベル！挨拶と自己紹介ができます":"基礎学習中！一緒に頑張りましょう")(n.averageComprehension);return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-8",children:[e.jsx("button",{onClick:()=>a("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:"← 戻る"}),e.jsxs("h1",{className:"text-2xl font-bold flex items-center",children:[e.jsx(et,{className:"w-6 h-6 mr-2 text-green-600"}),"成長ダッシュボード"]}),e.jsx("div",{className:"w-10"})]}),e.jsx(N,{className:"bg-gradient-to-r from-green-50 to-blue-50 border-0 shadow-lg",children:e.jsx(I,{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-br ${i.color} mb-4`,children:e.jsx("span",{className:"text-2xl font-bold text-white",children:i.level})}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:i.text}),e.jsxs("p",{className:"text-gray-600",children:["理解度向上: ",n.comprehensionImprovement>0?"+":"",n.comprehensionImprovement.toFixed(1),"ポイント"]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(N,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white border-0 shadow-lg",children:e.jsxs(I,{className:"p-4 text-center",children:[e.jsx(Ue,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:n.averageComprehension.toFixed(1)}),e.jsx("div",{className:"text-sm opacity-90",children:"現在の理解度"}),e.jsx("div",{className:"text-xs opacity-75 mt-1",children:o})]})}),e.jsx(N,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white border-0 shadow-lg",children:e.jsxs(I,{className:"p-4 text-center",children:[e.jsx(Ra,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:n.totalStudyDays}),e.jsx("div",{className:"text-sm opacity-90",children:"学習日数"})]})}),e.jsx(N,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white border-0 shadow-lg",children:e.jsxs(I,{className:"p-4 text-center",children:[e.jsx(je,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:t.currentStreak}),e.jsx("div",{className:"text-sm opacity-90",children:"連続学習日"})]})}),e.jsx(N,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white border-0 shadow-lg",children:e.jsxs(I,{className:"p-4 text-center",children:[e.jsx(Gt,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold",children:t.totalXP}),e.jsx("div",{className:"text-sm opacity-90",children:"総獲得XP"})]})})]}),e.jsxs(N,{className:"border-0 shadow-lg",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(Bt,{className:"w-5 h-5 mr-2 text-blue-600"}),"理解度の向上"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"理解度向上率"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[n.comprehensionImprovement>0?"+":"",n.comprehensionImprovement.toFixed(1),"ポイント"]})]}),e.jsx(be,{value:Math.min(Math.max((n.comprehensionImprovement+2)*25,0),100),className:"h-3"}),e.jsx("div",{className:"text-sm text-gray-500",children:n.comprehensionImprovement>0?`🎉 素晴らしい！${n.comprehensionImprovement.toFixed(1)}ポイント向上！${o}`:n.comprehensionImprovement===0?`✨ ${o}`:`💪 ${o}`})]})})]}),e.jsxs(N,{className:"border-0 shadow-lg",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(Ue,{className:"w-5 h-5 mr-2 text-purple-600"}),"学習の信頼度分析"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.confidenceScore.toFixed(1)}),e.jsx("div",{className:"text-sm text-gray-600",children:"信頼度スコア"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:n.confidenceScore>=.8?"高信頼度":n.confidenceScore>=.6?"中信頼度":"要改善"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[n.actualLearningTime.toFixed(0),"分"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"総学習時間"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"実際に学習した時間"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[n.learningConsistency,"日"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"連続学習"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"学習の一貫性"})]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"💡 信頼度の説明"}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsxs("div",{children:["• ",e.jsx("strong",{children:"学習時間"}),": 実際に学習した時間が長いほど信頼度が上がります"]}),e.jsxs("div",{children:["• ",e.jsx("strong",{children:"評価の一貫性"}),": 理解度評価が安定しているほど信頼度が上がります"]}),e.jsxs("div",{children:["• ",e.jsx("strong",{children:"継続性"}),": 連続学習日数が多いほど信頼度が上がります"]})]})]}),n.confidenceScore<.6&&e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"⚠️ 理解度評価の改善提案"}),e.jsxs("div",{className:"text-sm text-red-700 space-y-1",children:[e.jsxs("div",{children:["• 理解度評価は",e.jsx("strong",{children:"正直に"}),"行いましょう"]}),e.jsxs("div",{children:["• 分からない場合は",e.jsx("strong",{children:"星1-2"}),"を選んでください"]}),e.jsxs("div",{children:["• 低い評価でも",e.jsx("strong",{children:"復習の機会"}),"として活用できます"]}),e.jsxs("div",{children:["• 正確な評価が",e.jsx("strong",{children:"真の成長"}),"につながります"]})]})]})]})})]}),Object.keys(n.categoryProgress).length>0&&e.jsxs(N,{className:"border-0 shadow-lg",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx(se,{className:"w-5 h-5 mr-2 text-yellow-600"}),"分野別スキル向上"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-4",children:Object.entries(n.categoryProgress).map(([d,h])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium capitalize",children:d}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[h.count,"回学習"]}),e.jsxs(D,{variant:"secondary",children:["平均 ",h.avgRating.toFixed(1),"★"]})]})]}),e.jsx(be,{value:h.avgRating/5*100,className:"h-2"})]},d))})})]}),e.jsxs(N,{className:"border-0 shadow-lg",children:[e.jsx(R,{children:e.jsxs(W,{className:"flex items-center",children:[e.jsx($e,{className:"w-5 h-5 mr-2 text-indigo-600"}),"学習の軌跡"]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:"1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"初回学習"}),e.jsx("div",{className:"text-sm text-gray-600",children:t.preStudySessions?.[0]?new Date(t.preStudySessions[0].startTime).toLocaleDateString():"まだ学習していません"})]})]}),e.jsx(D,{variant:"outline",children:"スタート"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:n.totalStudyDays}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"現在の学習日数"}),e.jsx("div",{className:"text-sm text-gray-600",children:"継続的な学習を続けています"})]})]}),e.jsx(D,{variant:"default",children:"継続中"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-sm font-bold",children:"★"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"理解度向上"}),e.jsx("div",{className:"text-sm text-gray-600",children:n.comprehensionImprovement>0?`${n.comprehensionImprovement.toFixed(1)}ポイント向上`:"安定した理解度を維持"})]})]}),e.jsx(D,{variant:"secondary",children:n.comprehensionImprovement>0?"成長中":"安定"})]})]})})]}),e.jsx(N,{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border-0 shadow-lg",children:e.jsxs(I,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center",children:[e.jsx(je,{className:"w-5 h-5 mr-2 text-orange-600"}),"次の目標"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"英検1級レベル達成"}),e.jsx(be,{value:n.averageComprehension/5*100,className:"w-32 h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"連続学習30日"}),e.jsx(be,{value:t.currentStreak/30*100,className:"w-32 h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"総学習日100日"}),e.jsx(be,{value:n.totalStudyDays/100*100,className:"w-32 h-2"})]})]})]})})]})})}function Er(){const a=ae(),[t,s]=l.useState(null),[n,r]=l.useState(null),[i,c]=l.useState(!0);l.useEffect(()=>{setTimeout(()=>{const h=At.generateLearningInsight(),g=At.getAnalytics();s(h),r(g),c(!1)},1500)},[]);const o=h=>{switch(h){case"効率重視型":return"bg-blue-500";case"探求型":return"bg-purple-500";case"競争型":return"bg-red-500";case"創造型":return"bg-green-500";default:return"bg-gray-500"}},d=h=>{switch(h){case"効率重視型":return e.jsx(je,{className:"w-6 h-6"});case"探求型":return e.jsx(Ue,{className:"w-6 h-6"});case"競争型":return e.jsx(et,{className:"w-6 h-6"});case"創造型":return e.jsx(qe,{className:"w-6 h-6"});default:return e.jsx(se,{className:"w-6 h-6"})}};return i?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>a("/"),className:"p-2",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"学習分析中..."}),e.jsx("div",{className:"w-9"})]}),e.jsx(N,{className:"border-0 shadow-lg",children:e.jsxs(I,{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"あなたの学習パターンを分析中"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"学習データから個人の特性を解析しています..."}),e.jsx(be,{value:75,className:"mt-4 h-2"})]})})]})}):!t||!n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:e.jsx("div",{className:"max-w-md mx-auto text-center pt-20",children:e.jsx("p",{children:"分析データを読み込めませんでした"})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>a("/"),className:"p-2",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"あなたの学習インサイト"}),e.jsx("div",{className:"w-9"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{className:"border-0 shadow-lg overflow-hidden",children:[e.jsx("div",{className:`h-2 ${o(t.learnerType)}`}),e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-full ${o(t.learnerType)} text-white`,children:d(t.learnerType)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold",children:t.learnerType}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["信頼度 ",Math.round(t.confidenceScore*100),"%"]})]})]})}),e.jsxs(I,{children:[e.jsx("p",{className:"text-sm text-gray-700 mb-3",children:t.uniquePattern}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["最終分析:"," ",new Date(t.lastAnalyzed).toLocaleDateString()]}),e.jsx(D,{variant:"outline",className:"text-xs",children:"ENTP最適化"})]})]})]}),e.jsxs(N,{className:"border-0 shadow-md",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(se,{className:"w-5 h-5 mr-2 text-yellow-500"}),"あなたの強み"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-2",children:t.primaryStrengths.map((h,g)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:h})]},g))})})]}),t.improvementAreas.length>0&&e.jsxs(N,{className:"border-0 shadow-md",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(et,{className:"w-5 h-5 mr-2 text-blue-500"}),"成長ポイント"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-2",children:t.improvementAreas.map((h,g)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm",children:h})]},g))})})]}),e.jsxs(N,{className:"border-0 shadow-md",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(qe,{className:"w-5 h-5 mr-2 text-green-500"}),"あなた専用のアドバイス"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-3",children:t.personalizedRecommendations.map((h,g)=>e.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-green-800",children:h})]})},g))})})]}),e.jsxs(N,{className:"border-0 shadow-md",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(Ue,{className:"w-5 h-5 mr-2 text-purple-500"}),"学習統計"]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.totalStudySessions}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"学習セッション"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(n.averageAccuracy*100),"%"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"平均正解率"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"学習トレンド"}),e.jsx(D,{variant:n.improvementTrend==="上昇中"?"default":"secondary",className:"text-xs",children:n.improvementTrend})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium",children:"得意分野"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:n.strongestCategories.map((h,g)=>e.jsx(D,{variant:"outline",className:"text-xs capitalize",children:h},g))})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-4",children:[e.jsx(w,{variant:"outline",onClick:()=>a("/progress/achievements"),className:"h-12",children:"実績を見る"}),e.jsx(w,{onClick:()=>a("/"),className:"h-12 bg-gradient-to-r from-blue-500 to-purple-500",children:"学習を始める"})]}),e.jsx("div",{className:"h-8"})]})]})})}const Ke={"basic-grammar":{easy:[{id:1,japanese:"私は学生です。",correctAnswer:"I am a student.",explanation:'「私は～です」は "I am ~" で表現します。',choices:["I am a student.","I am student.","I'm the student.","I was a student."]},{id:2,japanese:"彼は医者です。",correctAnswer:"He is a doctor.",explanation:'三人称単数の主語には "is" を使います。',choices:["He is a doctor.","He are a doctor.","He am a doctor.","He was a doctor."]},{id:3,japanese:"私たちは友達です。",correctAnswer:"We are friends.",explanation:'複数の主語には "are" を使います。',choices:["We are friends.","We is friends.","We am friends.","We were friends."]},{id:4,japanese:"彼女は忙しいです。",correctAnswer:"She is busy.",explanation:"形容詞を使った文では be動詞が必要です。",choices:["She is busy.","She busy.","She are busy.","She has busy."]},{id:5,japanese:"私は本を読みます。",correctAnswer:"I read a book.",explanation:"一般動詞の現在形では、一人称は動詞の原形を使います。",choices:["I read a book.","I reads a book.","I am read a book.","I reading a book."]},{id:6,japanese:"彼は音楽を聞きます。",correctAnswer:"He listens to music.",explanation:"三人称単数では動詞に -s をつけます。",choices:["He listens to music.","He listen to music.","He is listen to music.","He listening to music."]},{id:7,japanese:"私たちは学校に行きます。",correctAnswer:"We go to school.",explanation:"複数の主語では動詞の原形を使います。",choices:["We go to school.","We goes to school.","We are go to school.","We going to school."]},{id:8,japanese:"この花は美しいです。",correctAnswer:"This flower is beautiful.",explanation:'"This" は単数なので be動詞は "is" を使います。',choices:["This flower is beautiful.","This flower are beautiful.","This flowers is beautiful.","This flower beautiful."]},{id:9,japanese:"私は日本人です。",correctAnswer:"I am Japanese.",explanation:"国籍を表すときも be動詞を使います。",choices:["I am Japanese.","I am a Japanese.","I Japanese.","I from Japanese."]},{id:10,japanese:"猫は魚が好きです。",correctAnswer:"Cats like fish.",explanation:"一般的な事実を表すときは現在形を使います。",choices:["Cats like fish.","Cats likes fish.","Cats are like fish.","Cat like fish."]}],normal:[{id:11,japanese:"私は毎日学校に歩いて行きます。",correctAnswer:"I walk to school every day.",explanation:"習慣を表す現在形では、副詞句で時間を表現します。",hint:"walk, school, every day"},{id:12,japanese:"彼女は先生になりたがっています。",correctAnswer:"She wants to be a teacher.",explanation:'"want to + 動詞" で「～したい」を表現します。',hint:"wants, to be, teacher"},{id:13,japanese:"私たちの学校にはたくさんの生徒がいます。",correctAnswer:"There are many students in our school.",explanation:'存在を表す "There are" を使い、複数形に注意します。',hint:"There are, many students, our school"},{id:14,japanese:"その問題はとても難しくありません。",correctAnswer:"The problem is not very difficult.",explanation:`be動詞の否定形は "is not" または "isn't" を使います。`,hint:"problem, is not, very difficult"},{id:15,japanese:"彼は英語と数学を勉強しています。",correctAnswer:"He studies English and math.",explanation:'三人称単数の現在形では "studies" (y→ies) となります。',hint:"studies, English, math"},{id:16,japanese:"私の兄は大学で働いています。",correctAnswer:"My brother works at a university.",explanation:'場所を表すときは前置詞 "at" を使います。',hint:"brother, works, university"},{id:17,japanese:"この本は私のものではありません。",correctAnswer:"This book is not mine.",explanation:'所有代名詞 "mine" を使い、否定形で表現します。',hint:"book, is not, mine"},{id:18,japanese:"彼らは週末によく映画を見ます。",correctAnswer:"They often watch movies on weekends.",explanation:'頻度を表す副詞 "often" は動詞の前に置きます。',hint:"often, watch movies, weekends"},{id:19,japanese:"私の母は料理がとても上手です。",correctAnswer:"My mother is very good at cooking.",explanation:'"be good at + 動名詞" で「～が上手」を表現します。',hint:"mother, very good at, cooking"},{id:20,japanese:"その犬は公園を走り回っています。",correctAnswer:"The dog runs around in the park.",explanation:"現在の習慣的行動は現在形で表現します。",hint:"dog, runs around, park"}],hard:[{id:21,japanese:"彼が成功する理由は、常に努力を怠らないことです。",correctAnswer:"The reason why he succeeds is that he never stops making efforts.",explanation:'"The reason why ~ is that..." で理由を強調する構文です。'},{id:22,japanese:"私たちの町には古い伝統を大切にする人々がたくさんいます。",correctAnswer:"There are many people in our town who cherish old traditions.",explanation:'"There are + 名詞 + 関係代名詞" の構文で存在と修飾を同時に表現します。'},{id:23,japanese:"彼女の笑顔は見る人すべてを幸せな気持ちにします。",correctAnswer:"Her smile makes everyone who sees it feel happy.",explanation:'"make + 人 + 動詞" で「人に～させる」を表現します。'},{id:24,japanese:"この店で働くスタッフは皆親切で、お客様に丁寧に対応します。",correctAnswer:"All the staff who work at this store are kind and treat customers politely.",explanation:"関係代名詞と副詞を使って複雑な文を構成しています。"},{id:25,japanese:"私が毎朝することは、新聞を読んで世界のニュースを知ることです。",correctAnswer:"What I do every morning is read the newspaper and learn about world news.",explanation:'"What I do is ~" という構文で行動の内容を強調します。'},{id:26,japanese:"彼の話し方には、聞く人の心を動かす何かがあります。",correctAnswer:"There is something in the way he speaks that moves listeners' hearts.",explanation:'"There is something ~ that..." で抽象的な存在を表現します。'},{id:27,japanese:"私たちが住んでいる地球は、宇宙の中でかけがえのない存在です。",correctAnswer:"The Earth we live on is an irreplaceable existence in the universe.",explanation:"関係代名詞の省略形と形容詞を使った表現です。"},{id:28,japanese:"彼女が持っている才能は、多くの人々に影響を与える力があります。",correctAnswer:"The talent she has has the power to influence many people.",explanation:'関係代名詞の省略と "have the power to" の構文を使います。'},{id:29,japanese:"この問題を解決する方法は、みんなで協力することしかありません。",correctAnswer:"The only way to solve this problem is for everyone to cooperate.",explanation:'"The only way to ~ is for 人 to..." という構文です。'},{id:30,japanese:"人生において大切なことは、常に学び続ける姿勢を持つことだと思います。",correctAnswer:"I think what is important in life is to always have an attitude of continuous learning.",explanation:'"What is important is to ~" という主語節の構文を使います。'}]},tenses:{easy:[{id:31,japanese:"私は昨日映画を見ました。",correctAnswer:"I watched a movie yesterday.",explanation:'過去のことは過去形を使います。"watch" の過去形は "watched" です。',choices:["I watched a movie yesterday.","I watch a movie yesterday.","I am watching a movie yesterday.","I have watched a movie yesterday."]},{id:32,japanese:"彼女は明日東京に行きます。",correctAnswer:"She will go to Tokyo tomorrow.",explanation:'未来のことは "will + 動詞の原形" で表現します。',choices:["She will go to Tokyo tomorrow.","She goes to Tokyo tomorrow.","She went to Tokyo tomorrow.","She is going to Tokyo tomorrow."]},{id:33,japanese:"私たちは今テレビを見ています。",correctAnswer:"We are watching TV now.",explanation:'現在進行形は "be動詞 + 動詞のing形" で表現します。',choices:["We are watching TV now.","We watch TV now.","We watched TV now.","We will watch TV now."]},{id:34,japanese:"彼は今朝早く起きました。",correctAnswer:"He got up early this morning.",explanation:'"get up" の過去形は "got up" です。',choices:["He got up early this morning.","He gets up early this morning.","He is getting up early this morning.","He will get up early this morning."]},{id:35,japanese:"私は来週友達に会う予定です。",correctAnswer:"I will meet my friend next week.",explanation:'未来の予定は "will" で表現できます。',choices:["I will meet my friend next week.","I meet my friend next week.","I met my friend next week.","I am meeting my friend next week."]},{id:36,japanese:"雨が降っています。",correctAnswer:"It is raining.",explanation:"現在の天候は現在進行形で表現します。",choices:["It is raining.","It rains.","It rained.","It will rain."]},{id:37,japanese:"私は毎日朝食を食べます。",correctAnswer:"I eat breakfast every day.",explanation:"習慣は現在形で表現します。",choices:["I eat breakfast every day.","I ate breakfast every day.","I am eating breakfast every day.","I will eat breakfast every day."]},{id:38,japanese:"彼らは昨日パーティーを楽しみました。",correctAnswer:"They enjoyed the party yesterday.",explanation:"過去の出来事は過去形を使います。",choices:["They enjoyed the party yesterday.","They enjoy the party yesterday.","They are enjoying the party yesterday.","They will enjoy the party yesterday."]},{id:39,japanese:"私は今宿題をしています。",correctAnswer:"I am doing my homework now.",explanation:"現在進行中のことは現在進行形を使います。",choices:["I am doing my homework now.","I do my homework now.","I did my homework now.","I will do my homework now."]},{id:40,japanese:"明日は日曜日です。",correctAnswer:"Tomorrow is Sunday.",explanation:"未来でも確定した事実は現在形を使います。",choices:["Tomorrow is Sunday.","Tomorrow will be Sunday.","Tomorrow was Sunday.","Tomorrow being Sunday."]}],normal:[{id:41,japanese:"私は3年間英語を勉強しています。",correctAnswer:"I have been studying English for three years.",explanation:'継続を表す現在完了進行形を使います。期間は "for" で表現します。',hint:"have been studying, English, three years"},{id:42,japanese:"彼は先週からずっと忙しくしています。",correctAnswer:"He has been busy since last week.",explanation:'開始点からの継続は "since" を使います。',hint:"has been busy, since, last week"},{id:43,japanese:"私たちがそこに着いたとき、雨が降り始めました。",correctAnswer:"When we arrived there, it started to rain.",explanation:"時を表す副詞節では過去形を使います。",hint:"when, arrived, started, rain"},{id:44,japanese:"彼女は今までに多くの国を訪れたことがあります。",correctAnswer:"She has visited many countries so far.",explanation:"経験を表す現在完了形を使います。",hint:"has visited, many countries, so far"},{id:45,japanese:"私は明日の今頃、飛行機の中にいるでしょう。",correctAnswer:"I will be on a plane at this time tomorrow.",explanation:"未来のある時点での状態は未来進行形を使います。",hint:"will be, plane, this time tomorrow"},{id:46,japanese:"彼は昨日の夜、ずっと勉強していました。",correctAnswer:"He was studying all night last night.",explanation:"過去のある時点での継続は過去進行形を使います。",hint:"was studying, all night, last night"},{id:47,japanese:"私たちは来月までにこのプロジェクトを完成させる予定です。",correctAnswer:"We will have finished this project by next month.",explanation:"未来のある時点での完了は未来完了形を使います。",hint:"will have finished, project, by next month"},{id:48,japanese:"彼女は5歳のときから ピアノを弾いています。",correctAnswer:"She has been playing the piano since she was five years old.",explanation:"過去のある時点からの継続は現在完了進行形を使います。",hint:"has been playing, piano, since, five years old"},{id:49,japanese:"私は昨日その本を読み終えました。",correctAnswer:"I finished reading the book yesterday.",explanation:"過去の完了した行為は過去形を使います。",hint:"finished reading, book, yesterday"},{id:50,japanese:"彼らは来年結婚する予定です。",correctAnswer:"They are going to get married next year.",explanation:'予定を表すときは "be going to" も使えます。',hint:"are going to, get married, next year"}],hard:[{id:51,japanese:"彼が到着するまでに、私たちはすべての準備を終えているでしょう。",correctAnswer:"By the time he arrives, we will have finished all the preparations.",explanation:'"By the time" は時を表す副詞節で、未来完了と組み合わせます。'},{id:52,japanese:"もし昨日雨が降らなかったら、私たちはピクニックに行ったでしょう。",correctAnswer:"If it had not rained yesterday, we would have gone on a picnic.",explanation:"仮定法過去完了で、過去の事実と反対の仮定を表現します。"},{id:53,japanese:"彼女は会議が始まる前に、すでに資料を準備していました。",correctAnswer:"She had already prepared the materials before the meeting started.",explanation:"過去完了形で、過去のある時点より前の完了を表現します。"},{id:54,japanese:"私が子供の頃は、毎年夏に祖父母の家を訪れていました。",correctAnswer:"When I was a child, I used to visit my grandparents' house every summer.",explanation:'"used to" で過去の習慣を表現します。'},{id:55,japanese:"来週の今頃、私たちは新しいオフィスで働いているでしょう。",correctAnswer:"This time next week, we will be working in our new office.",explanation:"未来進行形で、未来のある時点での進行中の動作を表現します。"},{id:56,japanese:"彼は長年の間、その問題について考え続けてきました。",correctAnswer:"He has been thinking about that problem for many years.",explanation:"現在完了進行形で、過去から現在まで続く動作を表現します。"},{id:57,japanese:"その時点で、私たちはすでに5時間も待っていたのです。",correctAnswer:"At that point, we had already been waiting for five hours.",explanation:"過去完了進行形で、過去のある時点までの継続を表現します。"},{id:58,japanese:"彼が説明を終える頃には、みんな理解しているでしょう。",correctAnswer:"By the time he finishes explaining, everyone will have understood.",explanation:"時の副詞節と未来完了の組み合わせです。"},{id:59,japanese:"もし私があの時もっと勉強していたら、今頃もっと良い仕事に就いていたでしょう。",correctAnswer:"If I had studied harder at that time, I would have a better job now.",explanation:"混合仮定法で、過去の仮定と現在の帰結を表現します。"},{id:60,japanese:"彼女は卒業するまでに、すでに3年間そのプロジェクトに取り組んでいるでしょう。",correctAnswer:"By the time she graduates, she will have been working on that project for three years.",explanation:"未来完了進行形で、未来のある時点までの継続期間を表現します。"}]},modals:{easy:[{id:61,japanese:"私は泳ぐことができます。",correctAnswer:"I can swim.",explanation:'能力を表すときは "can" を使います。',choices:["I can swim.","I can to swim.","I can swimming.","I am can swim."]}],normal:[{id:71,japanese:"私は明日までにレポートを提出しなければなりません。",correctAnswer:"I have to submit my report by tomorrow.",explanation:'外部からの義務は "have to" を使うことが多いです。',hint:"have to submit, report, by tomorrow"}],hard:[{id:81,japanese:"彼は約束を守ったはずなのに、来ませんでした。",correctAnswer:"He should have kept his promise, but he didn't come.",explanation:'"should have + 過去分詞" で過去にすべきだったことを表現します。'}]},passive:{easy:[{id:91,japanese:"この本は多くの人に読まれています。",correctAnswer:"This book is read by many people.",explanation:'受動態は "be動詞 + 過去分詞" で作ります。',choices:["This book is read by many people.","This book reads by many people.","This book is reading by many people.","This book was read by many people."]}],normal:[{id:101,japanese:"この建物は1950年に建てられました。",correctAnswer:"This building was built in 1950.",explanation:'過去の受動態で年を表すときは "in" を使います。',hint:"building, was built, 1950"}],hard:[{id:111,japanese:"その決定が下される前に、すべての選択肢が検討されていました。",correctAnswer:"All options had been considered before the decision was made.",explanation:"過去完了の受動態で、時系列を明確にします。"}]},relative:{easy:[{id:121,japanese:"私には英語を話す友達がいます。",correctAnswer:"I have a friend who speaks English.",explanation:'人を修飾するときは関係代名詞 "who" を使います。',choices:["I have a friend who speaks English.","I have a friend which speaks English.","I have a friend that speak English.","I have a friend who speak English."]}],normal:[{id:131,japanese:"私が昨日会った人は有名な作家でした。",correctAnswer:"The person whom I met yesterday was a famous writer.",explanation:'目的格の関係代名詞は "whom" を使います（"who" でも可）。',hint:"person, whom, met yesterday, famous writer"}],hard:[{id:141,japanese:"彼が言ったことは、私たちが予想していたことと全く異なっていました。",correctAnswer:"What he said was completely different from what we had expected.",explanation:'関係代名詞 "what" は「～すること」を表し、先行詞を含みます。'}]},subjunctive:{easy:[{id:151,japanese:"もし明日雨が降ったら、家にいます。",correctAnswer:"If it rains tomorrow, I will stay at home.",explanation:"現在の仮定では、if節は現在形、主節は未来形を使います。",choices:["If it rains tomorrow, I will stay at home.","If it will rain tomorrow, I stay at home.","If it rained tomorrow, I will stay at home.","If it rains tomorrow, I stayed at home."]}],normal:[{id:161,japanese:"もし昨日雨が降らなかったら、ピクニックに行ったでしょう。",correctAnswer:"If it had not rained yesterday, we would have gone on a picnic.",explanation:'仮定法過去完了では、if節は過去完了、主節は "would have + 過去分詞" を使います。',hint:"had not rained, would have gone, picnic"}],hard:[{id:171,japanese:"もし彼があの時違う決断をしていたら、今頃は全く違う人生を送っていたでしょう。",correctAnswer:"If he had made a different decision at that time, he would be living a completely different life now.",explanation:"混合仮定法：過去の仮定の条件と現在の仮定の結果を組み合わせます。"}]},comparison:{easy:[{id:181,japanese:"彼は私より背が高いです。",correctAnswer:"He is taller than me.",explanation:'比較級は "形容詞 + er + than" で表現します。',choices:["He is taller than me.","He is more tall than me.","He is tall than me.","He is taller then me."]}],normal:[{id:191,japanese:"この課題は私が思っていたよりもずっと難しいです。",correctAnswer:"This assignment is much more difficult than I thought.",explanation:'比較級を強調するときは "much" を使います。',hint:"much more difficult, than I thought"}],hard:[{id:201,japanese:"彼の成功は、才能よりもむしろ努力の結果です。",correctAnswer:"His success is more a result of effort than of talent.",explanation:'"more A than B" で「BというよりむしろA」を表現します。'}]},participle:{easy:[{id:211,japanese:"私は走っている男の子を見ました。",correctAnswer:"I saw a boy running.",explanation:"現在分詞 (-ing) で進行中の動作を修飾します。",choices:["I saw a boy running.","I saw a boy run.","I saw a boy ran.","I saw a boy to run."]}],normal:[{id:221,japanese:"駅に向かって走りながら、彼は時計を見ました。",correctAnswer:"Running towards the station, he looked at his watch.",explanation:"分詞構文で同時動作を表現します。",hint:"Running towards, station, looked at watch"}],hard:[{id:231,japanese:"長年の経験を積んだ結果、彼は専門家として認められるようになりました。",correctAnswer:"Having accumulated years of experience, he came to be recognized as an expert.",explanation:"完了分詞構文と受動態の組み合わせです。"}]},infinitive:{easy:[{id:241,japanese:"私は英語を勉強したいです。",correctAnswer:"I want to study English.",explanation:'"want" の後は不定詞 "to + 動詞の原形" を使います。',choices:["I want to study English.","I want study English.","I want studying English.","I want studied English."]}],normal:[{id:251,japanese:"私は彼に英語を教えてもらいました。",correctAnswer:"I had him teach me English.",explanation:'使役動詞 "have" の後は原形不定詞（to なし）を使います。',hint:"had him teach, English"}],hard:[{id:261,japanese:"彼は問題を解決したと言われています。",correctAnswer:"He is said to have solved the problem.",explanation:'"be said to have + 過去分詞" で完了の不定詞を使った伝聞表現です。'}]}};function Gs(a,t){if(console.log("=== getQuestions called ==="),console.log("category:",a),console.log("difficulty:",t),console.log("questionsByCategory keys:",Object.keys(Ke)),console.log("category exists in data:",a in Ke),!(a in Ke))return console.error("Category not found:",a),[];const s=Ke[a];if(console.log("difficulty exists in category:",t in s),!(t in s))return console.error("Difficulty not found for category:",a,t),[];const n=s[t];return console.log("Found questions:",n.length),n||[]}const Rr={"basic-grammar":"基本文型",tenses:"時制",modals:"助動詞",passive:"受動態",relative:"関係詞",subjunctive:"仮定法",comparison:"比較",participle:"分詞・動名詞",infinitive:"不定詞"},Dr={easy:"簡単",normal:"普通",hard:"難しい"};function Lr(){const a=ae(),{category:t,difficulty:s}=ze();ue();const n=t,r=s,[i,c]=l.useState(0),[o,d]=l.useState([]),[h,g]=l.useState(0),[v,p]=l.useState(!1),[b,k]=l.useState(""),[x,m]=l.useState("");if(l.useEffect(()=>{if(n&&r)try{const u=Gs(n,r);d(u)}catch(u){console.error("問題データの取得に失敗:",u),a("/learning/grammar/category")}},[n,r,a]),!n||!r||o.length===0)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"問題を読み込んでいます..."}),e.jsx(w,{onClick:()=>a("/learning/grammar/category"),children:"カテゴリー選択に戻る"})]})})});const f=o[i],S=i+1,j=o.length,O=u=>{if(u===f.correctAnswer&&g(h+1),i<o.length-1)c(i+1);else{p(!0);const $=V(),z=Math.round(h*10+j*2);$.addXP(z)}},H=()=>{a(`/learning/grammar/difficulty/${n}`)},Z=()=>{const u=r==="easy"?b:x;u.trim()&&(O(u),k(""),m(""))},T=r==="easy"?b:x.trim();return v?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-100 p-4",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(N,{className:"shadow-lg",children:[e.jsx(R,{children:e.jsx(W,{className:"text-center text-2xl",children:"問題完了！"})}),e.jsxs(I,{className:"text-center",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-xl mb-2",children:["正解数: ",h," / ",j]}),e.jsxs("p",{className:"text-lg text-gray-600",children:["正解率: ",Math.round(h/j*100),"%"]}),e.jsxs(D,{className:"mt-2",children:["+",Math.round(h*10+j*2)," XP獲得！"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{onClick:()=>a("/learning/grammar/category"),className:"w-full",children:"カテゴリー選択に戻る"}),e.jsx(w,{variant:"outline",onClick:()=>a("/"),className:"w-full",children:"ホームに戻る"})]})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:H,className:"flex items-center",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"文法クイズ"}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-2",children:[e.jsx(D,{variant:"outline",className:"text-xs",children:Rr[n]}),e.jsx(D,{variant:"outline",className:"text-xs",children:Dr[r]})]})]}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["問題 ",S," / ",j]}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["スコア: ",h]})]}),e.jsx(be,{value:S/j*100,className:"h-2"})]}),e.jsxs(N,{className:"mb-6 shadow-lg",children:[e.jsx(R,{children:e.jsx(W,{className:"text-lg font-semibold text-gray-800",children:f.japanese})}),e.jsxs(I,{children:[r==="easy"?e.jsx("div",{className:"space-y-3",children:f.choices?.map((u,y)=>e.jsx(w,{variant:b===u?"default":"outline",className:"w-full text-left justify-start p-4 h-auto",onClick:()=>k(u),children:u},y))}):e.jsxs("div",{children:[e.jsx(Xe,{placeholder:"英語で回答してください...",value:x,onChange:u=>m(u.target.value),className:"min-h-[120px] mb-4"}),e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["ヒント:"," ",f.hint||"文法に注意して回答してください"]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsx(w,{onClick:Z,disabled:!T,className:"w-full",children:"回答する"})})]})]})]})})}const Mr={"basic-grammar":"基本文型",tenses:"時制",modals:"助動詞",passive:"受動態",relative:"関係詞",subjunctive:"仮定法",comparison:"比較",participle:"分詞・動名詞",infinitive:"不定詞"},Or={easy:"簡単",normal:"普通",hard:"難しい"};function Hr(){const a=ae(),{category:t,difficulty:s}=ze();ue();const n=t,r=s,i=[],c=[],o=c.filter(p=>p.isCorrect).length,d=Math.round(o/i.length*100),h=Ha(c,r,n),g=()=>d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600",v=()=>d>=80?"素晴らしい！":d>=60?"よくできました！":"もう少し頑張りましょう！";return e.jsx("div",{className:"min-h-screen p-4",children:e.jsxs("div",{className:"max-w-md mx-auto w-full space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{variant:"ghost",onClick:()=>a("/"),className:"p-2",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",children:"結果"}),e.jsx("div",{className:"w-10"})]}),e.jsx(N,{children:e.jsxs(R,{className:"text-center",children:[e.jsx(W,{children:"結果発表"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`text-4xl ${g()}`,children:[o," / ",i.length]}),e.jsxs("div",{className:`text-xl ${g()}`,children:[d,"%"]}),e.jsx("p",{className:"text-muted-foreground",children:v()}),e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx(D,{variant:"outline",children:Mr[n]}),e.jsx(D,{variant:"outline",children:Or[r]})]}),h>0&&e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-3 p-2 bg-yellow-50 rounded-lg",children:[e.jsx(se,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("span",{className:"text-yellow-700 font-medium",children:["+",h," XP 獲得！"]})]})]})]})}),e.jsxs(N,{children:[e.jsx(R,{children:e.jsx(W,{children:"解答と解説"})}),e.jsx(I,{className:"space-y-4",children:i.map((p,b)=>{const k=c.find(m=>m.questionId===p.id),x=k?.isCorrect||!1;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:["問題 ",b+1]}),e.jsx(D,{variant:x?"default":"destructive",children:x?"正解":"不正解"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:p.japanese}),k&&e.jsxs("div",{className:"p-2 bg-muted rounded text-sm",children:[e.jsx("span",{className:"font-medium",children:"あなたの回答："}),e.jsx("br",{}),k.answer]}),e.jsxs("div",{className:"p-2 bg-green-50 border border-green-200 rounded text-sm",children:[e.jsx("span",{className:"font-medium text-green-800",children:"正解："}),e.jsx("br",{}),e.jsx("span",{className:"text-green-700",children:p.correctAnswer})]}),e.jsxs("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded text-sm",children:[e.jsx("span",{className:"font-medium text-blue-800",children:"解説："}),e.jsx("br",{}),e.jsx("span",{className:"text-blue-700",children:p.explanation})]})]}),b<i.length-1&&e.jsx(bt,{})]},p.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(w,{onClick:()=>a(`/learning/grammar/question/${n}/${r}`),className:"w-full",size:"lg",children:"同じ設定でもう一度"}),e.jsx(w,{onClick:()=>a(`/learning/grammar/difficulty/${n}`),variant:"outline",className:"w-full",size:"lg",children:"難易度を変更"}),e.jsx(w,{onClick:()=>a("/learning/grammar/category"),variant:"outline",className:"w-full",size:"lg",children:"カテゴリーを変更"})]})]})})}function $r(){const{contentId:a}=ze(),t=ae(),[s,n]=l.useState(0),[r,i]=l.useState(!1),c=Kt.find(v=>v.id===a);if(!c)return t("/"),null;const o=()=>{i(!0)},d=()=>{c.category&&t("/learning/grammar/category")},h=()=>{t("/learning/pre-study/menu")},g=(v,p)=>e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(b=>e.jsx("button",{onClick:()=>p(b),className:`text-2xl ${b<=v?"text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition-colors`,children:"★"},b))});return r?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(N,{className:"shadow-lg",children:[e.jsxs(R,{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"✨"}),e.jsx(W,{className:"text-2xl text-gray-900 mb-2",children:"学習完了！"}),e.jsx("h3",{className:"text-lg text-gray-700",children:c.title})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(N,{className:"bg-blue-50 border-blue-200",children:e.jsx(I,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsxs("span",{children:["推定時間: ",Math.ceil(c.duration/60),"分"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{variant:"outline",children:c.category}),e.jsxs(D,{variant:"outline",children:["Level ",c.level]})]})]})})}),e.jsxs(N,{children:[e.jsx(R,{children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-yellow-600"}),"理解度を評価してください（任意）"]})}),e.jsx(I,{children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[g(s,n),e.jsxs("div",{className:"text-sm text-gray-600 text-center",children:[s===0&&"評価なしでも問題演習に進めます",s===5&&"完全に理解できました！",s===4&&"ほぼ理解できました",s===3&&"何となく理解できました",s===2&&"少し理解できました",s===1&&"あまり理解できませんでした"]})]})})]}),e.jsx(N,{className:"bg-green-50 border-green-200",children:e.jsxs(I,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(je,{className:"w-5 h-5 text-green-600"}),e.jsx("h5",{className:"font-semibold text-green-800",children:"関連問題で実践してみませんか？"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"今学んだ内容を問題演習で定着させましょう。"})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(w,{onClick:d,className:"flex-1",size:"lg",children:"♥ 問題演習へ"}),e.jsx(w,{onClick:h,variant:"outline",className:"flex-1",size:"lg",children:"他の学習"})]})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(N,{className:"shadow-lg",children:[e.jsx(R,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:h,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"戻る"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-6 h-6 text-purple-600"}),e.jsxs("div",{children:[e.jsx(W,{className:"text-xl",children:c.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(D,{variant:"outline",className:"text-xs",children:["Level ",c.level]}),e.jsx(D,{variant:"outline",className:"text-xs",children:c.category}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx($e,{className:"w-3 h-3"}),Math.ceil(c.duration/60),"分"]})]})]})]})]})})}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(N,{className:"bg-gray-50",children:e.jsx(I,{className:"p-4",children:e.jsx("div",{className:"prose prose-blue max-w-none",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:c.content.replace(/\n/g,"<br>")}})})})}),c.examples&&c.examples.length>0&&e.jsxs(N,{className:"bg-yellow-50 border-yellow-200",children:[e.jsx(R,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-yellow-600"}),"例文"]})}),e.jsx(I,{children:e.jsx("div",{className:"space-y-3",children:c.examples.map((v,p)=>e.jsx(N,{className:"bg-white",children:e.jsxs(I,{className:"p-3",children:[e.jsx("div",{className:"font-medium text-gray-900",children:v.english}),e.jsx("div",{className:"text-gray-600 text-sm mt-1",children:v.japanese}),v.explanation&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(Ge,{className:"w-3 h-3"}),v.explanation]})]})},p))})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(w,{onClick:o,size:"lg",className:"px-8",children:"✓ 学習完了"})})]})]})})})}const Ot=({content:a,isLocked:t=!1,isCompleted:s=!1,onSelect:n})=>{const r=i=>{switch(i){case"theory":return"💡";case"explanation":return"📚";case"background":return"🔬";case"strategy":return"🎯";default:return"📖"}};return e.jsx(ie,{id:a.id,title:a.title,description:`⭐️ ${a.category}`,detail:`理論学習 - ${a.contentType}`,icon:r(a.contentType),difficulty:a.difficulty,level:a.level,duration:`${Math.ceil(a.duration/60)}分`,category:a.category,keyPoints:a.keyPoints,isLocked:t,isCompleted:s,onClick:n})};function qr(){const a=ae();ue();const s=V().getLevel(),n=typeof s=="object"?s.level||1:s||1,r=Ua(n),i=xe.getPreStudyProgress(),c=i.completedContents;console.log("PreStudyMenu - Debug Info:",{userLevel:n,availableContentsCount:r.length,completedContents:c,preStudyProgress:i});const[o,d]=l.useState("all"),[h,g]=l.useState("all"),v=Array.from(new Set(r.map(x=>x.category))),p=Array.from(new Set(r.map(x=>x.level))).sort((x,m)=>x-m),b=l.useMemo(()=>r.filter(x=>{const m=o==="all"||x.category===o,f=h==="all"||x.level.toString()===h,S=x.level<=n;return m&&f&&S}),[r,o,h,n]),k=l.useMemo(()=>b.find(x=>!c.includes(x.id)&&x.level<=n),[b,c,n]);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(w,{variant:"outline",onClick:()=>a("/"),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"戻る"]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2 justify-center",children:[e.jsx("span",{children:"📚"}),"事前学習"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"理論を理解してから実践へ"})]}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("select",{value:o,onChange:x=>d(x.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg bg-white shadow-sm hover:border-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",children:[e.jsx("option",{value:"all",children:"すべてのカテゴリ"}),v.map(x=>e.jsx("option",{value:x,children:x},x))]}),e.jsxs("select",{value:h,onChange:x=>g(x.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg bg-white shadow-sm hover:border-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",children:[e.jsx("option",{value:"all",children:"すべてのレベル"}),p.map(x=>e.jsxs("option",{value:x.toString(),children:["Level ",x]},x))]})]}),k&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"🎯 推奨コンテンツ"}),e.jsx(Ot,{content:k,isCompleted:c.includes(k.id),onSelect:x=>a(`/learning/pre-study/content/${x}`)})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"📖 利用可能なコンテンツ"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:b.map(x=>e.jsx(Ot,{content:x,isLocked:x.level>n,isCompleted:c.includes(x.id),onSelect:m=>a(`/learning/pre-study/content/${m}`)},x.id))}),b.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📚"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"該当するコンテンツがありません"}),e.jsx("p",{className:"text-gray-600",children:"フィルターを変更するか、レベルアップして新しいコンテンツを解放しましょう。"})]})]})]})})}function zr(){const a=ae();ue();const[t,s]=l.useState([]),[n,r]=l.useState(0),[i,c]=l.useState(0),[o,d]=l.useState(0),[h,g]=l.useState(0),[v,p]=l.useState(0),[b,k]=l.useState(!1),[x,m]=l.useState(!1),[f,S]=l.useState(""),[j,O]=l.useState(!1),[H,Z]=l.useState(!1),[T,u]=l.useState({gachaVocabCount:0,grammarCategoriesStudied:0});l.useEffect(()=>{try{const L=he.getUserGachaData();u({gachaVocabCount:L.ownedCards.length,grammarCategoriesStudied:3})}catch(L){console.log("相乗効果データの取得に失敗:",L)}},[]);const y=()=>{const L=[];try{const _=he.getUserGachaData(),Y=_.ownedCards.slice(0,6);Y.length>0&&Y.forEach((q,ne)=>{const me=_.ownedCards.filter(re=>re.id!==q.id).slice(0,3);me.length>=3&&L.push({id:`gacha-${q.id}`,type:"vocabulary",question:`「${q.meaning}」を英語で言うと？`,options:[q.word,...me.map(re=>re.word)].sort(()=>Math.random()-.5),correctAnswer:q.word,explanation:`ガチャ語彙: ${q.word} - ${q.meaning}`,timeLimit:8})})}catch(_){console.log("ガチャ語彙の取得に失敗:",_)}if(["basic-grammar","tenses","modals"].forEach(_=>{L.length<10&&Gs(_,"easy").slice(0,2).forEach(q=>{L.push({id:`grammar-${_}-${q.id}`,type:"grammar",question:q.japanese,options:q.choices,correctAnswer:q.correctAnswer,explanation:`文法復習: ${q.explanation}`,timeLimit:12})})}),L.length<10){const _=Da("beginner","all"),q=La.filterUnknownWords(_).slice(0,10-L.length);q.forEach((ne,me)=>{L.push({id:`vocab-${1e3+me}`,type:"vocabulary",question:`「${ne.japanese}」を英語で言うと？`,options:[ne.word,q[(me+1)%q.length].word,q[(me+2)%q.length].word,q[(me+3)%q.length].word].sort(()=>Math.random()-.5),correctAnswer:ne.word,explanation:ne.meaning,timeLimit:10})})}return L.sort(()=>Math.random()-.5).slice(0,10)},$=()=>{if(!V().consumeHeart()){alert("体力が不足しています。回復を待ってから再試行してください。"),a("/");return}const U=y();s(U),r(0),d(0),g(0),p(0),k(!0),m(!1),O(!1),U.length>0&&c(U[0].timeLimit),de()};l.useEffect(()=>{if(!b||x)return;const L=setInterval(()=>{c(U=>U<=1?(z(""),0):U-1)},1e3);return()=>clearInterval(L)},[b,x]);const z=L=>{if(!b||j)return;const U=t[n],_=L===U.correctAnswer;if(Z(_),O(!0),_){const Y=h+1;g(Y),p(re=>Math.max(re,Y));const q=100,ne=Math.min(Y*10,100),me=Math.max(i*2,0);d(re=>re+q+ne+me)}else g(0);setTimeout(()=>{n+1>=t.length?(m(!0),k(!1),K()):(r(Y=>Y+1),c(t[n+1].timeLimit),O(!1),S(""))},2e3)},K=()=>{const L=Math.floor(o/10),U={date:new Date().toISOString().split("T")[0],type:"time-attack",score:o,maxCombo:v,questionsAnswered:n+1,xpEarned:L,duration:0};xe.recordLearningSession(U)},le=t[n];return x?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{variant:"ghost",onClick:()=>a("/"),className:"p-2",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"タイムアタック結果"}),e.jsx("div",{className:"w-10"})]}),e.jsx(N,{className:"text-center border-0 shadow-lg bg-gradient-to-br from-yellow-50 to-orange-50",children:e.jsxs(I,{className:"p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏆"}),e.jsx("h2",{className:"text-3xl font-bold text-orange-800 mb-2",children:"タイムアタック完了！"}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"スコア"}),e.jsx("span",{className:"text-2xl font-bold text-orange-600",children:o.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"最大コンボ"}),e.jsx("span",{className:"text-2xl font-bold text-red-600",children:v})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"正解数"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:n+1})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-white rounded-lg",children:[e.jsx("span",{className:"font-medium",children:"獲得XP"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:Math.floor(o/10)})]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(w,{onClick:$,className:"w-full",size:"lg",children:"もう一度挑戦"}),e.jsx(w,{onClick:()=>a("/"),variant:"outline",className:"w-full",children:"ホームに戻る"})]})]})})]})}):b?e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{variant:"ghost",onClick:()=>a("/"),className:"p-2",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"タイムアタック"}),e.jsx("div",{className:"w-10"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"スコア"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.toLocaleString()})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"コンボ"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:h})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"問題"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[n+1,"/10"]})]})]}),e.jsx(N,{className:"border-0 shadow-lg",children:e.jsxs(I,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"残り時間"}),e.jsx("span",{className:`text-2xl font-bold ${i<=5?"text-red-600":"text-blue-600"}`,children:i})]}),e.jsx(be,{value:i/le.timeLimit*100,className:`h-2 ${i<=5?"bg-red-200":"bg-blue-200"}`})]})}),le&&e.jsxs(N,{className:"border-0 shadow-lg",children:[e.jsx(R,{children:e.jsx(W,{className:"text-center",children:le.type==="grammar"?"文法問題":"単語問題"})}),e.jsxs(I,{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-muted rounded-lg text-center",children:e.jsx("p",{className:"text-lg",children:le.question})}),j&&e.jsxs("div",{className:`p-4 rounded-lg text-center ${H?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[e.jsx("p",{className:"font-bold text-lg",children:H?"正解！":"不正解"}),H&&e.jsxs("p",{className:"text-sm mt-1",children:["+",100+Math.min(h*10,100)+Math.max(i*2,0)," ","ポイント"]})]}),!j&&le.options&&e.jsx("div",{className:"space-y-2",children:le.options.map((L,U)=>e.jsxs(w,{variant:f===L?"default":"outline",className:"w-full justify-start h-auto p-3 text-left",onClick:()=>{S(L),z(L)},children:[String.fromCharCode(65+U),". ",L]},U))})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-orange-50",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{variant:"ghost",onClick:()=>a("/"),className:"p-2",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:"タイムアタック"}),e.jsx("div",{className:"w-10"})]}),e.jsx(N,{className:"text-center border-0 shadow-lg bg-gradient-to-br from-red-50 to-orange-50",children:e.jsxs(I,{className:"p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"⚡"}),e.jsx("h2",{className:"text-2xl font-bold text-red-800 mb-4",children:"タイムアタックモード"}),e.jsx("p",{className:"text-gray-700 mb-6",children:"制限時間内に連続で正解を重ねて高スコアを目指そう！"}),e.jsxs("div",{className:"space-y-3 text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($e,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{children:"各問題に制限時間あり"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wt,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{children:"連続正解でコンボボーナス"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(He,{className:"w-5 h-5 text-yellow-600"}),e.jsx("span",{children:"残り時間でタイムボーナス"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{children:"10問連続で挑戦"})]})]}),e.jsx(w,{onClick:$,className:"w-full mt-8",size:"lg",children:"スタート！"})]})})]})})}function Fr(){const a=ae(),[t]=Qt(),s=t.get("difficulty")||"intermediate";ue();const n=[{id:"all",title:"すべて",description:"全レベルの単語をランダムに学習",detail:"初級から上級まで幅広いレベルの単語",color:"bg-gray-50 border-gray-200 text-gray-800",difficulty:"全レベル",wordCount:"130個の単語",examples:["reliable","accomplish","sophisticated"]},{id:"toeic",title:"TOEIC頻出",description:"TOEIC試験でよく出る単語",detail:"TOEIC試験で頻繁に出題されるビジネス単語",color:"bg-orange-50 border-orange-200 text-orange-800",difficulty:"中級",wordCount:"20個の単語",examples:["revenue","budget","deadline","contract"]},{id:"daily",title:"日常会話",description:"日常会話でよく使われる単語",detail:"友達との会話や日常的な表現で使用される単語",color:"bg-green-50 border-green-200 text-green-800",difficulty:"初級",wordCount:"15個の単語",examples:["awesome","amazing","fantastic","wonderful"]}];return e.jsx("div",{className:"min-h-screen p-4 flex flex-col justify-center",children:e.jsxs("div",{className:"max-w-md mx-auto w-full space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>a("/learning/vocabulary/difficulty"),children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h1",{className:"text-3xl",children:"カテゴリ選択"}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(D,{variant:"outline",className:"text-sm",children:"単語学習"})})]})]}),e.jsx("p",{className:"text-center text-muted-foreground",children:"カテゴリを選択してください"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:n.map(r=>e.jsx(ie,{id:r.id,title:r.title,description:r.description,detail:r.detail,difficulty:r.difficulty,color:r.color,keyPoints:[`例: ${r.examples.join(", ")}`,r.wordCount],onClick:i=>{a(`/learning/vocabulary/study/${s}/${i}`)}},r.id))})]})})}function Br(){const a=ae();ue();const t=[{level:"beginner",title:"初級",description:"基本的な日常会話でよく使われる単語",detail:"I am / You are / He has など基本的な単語",color:"bg-green-50 border-green-200 text-green-800",difficulty:"初級",wordCount:"約20個の単語",examples:["reliable","confident","important","beautiful"]},{level:"intermediate",title:"中級",description:"ビジネスや日常でよく使われる単語",detail:"ビジネスシーンや日常会話で頻繁に使用される単語",color:"bg-blue-50 border-blue-200 text-blue-800",difficulty:"中級",wordCount:"約50個の単語",examples:["accomplish","opportunity","effective","professional"]},{level:"advanced",title:"上級",description:"ビジネス、学術、専門的な単語",detail:"学術論文や専門分野で使用される高度な単語",color:"bg-purple-50 border-purple-200 text-purple-800",difficulty:"上級",wordCount:"約30個の単語",examples:["sophisticated","comprehensive","methodology","infrastructure"]}];return e.jsx("div",{className:"min-h-screen p-4 flex flex-col justify-center",children:e.jsxs("div",{className:"max-w-md mx-auto w-full space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>a("/"),children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h1",{className:"text-3xl",children:"難易度選択"}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx(D,{variant:"outline",className:"text-sm",children:"単語学習"})})]})]}),e.jsx("p",{className:"text-center text-muted-foreground",children:"難易度を選択してください"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.map(s=>e.jsx(ie,{id:s.level,title:s.title,description:s.description,detail:s.detail,difficulty:s.difficulty,color:s.color,keyPoints:[`例: ${s.examples.join(", ")}`,s.wordCount],onClick:n=>{a(`/learning/vocabulary/category?difficulty=${n}`)}},s.level))})]})})}function Wr(){return e.jsxs(za,{children:[e.jsx(Zn,{}),e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs(Fa,{children:[e.jsx(ee,{path:"/",element:e.jsx(Jn,{})}),e.jsx(ee,{path:"/learning/vocabulary/difficulty",element:e.jsx(Br,{})}),e.jsx(ee,{path:"/learning/vocabulary/category",element:e.jsx(Fr,{})}),e.jsx(ee,{path:"/learning/vocabulary/study/:difficulty/:category",element:e.jsx(Ma,{})}),e.jsx(ee,{path:"/learning/grammar/category",element:e.jsx(or,{})}),e.jsx(ee,{path:"/learning/grammar/difficulty/:category",element:e.jsx(dr,{})}),e.jsx(ee,{path:"/learning/grammar/quiz/:category/:difficulty",element:e.jsx(wr,{})}),e.jsx(ee,{path:"/learning/grammar/question/:category/:difficulty",element:e.jsx(Lr,{})}),e.jsx(ee,{path:"/learning/grammar/results/:category/:difficulty",element:e.jsx(Hr,{})}),e.jsx(ee,{path:"/learning/pre-study/menu",element:e.jsx(qr,{})}),e.jsx(ee,{path:"/learning/pre-study/content/:contentId",element:e.jsx($r,{})}),e.jsx(ee,{path:"/learning/combined-test",element:e.jsx(Oa,{})}),e.jsx(ee,{path:"/learning/time-attack",element:e.jsx(zr,{})}),e.jsx(ee,{path:"/learning/essay-writing",element:e.jsx(Cr,{})}),e.jsx(ee,{path:"/games/tower-defense",element:e.jsx(Ba,{})}),e.jsx(ee,{path:"/games/gacha",element:e.jsx(Ar,{})}),e.jsx(ee,{path:"/games/gacha/result",element:e.jsx(Ir,{})}),e.jsx(ee,{path:"/games/gacha/card/:cardId",element:e.jsx(ir,{})}),e.jsx(ee,{path:"/progress/achievements",element:e.jsx($a,{})}),e.jsx(ee,{path:"/progress/dashboard",element:e.jsx(Pr,{})}),e.jsx(ee,{path:"/progress/insights",element:e.jsx(Er,{})}),e.jsx(ee,{path:"/settings/app",element:e.jsx(rr,{})}),e.jsx(ee,{path:"*",element:e.jsx(Wa,{to:"/",replace:!0})})]})})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(a=>{console.log("SW registered: ",a)}).catch(a=>{console.log("SW registration failed: ",a)})});Ga.createRoot(document.getElementById("root")).render(e.jsx(Wr,{}));export{Kr as n};
