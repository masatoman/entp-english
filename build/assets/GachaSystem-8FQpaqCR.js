import{r as g,j as e}from"./ui-CztJLv2w.js";import{B as j,C as y}from"./game-C2GAOMMb.js";import{A as k,J as D,S as f,Y as U,j as E,Z as I}from"./learning-BkojZQE-.js";import"./vendor-D3F3s8fL.js";import"./progress-BLXY-nml.js";const b=[{id:1,word:"meeting",meaning:"会議、打ち合わせ",partOfSpeech:"名詞",phonetic:"/ˈmiːtɪŋ/",rarity:"common",examples:[{sentence:"The meeting will start at 9 AM.",translation:"会議は午前9時に始まります。",situation:"TOEIC Part2 (時間・スケジュール)"}],combinations:[{type:"collocation",expression:"attend a meeting",meaning:"会議に出席する",example:"All employees must attend the meeting.",translation:"全従業員が会議に出席しなければならない。"}],commonUsages:[{pattern:"have/hold a meeting",explanation:"会議を開く",example:"We will hold a meeting tomorrow."}],toeicSpecific:{parts:["Part1","Part2","Part3"],frequency:"very_high",scoreBand:"400-500",synonyms:["conference","assembly"],businessContext:"オフィス環境での基本語彙"}},{id:2,word:"schedule",meaning:"スケジュール、予定表",partOfSpeech:"名詞",phonetic:"/ˈʃedjuːl/",rarity:"common",examples:[{sentence:"Please check the schedule for next week.",translation:"来週のスケジュールを確認してください。",situation:"TOEIC Part2 (スケジュール確認)"}],combinations:[{type:"collocation",expression:"on schedule",meaning:"予定通りに",example:"The project is on schedule.",translation:"プロジェクトは予定通りに進んでいます。"}],commonUsages:[{pattern:"behind/ahead of schedule",explanation:"予定より遅れて/早く",example:"We are ahead of schedule."}],toeicSpecific:{parts:["Part1","Part2","Part3"],frequency:"very_high",scoreBand:"400-500",synonyms:["timetable","agenda"],businessContext:"時間管理の基本語彙"}},{id:3,word:"deadline",meaning:"締切、期限",partOfSpeech:"名詞",phonetic:"/ˈdedlaɪn/",rarity:"common",examples:[{sentence:"The deadline for the report is Friday.",translation:"レポートの締切は金曜日です。",situation:"TOEIC Part2 (期限の確認)"}],combinations:[{type:"collocation",expression:"meet a deadline",meaning:"締切に間に合わせる",example:"We need to meet the deadline.",translation:"締切に間に合わせる必要があります。"}],commonUsages:[{pattern:"extend the deadline",explanation:"締切を延長する",example:"Can we extend the deadline?"}],toeicSpecific:{parts:["Part1","Part2","Part3"],frequency:"very_high",scoreBand:"400-500",synonyms:["due date","cutoff"],businessContext:"プロジェクト管理の基本語彙"}},{id:4,word:"negotiate",meaning:"交渉する、協議する",partOfSpeech:"動詞",phonetic:"/nɪˈɡoʊʃieɪt/",rarity:"uncommon",examples:[{sentence:"We need to negotiate the contract terms.",translation:"契約条件を交渉する必要があります。",situation:"TOEIC Part3 (ビジネス交渉)"}],combinations:[{type:"collocation",expression:"negotiate a deal",meaning:"取引を交渉する",example:"They negotiated a better deal.",translation:"彼らはより良い取引を交渉しました。"}],commonUsages:[{pattern:"negotiate with someone",explanation:"誰かと交渉する",example:"We negotiated with the supplier."}],toeicSpecific:{parts:["Part3","Part4","Part7"],frequency:"high",scoreBand:"500-600",synonyms:["bargain","discuss"],businessContext:"ビジネス交渉の重要語彙"}},{id:5,word:"implement",meaning:"実施する、実行する",partOfSpeech:"動詞",phonetic:"/ˈɪmplɪment/",rarity:"uncommon",examples:[{sentence:"We will implement the new system next month.",translation:"来月新しいシステムを実施します。",situation:"TOEIC Part3 (システム導入)"}],combinations:[{type:"collocation",expression:"implement a plan",meaning:"計画を実行する",example:"The team implemented the marketing plan.",translation:"チームはマーケティング計画を実行しました。"}],commonUsages:[{pattern:"implement changes",explanation:"変更を実施する",example:"We need to implement changes."}],toeicSpecific:{parts:["Part3","Part4","Part7"],frequency:"high",scoreBand:"500-600",synonyms:["execute","carry out"],businessContext:"プロジェクト実行の重要語彙"}},{id:6,word:"acquisition",meaning:"買収、取得",partOfSpeech:"名詞",phonetic:"/ˌækwɪˈzɪʃən/",rarity:"rare",examples:[{sentence:"The acquisition will expand our market share.",translation:"この買収により市場シェアが拡大します。",situation:"TOEIC Part4 (企業買収発表)"}],combinations:[{type:"collocation",expression:"merger and acquisition",meaning:"合併・買収",example:"M&A activities increased this year.",translation:"今年はM&A活動が増加しました。"}],commonUsages:[{pattern:"acquisition of something",explanation:"何かの取得",example:"The acquisition of new technology."}],toeicSpecific:{parts:["Part4","Part7"],frequency:"medium",scoreBand:"600-700",synonyms:["purchase","takeover"],businessContext:"企業戦略の上級語彙"}},{id:7,word:"sustainable",meaning:"持続可能な、継続可能な",partOfSpeech:"形容詞",phonetic:"/səˈsteɪnəbəl/",rarity:"rare",examples:[{sentence:"We need sustainable business practices.",translation:"持続可能なビジネス慣行が必要です。",situation:"TOEIC Part4 (環境・CSR)"}],combinations:[{type:"collocation",expression:"sustainable development",meaning:"持続可能な開発",example:"Sustainable development is our priority.",translation:"持続可能な開発が私たちの優先事項です。"}],commonUsages:[{pattern:"sustainable growth",explanation:"持続可能な成長",example:"We aim for sustainable growth."}],toeicSpecific:{parts:["Part4","Part7"],frequency:"medium",scoreBand:"600-700",synonyms:["viable","enduring"],businessContext:"現代ビジネスの重要概念"}},{id:8,word:"leverage",meaning:"活用する、レバレッジをかける",partOfSpeech:"動詞",phonetic:"/ˈlevərɪdʒ/",rarity:"epic",examples:[{sentence:"We can leverage our technology to gain competitive advantage.",translation:"競争優位を得るために技術を活用できます。",situation:"TOEIC Part7 (戦略的提携)"}],combinations:[{type:"collocation",expression:"leverage resources",meaning:"リソースを活用する",example:"We need to leverage our resources effectively.",translation:"リソースを効果的に活用する必要があります。"}],commonUsages:[{pattern:"leverage something to do",explanation:"何かを活用して〜する",example:"We leverage data to improve services."}],toeicSpecific:{parts:["Part7"],frequency:"low",scoreBand:"700-800",synonyms:["utilize","exploit"],businessContext:"戦略的ビジネス用語"}},{id:9,word:"paradigm",meaning:"パラダイム、思考の枠組み",partOfSpeech:"名詞",phonetic:"/ˈpærədaɪm/",rarity:"legendary",examples:[{sentence:"This represents a paradigm shift in our industry.",translation:"これは私たちの業界におけるパラダイムシフトを表しています。",situation:"TOEIC Part7 (業界変革)"}],combinations:[{type:"collocation",expression:"paradigm shift",meaning:"パラダイムシフト",example:"The digital revolution caused a paradigm shift.",translation:"デジタル革命はパラダイムシフトを引き起こしました。"}],commonUsages:[{pattern:"new paradigm",explanation:"新しいパラダイム",example:"We need a new paradigm for success."}],toeicSpecific:{parts:["Part7"],frequency:"low",scoreBand:"800+",synonyms:["framework","model"],businessContext:"最高級ビジネス概念"}}],C=[{id:"toeic_beginner",name:"TOEIC基礎パック",description:"Part1-2でよく出る基本ビジネス語彙8枚",theme:"part1_2",targetScore:"400-500",cards:[],rarity:"normal",cost:100},{id:"toeic_intermediate",name:"TOEIC中級パック",description:"Part3-4の会話・説明文で頻出する語彙8枚",theme:"part3_4",targetScore:"500-600",cards:[],rarity:"premium",cost:200},{id:"toeic_advanced",name:"TOEIC上級パック",description:"Part5-6の文法・語彙問題で出る難語彙8枚",theme:"part5_6",targetScore:"600-700",cards:[],rarity:"premium",cost:300},{id:"toeic_reading",name:"TOEIC読解パック",description:"Part7の長文読解で重要な語彙8枚",theme:"part7",targetScore:"700-800",cards:[],rarity:"legendary",cost:500},{id:"toeic_mixed",name:"TOEIC総合パック",description:"全パートから厳選した語彙8枚",theme:"mixed",targetScore:"800+",cards:[],rarity:"legendary",cost:800}],h={rare:.15,epic:.04,legendary:.01};class m{static drawRandomCard(){const r=Math.random();let t;r<h.legendary?t="legendary":r<h.legendary+h.epic?t="epic":r<h.legendary+h.epic+h.rare?t="rare":r<.8?t="uncommon":t="common";const s=b.filter(n=>n.rarity===t);if(s.length===0){const n=b.filter(i=>i.rarity==="common");return n[Math.floor(Math.random()*n.length)]}return s[Math.floor(Math.random()*s.length)]}static openPack(r){const t=C.find(n=>n.id===r);if(!t)throw new Error(`Pack with id ${r} not found`);const s=[];for(let n=0;n<8;n++){let i=this.drawRandomCard();if(t.theme!=="mixed"){const c=b.filter(x=>x.toeicSpecific.parts.some(p=>t.theme==="part1_2"?["Part1","Part2"].includes(p):t.theme==="part3_4"?["Part3","Part4"].includes(p):t.theme==="part5_6"?["Part5","Part6"].includes(p):t.theme==="part7"?p==="Part7":!0));c.length>0&&(i=c[Math.floor(Math.random()*c.length)])}s.push(i)}return s}static getUserGachaData(){const r=localStorage.getItem("userGachaData");return r?JSON.parse(r):{ownedCards:[],totalPacks:0,dailyPacksUsed:0,lastPackDate:"",collection:{totalCards:0,uniqueCards:0,rarityStats:{}}}}static saveUserGachaData(r){localStorage.setItem("userGachaData",JSON.stringify(r))}static addCardsToCollection(r){const t=this.getUserGachaData(),s=new Date().toDateString();t.lastPackDate!==s&&(t.dailyPacksUsed=0,t.lastPackDate=s),r.forEach(n=>{t.ownedCards.find(c=>c.id===n.id)||t.ownedCards.push(n)}),t.collection.totalCards=t.ownedCards.length,t.collection.uniqueCards=t.ownedCards.length,t.collection.rarityStats={},t.ownedCards.forEach(n=>{t.collection.rarityStats[n.rarity]=(t.collection.rarityStats[n.rarity]||0)+1}),this.saveUserGachaData(t)}static openPackAndSave(r){const t=this.openPack(r);this.addCardsToCollection(t);const s=this.getUserGachaData();return s.totalPacks++,s.dailyPacksUsed++,this.saveUserGachaData(s),t}static getAvailablePacks(){return C}static getPackById(r){return C.find(t=>t.id===r)}static canOpenPack(r,t){const s=this.getPackById(r);if(!s)return{canOpen:!1,reason:"パックが見つかりません"};if(t<s.cost)return{canOpen:!1,reason:`XPが不足しています (必要: ${s.cost}, 現在: ${t})`};const n=this.getUserGachaData(),i=new Date().toDateString();return n.lastPackDate===i&&n.dailyPacksUsed>=5?{canOpen:!1,reason:"本日のパック開封回数上限に達しています"}:{canOpen:!0}}static addToVocabularySystem(r){const{DataManager:t}=require("./dataManager");t.addGachaWordsToVocabulary(r),console.log("Added gacha cards to vocabulary system:",r)}}const A=({onBack:P,userXP:r,onXPChange:t})=>{const[s,n]=g.useState([]),[i,c]=g.useState(!1),[x,p]=g.useState(null),[u,w]=g.useState(m.getUserGachaData()),[N]=g.useState(m.getAvailablePacks()),v=a=>{switch(a){case"common":return{icon:f,color:"text-gray-500",bgColor:"bg-gray-100",borderColor:"border-gray-300"};case"uncommon":return{icon:f,color:"text-green-500",bgColor:"bg-green-100",borderColor:"border-green-300"};case"rare":return{icon:I,color:"text-blue-500",bgColor:"bg-blue-100",borderColor:"border-blue-300"};case"epic":return{icon:E,color:"text-purple-500",bgColor:"bg-purple-100",borderColor:"border-purple-300"};case"legendary":return{icon:U,color:"text-yellow-500",bgColor:"bg-yellow-100",borderColor:"border-yellow-300"};default:return{icon:f,color:"text-gray-500",bgColor:"bg-gray-100",borderColor:"border-gray-300"}}},S=async a=>{const l=m.getPackById(a);if(!l)return;const o=m.canOpenPack(a,r);if(!o.canOpen){alert(o.reason);return}c(!0),p(a),await new Promise(d=>setTimeout(d,2e3));try{const d=m.openPackAndSave(a);n(d),t(r-l.cost),m.addToVocabularySystem(d),w(m.getUserGachaData())}catch(d){console.error("Error opening pack:",d),alert("パックの開封中にエラーが発生しました")}c(!1)},O=a=>{switch(a){case"part1_2":return"🎧";case"part3_4":return"💬";case"part5_6":return"📝";case"part7":return"📖";case"mixed":return"🎯";default:return"📦"}},T=a=>{switch(a){case"400-500":return"bg-green-100 text-green-800";case"500-600":return"bg-blue-100 text-blue-800";case"600-700":return"bg-purple-100 text-purple-800";case"700-800":return"bg-orange-100 text-orange-800";case"800+":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:P,className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"戻る"]}),e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(D,{className:"w-8 h-8 text-purple-600"}),"TOEIC単語ガチャ"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"所持XP"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r})]})]}),e.jsxs(y,{className:"p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"コレクション統計"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"総カード数"}),e.jsx("div",{className:"font-bold",children:u.collection.totalCards})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"ユニークカード"}),e.jsx("div",{className:"font-bold",children:u.collection.uniqueCards})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"開封パック数"}),e.jsx("div",{className:"font-bold",children:u.totalPacks})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-600",children:"本日開封数"}),e.jsxs("div",{className:"font-bold",children:[u.dailyPacksUsed,"/5"]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"パックを選択"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(a=>{const l=m.canOpenPack(a.id,r),o=v(a.rarity==="normal"?"common":a.rarity==="premium"?"rare":"legendary").icon;return e.jsxs(y,{className:`p-4 transition-all hover:shadow-lg ${x===a.id?"ring-2 ring-purple-500":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:O(a.theme)}),e.jsx(o,{className:"w-5 h-5 text-purple-600"})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T(a.targetScore)}`,children:a.targetScore})]}),e.jsx("h3",{className:"font-bold text-lg mb-1",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[a.cost," XP"]}),e.jsx(j,{onClick:()=>S(a.id),disabled:i||!l.canOpen,className:"bg-purple-600 hover:bg-purple-700",children:i&&x===a.id?"開封中...":"開封"})]}),!l.canOpen&&e.jsx("div",{className:"text-xs text-red-600 mt-2",children:l.reason})]},a.id)})})]}),s.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"開封結果"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4",children:s.map((a,l)=>{const o=v(a.rarity),d=o.icon;return e.jsxs(y,{className:`p-3 text-center transition-all hover:scale-105 ${o.bgColor} ${o.borderColor} border-2`,children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx(d,{className:`w-5 h-5 ${o.color}`})}),e.jsx("h4",{className:"font-bold text-sm mb-1",children:a.word}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:a.meaning}),e.jsx("div",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${o.bgColor} ${o.color}`,children:a.rarity.toUpperCase()}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.partOfSpeech})]},`${a.id}-${l}`)})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[s.length,"枚のカードを獲得しました！語彙学習で使用できます。"]})})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg text-center",children:[e.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"パックを開封中..."}),e.jsx("p",{className:"text-gray-600",children:"素晴らしいカードが待っています！"})]})})]})};export{A as GachaSystemComponent};
