const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B7y4T0LX.js","assets/ui-smpf69Zd.js","assets/vendor-D3F3s8fL.js","assets/learning-DO2NDF3Q.js","assets/game-BIfLvwvR.js","assets/index-Dq9b6c3A.css"])))=>i.map(i=>d[i]);
import{r as v,j as e}from"./ui-smpf69Zd.js";import{u as U,b as _,B as I,C as h,f as p,e as S,P as T,d as N}from"./game-BIfLvwvR.js";import{A as O,T as w,F as L,a as j,S as f,K as D}from"./learning-DO2NDF3Q.js";const V="modulepreload",F=function(n){return"/"+n},P={},B=function(t,s,a){let o=Promise.resolve();if(s&&s.length>0){let l=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),c=r?.nonce||r?.getAttribute("nonce");o=l(s.map(d=>{if(d=F(d),d in P)return;P[d]=!0;const u=d.endsWith(".css"),y=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${y}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":V,u||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),u)return new Promise((A,k)=>{g.addEventListener("load",A),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return o.then(l=>{for(const r of l||[])r.status==="rejected"&&i(r.reason);return t().catch(i)})},m={USER_STATS:"entp-english-user-stats",ACHIEVEMENTS:"entp-english-achievements",LEARNING_HISTORY:"entp-english-learning-history",VOCABULARY_PROGRESS:"entp-english-vocabulary-progress",APP_SETTINGS:"entp-english-app-settings"},G={totalXP:0,currentStreak:0,longestStreak:0,vocabularyStudied:0,grammarQuizzesCompleted:0,totalQuestionsAnswered:0,correctAnswers:0,averageScore:0,lastStudyDate:new Date().toISOString().split("T")[0],todayXP:0,totalStudyTime:0,accuracy:0,streakDays:0},C={dailyXPGoal:100,grammarQuizQuestionCount:10,vocabularyQuestionCount:10,essayQuestionCount:10};class b{static getUserStats(){try{const t=localStorage.getItem(m.USER_STATS);if(t)return JSON.parse(t)}catch(t){console.error("Failed to load user stats:",t)}return G}static saveUserStats(t){try{localStorage.setItem(m.USER_STATS,JSON.stringify(t))}catch(s){console.error("Failed to save user stats:",s)}}static getLearningHistory(){try{const t=localStorage.getItem(m.LEARNING_HISTORY);if(t)return JSON.parse(t)}catch(t){console.error("Failed to load learning history:",t)}return[]}static saveLearningHistory(t){try{localStorage.setItem(m.LEARNING_HISTORY,JSON.stringify(t))}catch(s){console.error("Failed to save learning history:",s)}}static getVocabularyProgress(){try{const t=localStorage.getItem(m.VOCABULARY_PROGRESS);if(t)return JSON.parse(t)}catch(t){console.error("Failed to load vocabulary progress:",t)}return[]}static saveVocabularyProgress(t){try{localStorage.setItem(m.VOCABULARY_PROGRESS,JSON.stringify(t))}catch(s){console.error("Failed to save vocabulary progress:",s)}}static getAchievements(){try{const t=localStorage.getItem(m.ACHIEVEMENTS);if(t)return JSON.parse(t)}catch(t){console.error("Failed to load achievements:",t)}return[]}static saveAchievements(t){try{localStorage.setItem(m.ACHIEVEMENTS,JSON.stringify(t))}catch(s){console.error("Failed to save achievements:",s)}}static recordLearningSession(t){const s=this.getLearningHistory(),a={...t,id:`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};s.unshift(a),this.saveLearningHistory(s),this.updateUserStatsFromSession(a)}static updateUserStatsFromSession(t){const s=this.getUserStats(),a=new Date().toISOString().split("T")[0],o=new Date(Date.now()-1440*60*1e3).toISOString().split("T")[0];s.totalXP+=t.xpEarned,s.totalQuestionsAnswered+=t.totalQuestions,s.correctAnswers+=t.correctAnswers,s.averageScore=Math.round(s.correctAnswers/s.totalQuestionsAnswered*100),t.type==="vocabulary"?s.vocabularyStudied+=1:t.type==="grammar-quiz"&&(s.grammarQuizzesCompleted+=1),console.log("Streak calculation:",{lastStudyDate:s.lastStudyDate,today:a,yesterday:o,currentStreak:s.currentStreak}),s.lastStudyDate===a?console.log("Already studied today, streak unchanged"):s.lastStudyDate===o?(s.currentStreak+=1,console.log("Streak continued:",s.currentStreak)):(s.currentStreak=1,console.log("Streak reset to 1")),s.currentStreak>s.longestStreak&&(s.longestStreak=s.currentStreak),s.lastStudyDate=a,this.saveUserStats(s),this.sendNotifications(s)}static async sendNotifications(t){try{const{notificationManager:s}=await B(async()=>{const{notificationManager:a}=await import("./index-B7y4T0LX.js").then(o=>o.n);return{notificationManager:a}},__vite__mapDeps([0,1,2,3,4,5]));t.currentStreak>1&&await s.showStreakReminder(t.currentStreak)}catch(s){console.error("Error sending notifications:",s)}}static recordVocabularyStudy(t){const s=this.getVocabularyProgress(),a=s.find(i=>i.wordId===t),o=new Date().toISOString().split("T")[0];a?(a.studiedCount+=1,a.lastStudied=o,a.studiedCount>=5?a.masteryLevel="mastered":a.studiedCount>=2&&(a.masteryLevel="learning")):s.push({wordId:t,studiedCount:1,lastStudied:o,masteryLevel:"new"}),this.saveVocabularyProgress(s)}static checkAndUpdateAchievements(){const t=this.getUserStats(),s=this.getLearningHistory(),a=this.getVocabularyProgress();let o=this.getAchievements();return o.length===0&&(o=this.initializeAchievements()),o.forEach(i=>{let l=0,r=i.requirement;switch(i.type){case"streak":i.id.includes("current")?l=t.currentStreak:i.id.includes("longest")&&(l=t.longestStreak);break;case"vocabulary":l=a.length;break;case"grammar":case"quiz":l=t.grammarQuizzesCompleted;break;case"score":i.id==="perfect_score"?l=s.filter(c=>c.score===100).length:i.id==="high_accuracy"&&(l=s.filter(c=>c.score>=85).length);break}i.progress=Math.min(l,r),i.maxProgress=r,l>=r&&!i.isUnlocked&&(i.isUnlocked=!0,t.totalXP+=i.xpReward)}),this.saveAchievements(o),this.saveUserStats(t),o}static initializeAchievements(){return[{id:"streak_3",title:"三日坊主克服",description:"3日連続で学習",icon:"🔥",type:"streak",tier:"bronze",requirement:3,xpReward:50,isUnlocked:!1,progress:0,maxProgress:3},{id:"streak_7",title:"一週間戦士",description:"7日連続で学習",icon:"⚡",type:"streak",tier:"silver",requirement:7,xpReward:100,isUnlocked:!1,progress:0,maxProgress:7},{id:"streak_14",title:"継続の力",description:"14日連続で学習",icon:"🌟",type:"streak",tier:"gold",requirement:14,xpReward:200,isUnlocked:!1,progress:0,maxProgress:14},{id:"streak_30",title:"マスターの道",description:"30日連続で学習",icon:"👑",type:"streak",tier:"platinum",requirement:30,xpReward:500,isUnlocked:!1,progress:0,maxProgress:30},{id:"vocab_50",title:"単語コレクター",description:"50個の単語を学習",icon:"📚",type:"vocabulary",tier:"bronze",requirement:50,xpReward:75,isUnlocked:!1,progress:0,maxProgress:50},{id:"vocab_100",title:"語彙マスター",description:"100個の単語を学習",icon:"🎓",type:"vocabulary",tier:"silver",requirement:100,xpReward:150,isUnlocked:!1,progress:0,maxProgress:100},{id:"vocab_250",title:"単語の達人",description:"250個の単語を学習",icon:"🏆",type:"vocabulary",tier:"gold",requirement:250,xpReward:300,isUnlocked:!1,progress:0,maxProgress:250},{id:"quiz_10",title:"クイズ初心者",description:"10回文法クイズを完了",icon:"🧩",type:"quiz",tier:"bronze",requirement:10,xpReward:60,isUnlocked:!1,progress:0,maxProgress:10},{id:"quiz_25",title:"クイズ愛好家",description:"25回文法クイズを完了",icon:"🎯",type:"quiz",tier:"silver",requirement:25,xpReward:120,isUnlocked:!1,progress:0,maxProgress:25},{id:"perfect_score",title:"パーフェクト",description:"満点を獲得",icon:"💯",type:"score",tier:"gold",requirement:1,xpReward:250,isUnlocked:!1,progress:0,maxProgress:1},{id:"high_accuracy",title:"正確性マスター",description:"正解率85%以上を達成",icon:"🎖️",type:"score",tier:"silver",requirement:1,xpReward:180,isUnlocked:!1,progress:0,maxProgress:1}]}static resetAllData(){localStorage.removeItem(m.USER_STATS),localStorage.removeItem(m.ACHIEVEMENTS),localStorage.removeItem(m.LEARNING_HISTORY),localStorage.removeItem(m.VOCABULARY_PROGRESS),localStorage.removeItem(m.APP_SETTINGS)}static exportData(){const t={userStats:this.getUserStats(),achievements:this.getAchievements(),learningHistory:this.getLearningHistory(),vocabularyProgress:this.getVocabularyProgress(),appSettings:this.getAppSettings(),exportDate:new Date().toISOString()};return JSON.stringify(t,null,2)}static importData(t){try{const s=JSON.parse(t);return s.userStats&&this.saveUserStats(s.userStats),s.achievements&&this.saveAchievements(s.achievements),s.learningHistory&&this.saveLearningHistory(s.learningHistory),s.vocabularyProgress&&this.saveVocabularyProgress(s.vocabularyProgress),s.appSettings&&this.saveAppSettings(s.appSettings),!0}catch(s){return console.error("Failed to import data:",s),!1}}static getAppSettings(){try{const t=localStorage.getItem(m.APP_SETTINGS);if(t){const s=JSON.parse(t);return{...C,...s}}}catch(t){console.error("Error loading app settings:",t)}return C}static saveAppSettings(t){try{const a={...this.getAppSettings(),...t};localStorage.setItem(m.APP_SETTINGS,JSON.stringify(a))}catch(s){console.error("Error saving app settings:",s)}}static addGachaWordsToVocabulary(t){try{const s=this.getVocabularyProgress();t.forEach(a=>{const o={id:a.id+1e4,word:a.word,meaning:a.meaning,partOfSpeech:a.partOfSpeech,example:a.examples[0]?.sentence||"",exampleTranslation:a.examples[0]?.translation||"",level:this.mapRarityToLevel(a.rarity),category:"toeic"};s.find(l=>l.wordId===o.id)||s.push({wordId:o.id,studiedCount:0,lastStudied:"",masteryLevel:"new"})}),this.saveVocabularyProgress(s),console.log("Successfully added gacha cards to vocabulary system")}catch(s){throw console.error("Error in addGachaWordsToVocabulary:",s),s}}static mapRarityToLevel(t){switch(t){case"common":case"uncommon":return"beginner";case"rare":case"epic":return"intermediate";case"legendary":return"advanced";default:return"beginner"}}static getGachaVocabularyProgress(){return this.getVocabularyProgress().filter(s=>s.wordId>=1e4)}static recordGachaVocabularyStudy(t){const s=this.getVocabularyProgress(),a=s.find(i=>i.wordId===t),o=new Date().toISOString().split("T")[0];a?(a.studiedCount+=1,a.lastStudied=o,a.studiedCount>=5?a.masteryLevel="mastered":a.studiedCount>=2&&(a.masteryLevel="learning")):s.push({wordId:t,studiedCount:1,lastStudied:o,masteryLevel:"new"}),this.saveVocabularyProgress(s)}static getPreStudyProgress(){try{const t=localStorage.getItem("preStudyProgress");return t?JSON.parse(t):{totalContentsStudied:0,contentsByCategory:{},averageComprehension:0,totalTimeSpent:0,completedContents:[]}}catch(t){return console.error("Error loading pre-study progress:",t),{totalContentsStudied:0,contentsByCategory:{},averageComprehension:0,totalTimeSpent:0,completedContents:[]}}}static savePreStudyProgress(t){try{localStorage.setItem("preStudyProgress",JSON.stringify(t))}catch(s){console.error("Error saving pre-study progress:",s)}}static recordPreStudyCompletion(t,s,a){try{const o=this.getPreStudyProgress();o.completedContents.includes(t)||(o.completedContents.push(t),o.totalContentsStudied++),o.totalTimeSpent+=a,o.averageComprehension=(o.averageComprehension*(o.totalContentsStudied-1)+s)/o.totalContentsStudied,this.savePreStudyProgress(o)}catch(o){console.error("Error recording pre-study completion:",o)}}}function z(n){switch(n){case"bronze":return"from-amber-600 to-yellow-600";case"silver":return"from-gray-400 to-gray-600";case"gold":return"from-yellow-400 to-yellow-600";case"platinum":return"from-purple-400 to-purple-600";case"diamond":return"from-blue-400 to-cyan-400";default:return"from-gray-300 to-gray-500"}}function H(n){switch(n){case"bronze":return"text-amber-700";case"silver":return"text-gray-700";case"gold":return"text-yellow-700";case"platinum":return"text-purple-700";case"diamond":return"text-cyan-700";default:return"text-gray-700"}}function R({achievement:n}){const t=n.progress/n.maxProgress*100,s=z(n.tier),a=H(n.tier);return e.jsxs(h,{className:`
      relative overflow-hidden transition-all duration-300 border-2
      ${n.isUnlocked?"border-emerald-200 bg-gradient-to-br from-emerald-50 to-white shadow-lg":"border-gray-200 bg-gradient-to-br from-gray-50 to-white"}
    `,children:[n.isUnlocked&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"})}),e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`
              text-3xl p-2 rounded-full bg-gradient-to-br ${s}
              ${n.isUnlocked?"opacity-100":"opacity-50 grayscale"}
            `,children:n.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-medium ${n.isUnlocked?"text-gray-900":"text-gray-500"}`,children:n.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.description})]})]}),e.jsx(N,{variant:n.isUnlocked?"default":"secondary",className:`text-xs ${n.isUnlocked?a:""}`,children:n.tier.toUpperCase()})]})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"進捗"}),e.jsxs("span",{className:n.isUnlocked?"text-emerald-600 font-medium":"text-muted-foreground",children:[n.progress," / ",n.maxProgress]})]}),e.jsx(T,{value:t,className:`h-2 ${n.isUnlocked?"":"opacity-50"}`}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(f,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{className:"text-muted-foreground",children:[n.xpReward," XP"]})]}),n.isUnlocked&&e.jsx(N,{variant:"outline",className:"text-xs text-emerald-600",children:"獲得済み"})]})]})]})}function E({icon:n,label:t,value:s,color:a}){return e.jsx(h,{className:"bg-gradient-to-br from-white to-gray-50 border-0 shadow-md",children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br ${a} mb-3`,children:e.jsx(n,{className:"w-6 h-6 text-foreground"})}),e.jsx("div",{className:"text-2xl font-semibold mb-1",children:s}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t})]})})}function J(){const n=U();_();const[t,s]=v.useState(b.getUserStats()),[a,o]=v.useState([]);v.useEffect(()=>{const r=b.getUserStats(),c=b.getAchievements();s(r),o(c)},[]);const i=a.filter(r=>r.isUnlocked),l=a.filter(r=>!r.isUnlocked);return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white",children:e.jsxs("div",{className:"max-w-md mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between pt-8",children:[e.jsx(I,{variant:"ghost",onClick:()=>n("/"),className:"p-2",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-xl",children:"実績"}),e.jsx("div",{className:"w-10"})]}),e.jsx(h,{className:"bg-gradient-to-br from-blue-600 to-purple-600 text-foreground border-0 shadow-xl",children:e.jsxs(p,{className:"p-6 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-3",children:[e.jsx(w,{className:"w-8 h-8 mr-2"}),e.jsx("span",{className:"text-lg",children:"合計XP"})]}),e.jsx("div",{className:"text-5xl font-bold mb-2",children:t.totalXP.toLocaleString()}),e.jsx("div",{className:"text-blue-100",children:"継続は力なり！"})]})}),e.jsx(h,{className:"bg-gradient-to-br from-orange-500 to-red-500 text-foreground border-0 shadow-lg",children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-full",children:e.jsx(L,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-90",children:"連続学習"}),e.jsxs("div",{className:"text-2xl font-bold",children:[t.currentStreak,"日"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm opacity-90",children:"最長記録"}),e.jsxs("div",{className:"text-lg font-medium",children:[t.longestStreak,"日"]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{icon:j,label:"正解率",value:`${t.averageScore}%`,color:"from-emerald-500 to-green-600"}),e.jsx(E,{icon:f,label:"総問題数",value:t.totalQuestionsAnswered,color:"from-yellow-500 to-orange-500"})]}),e.jsxs(h,{className:"border-0 shadow-md",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(w,{className:"w-5 h-5 mr-2 text-yellow-600"}),"実績進捗"]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"獲得済み"}),e.jsxs("span",{className:"font-medium",children:[i.length," / ",a.length]})]}),e.jsx(T,{value:i.length/a.length*100,className:"h-3"})]})]}),(()=>{const r=D.getKnownWordsStats();return r.total>0?e.jsxs(h,{className:"border-0 shadow-md",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2 text-emerald-600"}),"既知単語"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:r.total}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"マスター済み"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.recentlyMarked.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"今週追加"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"レベル別"}),Object.entries(r.byLevel).map(([c,d])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:c}),e.jsxs(N,{variant:"outline",className:"text-xs",children:[d,"語"]})]},c))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"カテゴリ別"}),Object.entries(r.byCategory).map(([c,d])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:c}),e.jsxs(N,{variant:"outline",className:"text-xs",children:[d,"語"]})]},c))]})]})]}):null})(),t.preStudyProgress&&t.preStudyProgress.totalContentsStudied>0&&e.jsxs(h,{className:"border-0 shadow-md",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(f,{className:"w-5 h-5 mr-2 text-purple-600"}),"事前学習の理解度"]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.preStudyProgress.totalContentsStudied}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"学習コンテンツ数"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:t.preStudyProgress.averageComprehension.toFixed(1)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"平均理解度"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("span",{className:"text-sm text-muted-foreground",children:"理解度分布"})}),e.jsx("div",{className:"space-y-1",children:[5,4,3,2,1].map(r=>{const c=t.preStudySessions?.filter(u=>u.comprehensionRating===r).length||0,d=t.preStudyProgress.totalContentsStudied>0?c/t.preStudyProgress.totalContentsStudied*100:0;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1 w-16",children:e.jsxs("span",{className:"text-sm text-yellow-500",children:["★".repeat(r),"☆".repeat(5-r)]})}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full transition-all duration-300",style:{width:`${d}%`}})}),e.jsx("span",{className:"text-xs text-muted-foreground w-8 text-right",children:c})]},r)})})]}),Object.keys(t.preStudyProgress.contentsByCategory).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"分野別学習数"}),e.jsx("div",{className:"space-y-1",children:Object.entries(t.preStudyProgress.contentsByCategory).map(([r,c])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm capitalize",children:r}),e.jsxs("span",{className:"text-sm font-medium",children:[c,"個"]})]},r))})]}),t.preStudySessions&&t.preStudySessions.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"学習したコンテンツ一覧"}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:t.preStudySessions.filter(r=>r.completed).map((r,c)=>e.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg border ${r.comprehensionRating===1?"bg-red-50 border-red-200":r.comprehensionRating===2?"bg-orange-50 border-orange-200":r.comprehensionRating===3?"bg-yellow-50 border-yellow-200":r.comprehensionRating===4?"bg-blue-50 border-blue-200":r.comprehensionRating===5?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium",children:r.contentId}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(r.startTime).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex items-center space-x-1",children:r.comprehensionRating?e.jsx(e.Fragment,{children:[1,2,3,4,5].map(d=>e.jsx("span",{className:`text-sm ${d<=r.comprehensionRating?"text-yellow-500":"text-gray-300"}`,children:"★"},d))}):e.jsx("span",{className:"text-xs text-gray-500",children:"評価なし"})}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[r.comprehensionRating===1&&"要復習",r.comprehensionRating===2&&"要改善",r.comprehensionRating===3&&"普通",r.comprehensionRating===4&&"良い",r.comprehensionRating===5&&"完璧",!r.comprehensionRating&&"未評価"]})]})]},c))})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(f,{className:"w-5 h-5 mr-2 text-emerald-600"}),"獲得済み実績 (",i.length,")"]}),e.jsx("div",{className:"space-y-3",children:i.map(r=>e.jsx(R,{achievement:r},r.id))})]}),l.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(j,{className:"w-5 h-5 mr-2 text-gray-500"}),"未獲得実績 (",l.length,")"]}),e.jsx("div",{className:"space-y-3",children:l.map(r=>e.jsx(R,{achievement:r},r.id))})]}),e.jsx("div",{className:"h-8"})]})})}const x={BASE_CORRECT_ANSWER:10,DIFFICULTY_MULTIPLIER:{easy:1,normal:1.5,hard:2},CATEGORY_MULTIPLIER:{"basic-grammar":1,tenses:1.2,modals:1.3,passive:1.4,relative:1.5,subjunctive:1.6,comparison:1.3,participle:1.4,infinitive:1.5},PERFECT_SCORE_BONUS:50,HIGH_ACCURACY_BONUS:25,STREAK_BONUS:10,FIRST_ATTEMPT_BONUS:5};function M(n,t,s,a=!1){let o=0,i=0,l=0;n.forEach((c,d)=>{if(c.isCorrect){i++,l++;let u=x.BASE_CORRECT_ANSWER;u*=x.DIFFICULTY_MULTIPLIER[t],u*=x.CATEGORY_MULTIPLIER[s],a&&(u+=x.FIRST_ATTEMPT_BONUS),l>=3&&(u+=x.STREAK_BONUS),o+=Math.round(u)}else l=0});const r=i/n.length*100;return r===100?o+=x.PERFECT_SCORE_BONUS:r>=80&&(o+=x.HIGH_ACCURACY_BONUS),o}function Q(n,t){const a={beginner:1,intermediate:1.5,advanced:2};return Math.round(n*5*a[t])}function q(n){return 0}function W(n,t,s,a,o=!1){const i=M(n,t,s,o),l=q();return i+l}export{J as A,b as D,W as a,Q as c};
